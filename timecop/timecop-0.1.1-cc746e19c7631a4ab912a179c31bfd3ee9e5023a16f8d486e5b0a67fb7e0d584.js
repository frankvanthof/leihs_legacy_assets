!function(){function e(e){t.MockDate.prototype[e]=function(){return this._underlyingDate[e].apply(this._underlyingDate,arguments)}}var t,n=this,i=Array.prototype.slice,r=[];r.peek=function(){return this.length>0?this[this.length-1]:null},r.clear=function(){this.splice(0,this.length)};var o=function(e){if(e.length>0&&"function"==typeof e[e.length-1]){var t=e.pop();return t}return null},s=function(e,n){var i=o(n),s=t.buildNativeDate.apply(t,n);if(isNaN(s.getYear()))throw'Could not parse date: "'+n.join(", ")+'"';if(r.push(new t.TimeStackItem(e,s)),i)try{i()}finally{t.returnToPresent()}};t={NativeDate:n.Date,buildNativeDate:function(){return 0===arguments.length?new t.NativeDate:1===arguments.length?new t.NativeDate(arguments[0]):2===arguments.length?new t.NativeDate(arguments[0],arguments[1]):3===arguments.length?new t.NativeDate(arguments[0],arguments[1],arguments[2]):4===arguments.length?new t.NativeDate(arguments[0],arguments[1],arguments[2],arguments[3]):5===arguments.length?new t.NativeDate(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]):6===arguments.length?new t.NativeDate(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]):7===arguments.length?new t.NativeDate(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]):void 0},install:function(){n.Date=t.MockDate},uninstall:function(){n.Date=t.NativeDate},travel:function(){s("travel",i.call(arguments))},freeze:function(){s("freeze",i.call(arguments))},returnToPresent:function(){r.clear()},topOfStack:function(){return r.peek()}},"undefined"!=typeof module&&module.exports?(module.exports=t,t.Timecop=t):n.Timecop=t,t.MockDate=function(){arguments.length>0||!t.topOfStack()?this._underlyingDate=t.buildNativeDate.apply(t,Array.prototype.slice.apply(arguments)):this._underlyingDate=t.topOfStack().date()},t.MockDate.UTC=function(){return t.NativeDate.UTC.apply(t.NativeDate,arguments)},t.MockDate.parse=function(e){return t.NativeDate.parse(e)},t.MockDate.prototype={},e("toDateString"),e("toGMTString"),e("toISOString"),e("toJSON"),e("toLocaleDateString"),e("toLocaleString"),e("toLocaleTimeString"),e("toString"),e("toTimeString"),e("toUTCString"),e("valueOf");for(var a=["Date","Day","FullYear","Hours","Milliseconds","Minutes","Month","Seconds","Time","TimezoneOffset","UTCDate","UTCDay","UTCFullYear","UTCHours","UTCMilliseconds","UTCMinutes","UTCMonth","UTCSeconds","Year"],l=["get","set"],d=0;d<l.length;d++)for(var p=0;p<a.length;p++)e(l[d]+a[p]);t.TimeStackItem=function(e,t){if("freeze"!==e&&"travel"!==e)throw"Unknown mock_type "+e;this.mockType=e,this._time=t,this._travelOffset=this._computeTravelOffset()},t.TimeStackItem.prototype={date:function(){return this.time()},time:function(){return null===this._travelOffset?this._time:new t.NativeDate((new t.NativeDate).getTime()+this._travelOffset)},_computeTravelOffset:function(){return"freeze"===this.mockType?null:this._time.getTime()-(new t.NativeDate).getTime()}}}();