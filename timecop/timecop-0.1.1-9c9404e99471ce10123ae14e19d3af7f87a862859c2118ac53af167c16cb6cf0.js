!function(){function t(t){e.MockDate.prototype[t]=function(){return this._underlyingDate[t].apply(this._underlyingDate,arguments)}}var e,n=this,i=Array.prototype.slice,r=[];r.peek=function(){return this.length>0?this[this.length-1]:null},r.clear=function(){this.splice(0,this.length)};var s=function(t){if(t.length>0&&"function"==typeof t[t.length-1]){var e=t.pop();return e}return null},o=function(t,n){var i=s(n),o=e.buildNativeDate.apply(e,n);if(isNaN(o.getYear()))throw'Could not parse date: "'+n.join(", ")+'"';if(r.push(new e.TimeStackItem(t,o)),i)try{i()}finally{e.returnToPresent()}};e={NativeDate:n.Date,buildNativeDate:function(){return 0===arguments.length?new e.NativeDate:1===arguments.length?new e.NativeDate(arguments[0]):2===arguments.length?new e.NativeDate(arguments[0],arguments[1]):3===arguments.length?new e.NativeDate(arguments[0],arguments[1],arguments[2]):4===arguments.length?new e.NativeDate(arguments[0],arguments[1],arguments[2],arguments[3]):5===arguments.length?new e.NativeDate(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4]):6===arguments.length?new e.NativeDate(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]):7===arguments.length?new e.NativeDate(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]):void 0},install:function(){n.Date=e.MockDate},uninstall:function(){n.Date=e.NativeDate},travel:function(){o("travel",i.call(arguments))},freeze:function(){o("freeze",i.call(arguments))},returnToPresent:function(){r.clear()},topOfStack:function(){return r.peek()}},"undefined"!=typeof module&&module.exports?(module.exports=e,e.Timecop=e):n.Timecop=e,e.MockDate=function(){arguments.length>0||!e.topOfStack()?this._underlyingDate=e.buildNativeDate.apply(e,Array.prototype.slice.apply(arguments)):this._underlyingDate=e.topOfStack().date()},e.MockDate.UTC=function(){return e.NativeDate.UTC.apply(e.NativeDate,arguments)},e.MockDate.parse=function(t){return e.NativeDate.parse(t)},e.MockDate.prototype={},t("toDateString"),t("toGMTString"),t("toISOString"),t("toJSON"),t("toLocaleDateString"),t("toLocaleString"),t("toLocaleTimeString"),t("toString"),t("toTimeString"),t("toUTCString"),t("valueOf");for(var a=["Date","Day","FullYear","Hours","Milliseconds","Minutes","Month","Seconds","Time","TimezoneOffset","UTCDate","UTCDay","UTCFullYear","UTCHours","UTCMilliseconds","UTCMinutes","UTCMonth","UTCSeconds","Year"],l=["get","set"],u=0;u<l.length;u++)for(var d=0;d<a.length;d++)t(l[u]+a[d]);e.TimeStackItem=function(t,e){if("freeze"!==t&&"travel"!==t)throw"Unknown mock_type "+t;this.mockType=t,this._time=e,this._travelOffset=this._computeTravelOffset()},e.TimeStackItem.prototype={date:function(){return this.time()},time:function(){return null===this._travelOffset?this._time:new e.NativeDate((new e.NativeDate).getTime()+this._travelOffset)},_computeTravelOffset:function(){return"freeze"===this.mockType?null:this._time.getTime()-(new e.NativeDate).getTime()}}}();