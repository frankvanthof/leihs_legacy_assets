!function(e){function t(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:0}function n(e,t){return e[0]>t[0]?-1:e[0]<t[0]?1:0}var r=new Array;new Array;e.fn.jqBarGraph=e.fn.jqbargraph=function(s){init=function(t){r[t.id]=e.extend({},e.fn.jqBarGraph.defaults,s),e(t).css({width:r[t.id].width,height:r[t.id].height,position:"relative","text-align":"center"}),doGraph(t),doGrid(t)},sum=function(e){total=0;for(val in e)total+=e[val];return total.toFixed(2)},maxVal=function(e){maxvalue=0;for(var t in e)value=e[t][0],value instanceof Array&&(value=sum(value)),parseFloat(value)>parseFloat(maxvalue)&&(maxvalue=value);return maxvalue},maxMulti=function(e){maxvalue=0,maxvalue2=0;for(var t in e){ar2=e[t][0];for(var n in ar2)ar2[n]>maxvalue2&&(maxvalue2=ar2[n]);maxvalue2>maxvalue&&(maxvalue=maxvalue2)}return maxvalue},doGraph=function(s){if(arr=r[s.id],data=arr.data,void 0==data)return void e(s).html("There is not enought data for graph");"asc"==arr.sort&&data.sort(t),"desc"==arr.sort&&data.sort(n),legend="",prefix=arr.prefix,postfix=arr.postfix,space=arr.barSpace,legendWidth=arr.legend?arr.legendWidth:0,gridSpace=arr.gridSpace,fieldWidth=(e(s).width()-legendWidth-gridSpace)/data.length,totalHeight=e(s).height();var a=new Array;max=maxVal(data),colPosition=0;for(var l in data){if(valueData=data[l][0],valueData instanceof Array?value=parseFloat(sum(valueData)):value=parseFloat(valueData),lbl=data[l][1],color=data[l][2],unique=l+s.id,void 0==color&&0==arr.colors&&(color=arr.color),arr.colors&&!color&&(colorsCounter=arr.colors.length,colorsCounter==colPosition&&(colPosition=0),color=arr.colors[colPosition],colPosition++),"multi"==arr.type&&(color="none"),void 0==lbl&&(lbl=arr.lbl),out="<div class='graphField"+s.id+"' id='graphField"+unique+"' style='position: absolute'>",lbl.value?out+="<div class='graphValue"+s.id+"' id='graphValue"+unique+"'>"+lbl.value+"</div>":out+="<div class='graphValue"+s.id+"' id='graphValue"+unique+"'>"+prefix+value+postfix+"</div>",out+="<div class='graphBar"+s.id+"' id='graphFieldBar"+unique+"' style='background-color:"+color+";position: relative; overflow: hidden;'></div>",(!arr.legend||arr.legends)&&(out+="<div class='graphLabel"+s.id+"' id='graphLabel"+unique+"'>"+lbl.name+"</div>"),out+="</div>",e(s).append(out),totalHeightBar=totalHeight-e(".graphLabel"+s.id).outerHeight()-e(".graphValue"+s.id).outerHeight(),fieldHeight=totalHeightBar*value/max,e("#graphField"+unique).css({left:fieldWidth*l+gridSpace,width:fieldWidth-space,"margin-left":space/2,"margin-right":space/2}),valueData instanceof Array){"multi"==arr.type?(maxe=maxMulti(data),totalHeightBar=fieldHeight=totalHeight-e(".graphLabel"+s.id).height(),e(".graphValue"+s.id).remove()):maxe=max;for(i in valueData)heig=totalHeightBar*valueData[i]/maxe,wid=parseInt((fieldWidth-space)/valueData.length),sv="",fs=0,valueElement="",arr.showValues&&0!=valueData[i]&&sum(valueData)!=valueData[i]&&(sv=arr.prefix+valueData[i]+arr.postfix,fs=12,valueElement="<span class='text'>"+sv+"</span>"),o="<div class='subBars"+s.id+"' style='height:"+heig+"px; background-color: "+arr.colors[i]+"; left:"+wid*i+"px; color:"+arr.showValuesColor+"; font-size:"+fs+"px' ></div>",e("#graphFieldBar"+unique).prepend(o)}"multi"==arr.type&&e(".subBars"+s.id).css({width:wid,position:"absolute",bottom:0}),"bottom"==arr.position&&e(".graphField"+s.id).css("bottom",0),arr.legends||a.push([color,lbl,s.id,unique]),arr.animate?(e("#graphFieldBar"+unique).css({height:0}),e("#graphFieldBar"+unique).animate({height:fieldHeight},1e3*arr.speed)):e("#graphFieldBar"+unique).css({height:fieldHeight})}for(var d in arr.legends)a.push([arr.colors[d],arr.legends[d],s.id,d]);createLegend(a),arr.legend&&(e(s).append("<div id='legendHolder"+unique+"'></div>"),e("#legendHolder"+unique).css({width:legendWidth,"float":"right","text-align":"left"}),e("#legendHolder"+unique).append(legend),e(".legendBar"+s.id).css({"float":"left",margin:3,height:12,width:20,"font-size":0})),arr.title&&(e(s).wrap("<div id='graphHolder"+unique+"'></div>"),e("#graphHolder"+unique).prepend(arr.title).css({width:arr.width+"px","text-align":"center"}))},doGrid=function(t){if(s=r[t.id],s.grid){arr=r[t.id],data=arr.data;var n=parseFloat(maxVal(data)),i=Math.floor(n/Math.pow(10,n.toString().length-1));i*=Math.pow(10,n.toString().length-1),i=arr.gridAtMax?n:i;for(var o=i/arr.gridSections,a=[],l=i/arr.gridSections/(arr.interGrids+1),d=[],p=0;p<arr.gridSections;p++){a.push(Math.round(o*p));for(var u=1;u<=arr.interGrids;u++)d.push(a[p]+l*u)}a.push(i);for(var c=arr.gridColors,h=e(t).find(".graphLabel").first().outerHeight(),f=e(t).find(".graphValue").first().outerHeight(),v="<div class='bar-grid' style='position:absolute; height:"+s.height+"px; width:"+s.width+"px;'>",p=0;p<a.length;p++)y=(n-a[p])/n,y=y===-(1/0)?0:y,y=y*(s.height-h-f)+f,v+="<div class='grid-line' style='border-top: 1px solid "+c[0]+";display:block; width: "+s.width+"px;position:absolute; top:"+y+"px'>",v+="<span class='grid-text' style='position: absolute; left: 0; top:-5px;'></span>",v+="<hr/>",v+="</div>";for(var p=0;p<d.length;p++)y=(n-d[p])/n,y=y===-(1/0)?0:y,y=y*(s.height-h-f)+f,v+="<div class='grid-line grid-intermediate' style='border-top: 1px solid "+c[1]+";opacity: 0.5;block; width: "+s.width+"px;position:absolute; top:"+y+"px'>",v+="<hr/>",v+="</div>";v+="</div>",e(t).prepend(v)}},createLegend=function(e){legend="";for(var t in e)legend+="<div id='legend"+e[t][3]+"' style='overflow: hidden; zoom: 1;'>",legend+="<div class='legendBar"+e[t][2]+"' id='legendColor"+e[t][3]+"' style='background-color:"+e[t][0]+"'></div>",legend+="<div class='legendLabel"+e[t][2]+"' id='graphLabel"+unique+"'>"+e[t][1]+"</div>",legend+="</div>"},this.each(function(){init(this)})},e.fn.jqBarGraph.defaults={barSpace:10,width:400,height:300,color:"#000000",colors:!1,lbl:"",sort:!1,position:"bottom",prefix:"",postfix:"",animate:!0,speed:1.5,legendWidth:100,legend:!1,legends:!1,type:!1,showValues:!0,showValuesColor:"#fff",title:!1,grid:!0,gridSpace:20,gridAtMax:!1,gridSections:2,gridColors:["#444444","#AAAAAA"],interGrids:1}}(jQuery),function(e){var t,n={className:"autosizejs",id:"autosizejs",append:"\n",callback:!1,resizeDelay:10,placeholder:!0},i=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent","whiteSpace"],r=e('<textarea tabindex="-1"/>').data("autosize",!0)[0];r.style.cssText="position:absolute; top:-999px; left:0; right:auto; bottom:auto; border:0; padding: 0; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden; transition:none; -webkit-transition:none; -moz-transition:none;",r.style.lineHeight="99px","99px"===e(r).css("lineHeight")&&i.push("lineHeight"),r.style.lineHeight="",e.fn.autosize=function(o){return this.length?(o=e.extend({},n,o||{}),r.parentNode!==document.body&&e(document.body).append(r),this.each(function(){function n(){var t,n=window.getComputedStyle?window.getComputedStyle(c,null):null;n?(t=parseFloat(n.width),("border-box"===n.boxSizing||"border-box"===n.webkitBoxSizing||"border-box"===n.mozBoxSizing)&&e.each(["paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"],function(e,i){t-=parseFloat(n[i])})):t=h.width(),r.style.width=Math.max(t,0)+"px"}function s(){var s={};if(t=c,r.className=o.className,r.id=o.id,d=parseFloat(h.css("maxHeight")),e.each(i,function(e,t){s[t]=h.css(t)}),e(r).css(s).attr("wrap",h.attr("wrap")),n(),window.chrome){var a=c.style.width;c.style.width="0px";c.offsetWidth;c.style.width=a}}function a(){var e,i;t!==c?s():n(),!c.value&&o.placeholder?r.value=h.attr("placeholder")||"":r.value=c.value,r.value+=o.append||"",r.style.overflowY=c.style.overflowY,i=parseFloat(c.style.height)||0,r.scrollTop=0,r.scrollTop=9e4,e=r.scrollTop,d&&e>d?(c.style.overflowY="scroll",e=d):(c.style.overflowY="hidden",p>e&&(e=p)),e+=f,Math.abs(i-e)>.01&&(c.style.height=e+"px",r.className=r.className,v&&o.callback.call(c,c),h.trigger("autosize.resized"))}function l(){clearTimeout(u),u=setTimeout(function(){var e=h.width();e!==g&&(g=e,a())},parseInt(o.resizeDelay,10))}var d,p,u,c=this,h=e(c),f=0,v=e.isFunction(o.callback),m={height:c.style.height,overflow:c.style.overflow,overflowY:c.style.overflowY,wordWrap:c.style.wordWrap,resize:c.style.resize},g=h.width(),y=h.css("resize");h.data("autosize")||(h.data("autosize",!0),("border-box"===h.css("box-sizing")||"border-box"===h.css("-moz-box-sizing")||"border-box"===h.css("-webkit-box-sizing"))&&(f=h.outerHeight()-h.height()),p=Math.max(parseFloat(h.css("minHeight"))-f||0,h.height()),h.css({overflow:"hidden",overflowY:"hidden",wordWrap:"break-word"}),"vertical"===y?h.css("resize","none"):"both"===y&&h.css("resize","horizontal"),"onpropertychange"in c?"oninput"in c?h.on("input.autosize keyup.autosize",a):h.on("propertychange.autosize",function(){"value"===event.propertyName&&a()}):h.on("input.autosize",a),o.resizeDelay!==!1&&e(window).on("resize.autosize",l),h.on("autosize.resize",a),h.on("autosize.resizeIncludeStyle",function(){t=null,a()}),h.on("autosize.destroy",function(){t=null,clearTimeout(u),e(window).off("resize",l),h.off("autosize").off(".autosize").css(m).removeData("autosize")}),a())})):this}}(jQuery||$),function(){}.call(this),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):e(window.jQuery)}(function(e){"use strict";var t=0,n=["accepts","cache","contents","contentType","crossDomain","data","dataType","headers","ifModified","mimeType","password","processData","timeout","traditional","type","url","username"],i=function(e){return e};e.ajaxSetup({converters:{"postmessage text":i,"postmessage json":i,"postmessage html":i}}),e.ajaxTransport("postmessage",function(i){if(i.postMessage&&window.postMessage){var r,o=e("<a>").prop("href",i.postMessage)[0],s=o.protocol+"//"+o.host,a=i.xhr().upload;return{send:function(o,l){t+=1;var d={id:"postmessage-transport-"+t},p="message."+d.id;r=e('<iframe style="display:none;" src="'+i.postMessage+'" name="'+d.id+'"></iframe>').bind("load",function(){e.each(n,function(e,t){d[t]=i[t]}),d.dataType=d.dataType.replace("postmessage ",""),e(window).bind(p,function(t){t=t.originalEvent;var n,i=t.data;t.origin===s&&i.id===d.id&&("progress"===i.type?(n=document.createEvent("Event"),n.initEvent(i.type,!1,!0),e.extend(n,i),a.dispatchEvent(n)):(l(i.status,i.statusText,{postmessage:i.result},i.headers),r.remove(),e(window).unbind(p)))}),r[0].contentWindow.postMessage(d,s)}).appendTo(document.body)},abort:function(){r&&r.remove()}}}})}),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):e(window.jQuery)}(function(e){"use strict";window.XDomainRequest&&!e.support.cors&&e.ajaxTransport(function(t){if(t.crossDomain&&t.async){t.timeout&&(t.xdrTimeout=t.timeout,delete t.timeout);var n;return{send:function(i,r){function o(t,i,o,s){n.onload=n.onerror=n.ontimeout=e.noop,n=null,r(t,i,o,s)}var s=/\?/.test(t.url)?"&":"?";n=new XDomainRequest,"DELETE"===t.type?(t.url=t.url+s+"_method=DELETE",t.type="POST"):"PUT"===t.type?(t.url=t.url+s+"_method=PUT",t.type="POST"):"PATCH"===t.type&&(t.url=t.url+s+"_method=PATCH",t.type="POST"),n.open(t.type,t.url),n.onload=function(){o(200,"OK",{text:n.responseText},"Content-Type: "+n.contentType)},n.onerror=function(){o(404,"Not Found")},t.xdrTimeout&&(n.ontimeout=function(){o(0,"timeout")},n.timeout=t.xdrTimeout),n.send(t.hasContent&&t.data||null)},abort:function(){n&&(n.onerror=e.noop(),n.abort())}}}})}),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","jquery.ui.widget"],e):e(window.jQuery)}(function(e){"use strict";e.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||e('<input type="file">').prop("disabled")),e.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader),e.support.xhrFormDataFileUpload=!!window.FormData,e.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),e.widget("blueimp.fileupload",{options:{dropZone:e(document),pasteZone:e(document),fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(t,n){return t=this.messages[t]||t.toString(),n&&e.each(n,function(e,n){t=t.replace("{"+e+"}",n)}),t},formData:function(e){return e.serializeArray()},add:function(t,n){return t.isDefaultPrevented()?!1:void((n.autoUpload||n.autoUpload!==!1&&e(this).fileupload("option","autoUpload"))&&n.process().done(function(){n.submit()}))},processData:!1,contentType:!1,cache:!1},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:e.support.blobSlice&&function(){var e=this.slice||this.webkitSlice||this.mozSlice;return e.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(e,t,n){var i=e-this.timestamp;return(!this.bitrate||!n||i>n)&&(this.bitrate=(t-this.loaded)*(1e3/i)*8,this.loaded=t,this.timestamp=e),this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&e.support.xhrFileUpload||e.support.xhrFormDataFileUpload)},_getFormData:function(t){var n;return"function"==typeof t.formData?t.formData(t.form):e.isArray(t.formData)?t.formData:"object"===e.type(t.formData)?(n=[],e.each(t.formData,function(e,t){n.push({name:e,value:t})}),n):[]},_getTotal:function(t){var n=0;return e.each(t,function(e,t){n+=t.size||1}),n},_initProgressObject:function(t){var n={loaded:0,total:0,bitrate:0};t._progress?e.extend(t._progress,n):t._progress=n},_initResponseObject:function(e){var t;if(e._response)for(t in e._response)e._response.hasOwnProperty(t)&&delete e._response[t];else e._response={}},_onProgress:function(t,n){if(t.lengthComputable){var i,r=Date.now?Date.now():(new Date).getTime();if(n._time&&n.progressInterval&&r-n._time<n.progressInterval&&t.loaded!==t.total)return;n._time=r,i=Math.floor(t.loaded/t.total*(n.chunkSize||n._progress.total))+(n.uploadedBytes||0),this._progress.loaded+=i-n._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(r,this._progress.loaded,n.bitrateInterval),n._progress.loaded=n.loaded=i,n._progress.bitrate=n.bitrate=n._bitrateTimer.getBitrate(r,i,n.bitrateInterval),this._trigger("progress",e.Event("progress",{delegatedEvent:t}),n),this._trigger("progressall",e.Event("progressall",{delegatedEvent:t}),this._progress)}},_initProgressListener:function(t){var n=this,i=t.xhr?t.xhr():e.ajaxSettings.xhr();i.upload&&(e(i.upload).bind("progress",function(e){var i=e.originalEvent;e.lengthComputable=i.lengthComputable,e.loaded=i.loaded,e.total=i.total,n._onProgress(e,t)}),t.xhr=function(){return i})},_isInstanceOf:function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},_initXHRData:function(t){var n,i=this,r=t.files[0],o=t.multipart||!e.support.xhrFileUpload,s=t.paramName[0];t.headers=e.extend({},t.headers),t.contentRange&&(t.headers["Content-Range"]=t.contentRange),o&&!t.blob&&this._isInstanceOf("File",r)||(t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(r.name)+'"'),o?e.support.xhrFormDataFileUpload&&(t.postMessage?(n=this._getFormData(t),t.blob?n.push({name:s,value:t.blob}):e.each(t.files,function(e,i){n.push({name:t.paramName[e]||s,value:i})})):(i._isInstanceOf("FormData",t.formData)?n=t.formData:(n=new FormData,e.each(this._getFormData(t),function(e,t){n.append(t.name,t.value)})),t.blob?n.append(s,t.blob,r.name):e.each(t.files,function(e,r){(i._isInstanceOf("File",r)||i._isInstanceOf("Blob",r))&&n.append(t.paramName[e]||s,r,r.uploadName||r.name)})),t.data=n):(t.contentType=r.type,t.data=t.blob||r),t.blob=null},_initIframeSettings:function(t){var n=e("<a></a>").prop("href",t.url).prop("host");t.dataType="iframe "+(t.dataType||""),t.formData=this._getFormData(t),t.redirect&&n&&n!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},_initDataSettings:function(e){this._isXHRUpload(e)?(this._chunkedUpload(e,!0)||(e.data||this._initXHRData(e),this._initProgressListener(e)),e.postMessage&&(e.dataType="postmessage "+(e.dataType||""))):this._initIframeSettings(e)},_getParamName:function(t){var n=e(t.fileInput),i=t.paramName;return i?e.isArray(i)||(i=[i]):(i=[],n.each(function(){for(var t=e(this),n=t.prop("name")||"files[]",r=(t.prop("files")||[1]).length;r;)i.push(n),r-=1}),i.length||(i=[n.prop("name")||"files[]"])),i},_initFormSettings:function(t){t.form&&t.form.length||(t.form=e(t.fileInput.prop("form")),t.form.length||(t.form=e(this.options.fileInput.prop("form")))),t.paramName=this._getParamName(t),t.url||(t.url=t.form.prop("action")||location.href),t.type=(t.type||"string"===e.type(t.form.prop("method"))&&t.form.prop("method")||"").toUpperCase(),"POST"!==t.type&&"PUT"!==t.type&&"PATCH"!==t.type&&(t.type="POST"),t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},_getAJAXSettings:function(t){var n=e.extend({},this.options,t);return this._initFormSettings(n),this._initDataSettings(n),n},_getDeferredState:function(e){return e.state?e.state():e.isResolved()?"resolved":e.isRejected()?"rejected":"pending"},_enhancePromise:function(e){return e.success=e.done,e.error=e.fail,e.complete=e.always,e},_getXHRPromise:function(t,n,i){var r=e.Deferred(),o=r.promise();return n=n||this.options.context||o,t===!0?r.resolveWith(n,i):t===!1&&r.rejectWith(n,i),o.abort=r.promise,this._enhancePromise(o)},_addConvenienceMethods:function(t,n){var i=this,r=function(t){return e.Deferred().resolveWith(i,t).promise()};n.process=function(t,o){return(t||o)&&(n._processQueue=this._processQueue=(this._processQueue||r([this])).pipe(function(){return n.errorThrown?e.Deferred().rejectWith(i,[n]).promise():r(arguments)}).pipe(t,o)),this._processQueue||r([this])},n.submit=function(){return"pending"!==this.state()&&(n.jqXHR=this.jqXHR=i._trigger("submit",e.Event("submit",{delegatedEvent:t}),this)!==!1&&i._onSend(t,this)),this.jqXHR||i._getXHRPromise()},n.abort=function(){return this.jqXHR?this.jqXHR.abort():(this.errorThrown="abort",i._getXHRPromise())},n.state=function(){return this.jqXHR?i._getDeferredState(this.jqXHR):this._processQueue?i._getDeferredState(this._processQueue):void 0},n.processing=function(){return!this.jqXHR&&this._processQueue&&"pending"===i._getDeferredState(this._processQueue)},n.progress=function(){return this._progress},n.response=function(){return this._response}},_getUploadedBytes:function(e){var t=e.getResponseHeader("Range"),n=t&&t.split("-"),i=n&&n.length>1&&parseInt(n[1],10);return i&&i+1},_chunkedUpload:function(t,n){t.uploadedBytes=t.uploadedBytes||0;var i,r,o=this,s=t.files[0],a=s.size,l=t.uploadedBytes,d=t.maxChunkSize||a,p=this._blobSlice,u=e.Deferred(),c=u.promise();return this._isXHRUpload(t)&&p&&(l||a>d)&&!t.data?n?!0:l>=a?(s.error=t.i18n("uploadedBytes"),this._getXHRPromise(!1,t.context,[null,"error",s.error])):(r=function(){var n=e.extend({},t),c=n._progress.loaded;n.blob=p.call(s,l,l+d,s.type),n.chunkSize=n.blob.size,n.contentRange="bytes "+l+"-"+(l+n.chunkSize-1)+"/"+a,o._initXHRData(n),o._initProgressListener(n),i=(o._trigger("chunksend",null,n)!==!1&&e.ajax(n)||o._getXHRPromise(!1,n.context)).done(function(i,s,d){l=o._getUploadedBytes(d)||l+n.chunkSize,c+n.chunkSize-n._progress.loaded&&o._onProgress(e.Event("progress",{lengthComputable:!0,loaded:l-n.uploadedBytes,total:l-n.uploadedBytes}),n),t.uploadedBytes=n.uploadedBytes=l,n.result=i,n.textStatus=s,n.jqXHR=d,o._trigger("chunkdone",null,n),o._trigger("chunkalways",null,n),a>l?r():u.resolveWith(n.context,[i,s,d])}).fail(function(e,t,i){n.jqXHR=e,n.textStatus=t,n.errorThrown=i,o._trigger("chunkfail",null,n),o._trigger("chunkalways",null,n),u.rejectWith(n.context,[e,t,i])})},this._enhancePromise(c),c.abort=function(){return i.abort()},r(),c):!1},_beforeSend:function(e,t){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(t),this._initProgressObject(t),t._progress.loaded=t.loaded=t.uploadedBytes||0,t._progress.total=t.total=this._getTotal(t.files)||1,t._progress.bitrate=t.bitrate=0,this._active+=1,this._progress.loaded+=t.loaded,this._progress.total+=t.total},_onDone:function(t,n,i,r){var o=r._progress.total,s=r._response;r._progress.loaded<o&&this._onProgress(e.Event("progress",{lengthComputable:!0,loaded:o,total:o}),r),s.result=r.result=t,s.textStatus=r.textStatus=n,s.jqXHR=r.jqXHR=i,this._trigger("done",null,r)},_onFail:function(e,t,n,i){var r=i._response;i.recalculateProgress&&(this._progress.loaded-=i._progress.loaded,this._progress.total-=i._progress.total),r.jqXHR=i.jqXHR=e,r.textStatus=i.textStatus=t,r.errorThrown=i.errorThrown=n,this._trigger("fail",null,i)},_onAlways:function(e,t,n,i){this._trigger("always",null,i)},_onSend:function(t,n){n.submit||this._addConvenienceMethods(t,n);var i,r,o,s,a=this,l=a._getAJAXSettings(n),d=function(){return a._sending+=1,l._bitrateTimer=new a._BitrateTimer,i=i||((r||a._trigger("send",e.Event("send",{delegatedEvent:t}),l)===!1)&&a._getXHRPromise(!1,l.context,r)||a._chunkedUpload(l)||e.ajax(l)).done(function(e,t,n){a._onDone(e,t,n,l)}).fail(function(e,t,n){a._onFail(e,t,n,l)}).always(function(e,t,n){if(a._onAlways(e,t,n,l),a._sending-=1,a._active-=1,l.limitConcurrentUploads&&l.limitConcurrentUploads>a._sending)for(var i=a._slots.shift();i;){if("pending"===a._getDeferredState(i)){i.resolve();break}i=a._slots.shift()}0===a._active&&a._trigger("stop")})};return this._beforeSend(t,l),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(o=e.Deferred(),this._slots.push(o),s=o.pipe(d)):(this._sequence=this._sequence.pipe(d,d),s=this._sequence),s.abort=function(){return r=[void 0,"abort","abort"],i?i.abort():(o&&o.rejectWith(l.context,r),d())},this._enhancePromise(s)):d()},_onAdd:function(t,n){var i,r,o,s,a=this,l=!0,d=e.extend({},this.options,n),p=d.limitMultiFileUploads,u=this._getParamName(d);if((d.singleFileUploads||p)&&this._isXHRUpload(d))if(!d.singleFileUploads&&p)for(o=[],i=[],s=0;s<n.files.length;s+=p)o.push(n.files.slice(s,s+p)),r=u.slice(s,s+p),r.length||(r=u),i.push(r);else i=u;else o=[n.files],i=[u];return n.originalFiles=n.files,e.each(o||n.files,function(r,s){var d=e.extend({},n);return d.files=o?s:[s],d.paramName=i[r],a._initResponseObject(d),a._initProgressObject(d),a._addConvenienceMethods(t,d),l=a._trigger("add",e.Event("add",{delegatedEvent:t}),d)}),l},_replaceFileInput:function(t){var n=t.clone(!0);e("<form></form>").append(n)[0].reset(),t.after(n).detach(),e.cleanData(t.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(e,i){return i===t[0]?n[0]:i}),t[0]===this.element[0]&&(this.element=n)},_handleFileTreeEntry:function(t,n){var i,r=this,o=e.Deferred(),s=function(e){e&&!e.entry&&(e.entry=t),o.resolve([e])};return n=n||"",t.isFile?t._file?(t._file.relativePath=n,o.resolve(t._file)):t.file(function(e){e.relativePath=n,o.resolve(e)},s):t.isDirectory?(i=t.createReader(),i.readEntries(function(e){r._handleFileTreeEntries(e,n+t.name+"/").done(function(e){o.resolve(e)}).fail(s)},s)):o.resolve([]),o.promise()},_handleFileTreeEntries:function(t,n){var i=this;return e.when.apply(e,e.map(t,function(e){return i._handleFileTreeEntry(e,n)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(t){t=t||{};var n=t.items;return n&&n.length&&(n[0].webkitGetAsEntry||n[0].getAsEntry)?this._handleFileTreeEntries(e.map(n,function(e){var t;return e.webkitGetAsEntry?(t=e.webkitGetAsEntry(),t&&(t._file=e.getAsFile()),t):e.getAsEntry()})):e.Deferred().resolve(e.makeArray(t.files)).promise()},_getSingleFileInputFiles:function(t){t=e(t);var n,i,r=t.prop("webkitEntries")||t.prop("entries");if(r&&r.length)return this._handleFileTreeEntries(r);if(n=e.makeArray(t.prop("files")),n.length)void 0===n[0].name&&n[0].fileName&&e.each(n,function(e,t){t.name=t.fileName,t.size=t.fileSize});else{if(i=t.prop("value"),!i)return e.Deferred().resolve([]).promise();n=[{name:i.replace(/^.*\\/,"")}]}return e.Deferred().resolve(n).promise()},_getFileInputFiles:function(t){return t instanceof e&&1!==t.length?e.when.apply(e,e.map(t,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(t)},_onChange:function(t){var n=this,i={fileInput:e(t.target),form:e(t.target.form)};this._getFileInputFiles(i.fileInput).always(function(r){i.files=r,n.options.replaceFileInput&&n._replaceFileInput(i.fileInput),n._trigger("change",e.Event("change",{delegatedEvent:t}),i)!==!1&&n._onAdd(t,i)})},_onPaste:function(t){var n=t.originalEvent&&t.originalEvent.clipboardData&&t.originalEvent.clipboardData.items,i={files:[]};n&&n.length&&(e.each(n,function(e,t){var n=t.getAsFile&&t.getAsFile();n&&i.files.push(n)}),this._trigger("paste",e.Event("paste",{delegatedEvent:t}),i)!==!1&&this._onAdd(t,i))},_onDrop:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var n=this,i=t.dataTransfer,r={};i&&i.files&&i.files.length&&(t.preventDefault(),this._getDroppedFiles(i).always(function(i){r.files=i,n._trigger("drop",e.Event("drop",{delegatedEvent:t}),r)!==!1&&n._onAdd(t,r)}))},_onDragOver:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var n=t.dataTransfer;n&&-1!==e.inArray("Files",n.types)&&this._trigger("dragover",e.Event("dragover",{delegatedEvent:t}))!==!1&&(t.preventDefault(),n.dropEffect="copy")},_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop}),this._on(this.options.pasteZone,{paste:this._onPaste})),e.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_setOption:function(t,n){var i=-1!==e.inArray(t,this._specialOptions);i&&this._destroyEventHandlers(),this._super(t,n),i&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var t=this.options;void 0===t.fileInput?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof e||(t.fileInput=e(t.fileInput)),t.dropZone instanceof e||(t.dropZone=e(t.dropZone)),t.pasteZone instanceof e||(t.pasteZone=e(t.pasteZone))},_getRegExp:function(e){var t=e.split("/"),n=t.pop();return t.shift(),new RegExp(t.join("/"),n)},_isRegExpOption:function(t,n){return"url"!==t&&"string"===e.type(n)&&/^\/.*\/[igm]{0,3}$/.test(n)},_initDataAttributes:function(){var t=this,n=this.options;e.each(e(this.element[0].cloneNode(!1)).data(),function(e,i){t._isRegExpOption(e,i)&&(i=t._getRegExp(i)),n[e]=i})},_create:function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(t){var n=this;t&&!this.options.disabled&&(t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(e){t.files=e,n._onAdd(null,t)}):(t.files=e.makeArray(t.files),this._onAdd(null,t)))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var n,i,r=this,o=e.Deferred(),s=o.promise();return s.abort=function(){return i=!0,n?n.abort():(o.reject(null,"abort","abort"),s)},this._getFileInputFiles(t.fileInput).always(function(e){if(!i){if(!e.length)return void o.reject();t.files=e,n=r._onSend(null,t).then(function(e,t,n){o.resolve(e,t,n)},function(e,t,n){o.reject(e,t,n)})}}),this._enhancePromise(s)}if(t.files=e.makeArray(t.files),t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})}),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","./jquery.fileupload"],e):e(window.jQuery)}(function(e){"use strict";var t=e.blueimp.fileupload.prototype.options.add;e.widget("blueimp.fileupload",e.blueimp.fileupload,{options:{processQueue:[],add:function(n,i){var r=e(this);i.process(function(){return r.fileupload("process",i)}),t.call(this,n,i)}},processActions:{},_processFile:function(t,n){var i=this,r=e.Deferred().resolveWith(i,[t]),o=r.promise();return this._trigger("process",null,t),e.each(t.processQueue,function(t,r){var s=function(t){return n.errorThrown?e.Deferred().rejectWith(i,[n]).promise():i.processActions[r.action].call(i,t,r)};o=o.pipe(s,r.always&&s)}),o.done(function(){i._trigger("processdone",null,t),i._trigger("processalways",null,t)}).fail(function(){i._trigger("processfail",null,t),i._trigger("processalways",null,t)}),o},_transformProcessQueue:function(t){var n=[];e.each(t.processQueue,function(){var i={},r=this.action,o=this.prefix===!0?r:this.prefix;e.each(this,function(n,r){"string"===e.type(r)&&"@"===r.charAt(0)?i[n]=t[r.slice(1)||(o?o+n.charAt(0).toUpperCase()+n.slice(1):n)]:i[n]=r}),n.push(i)}),t.processQueue=n},processing:function(){return this._processing},process:function(t){var n=this,i=e.extend({},this.options,t);return i.processQueue&&i.processQueue.length&&(this._transformProcessQueue(i),0===this._processing&&this._trigger("processstart"),e.each(t.files,function(r){var o=r?e.extend({},i):i,s=function(){return t.errorThrown?e.Deferred().rejectWith(n,[t]).promise():n._processFile(o,t)};o.index=r,n._processing+=1,n._processingQueue=n._processingQueue.pipe(s,s).always(function(){n._processing-=1,0===n._processing&&n._trigger("processstop")})})),this._processingQueue},_create:function(){this._super(),this._processing=0,this._processingQueue=e.Deferred().resolveWith(this).promise()}})}),function(){}.call(this),function(){var AutoComplete,bind=function(e,t){return function(){return e.apply(t,arguments)}};jQuery(function(){return $(document).on("focus","input[data-type='autocomplete']",function(e){var t;return $(this).hasClass("ui-autocomplete-input")||new AutoComplete($(this)),t=$(this),function(e){var t;return t=function(){return e.val().length&&e.is(":focus")?e.autocomplete("search"):void 0},setTimeout(t,150)}(t)})}),AutoComplete=function(){function AutoComplete(e){this.setExtendedValue=bind(this.setExtendedValue,this),this.onChange=bind(this.onChange,this),this.focus=bind(this.focus,this),this.select=bind(this.select,this),this.remote_source=bind(this.remote_source,this),this.setup=bind(this.setup,this),this.delegateEvents=bind(this.delegateEvents,this),this.setup(e),this.delegateEvents()}return AutoComplete.prototype.delegateEvents=function(){return this.el.bind("blur",function(e){return function(t){return null!=e.current_ajax?e.current_ajax.abort():void 0}}(this)),this.el.bind("change",this.onChange)},AutoComplete.prototype.setup=function(e,t){return this.el=$(e),this.el.data("_autocomplete",this["this"]),this.data=this.el.data(),this.el.autocomplete({source:null!=t?t:null!=this.data.autocomplete_data?this.data.autocomplete_data:this.data.url?this.remote_source:void 0,select:this.select,focus:this.focus,appendTo:this.el.closest(".modal").length?this.el.closest(".modal"):this.el.closest("form")}),this.el.autocomplete("widget").addClass(this.data.autocomplete_class),this.data.autocomplete_search_on_focus===!0&&this.el.bind("focus",function(e){return function(t){return e.el.autocomplete("option","minLength",0),e.el.autocomplete("search",""),e.el.autocomplete("widget").position({of:e.el,my:"right top",at:"right bottom"}),window.setTimeout(function(){return e.el.is(":focus")?e.el.select():void 0},100)}}(this)),null!=this.data.autocomplete_element_tmpl?this.el.data("uiAutocomplete")._renderItem=function(e){return function(t,n){return $(App.Render(e.data.autocomplete_element_tmpl,n)).data("value",n).appendTo(t)}}(this):void 0},AutoComplete.prototype.remote_source=function(e,t){var n,i;return n={format:"json"},n[null!=(i=this.data.autocomplete_search_attr)?i:"term"]=e.term,null!=this.data.autocomplete_with&&(n=$.extend(!0,n,{"with":this.data.autocomplete_with})),this.el.autocomplete("widget").scrollTop(0),null!=this.current_ajax&&this.current_ajax.abort(),this.current_ajax=$.ajax({url:this.data.url,data:n,dataType:"json",
success:function(e){return function(n){var i,r;return(null!=(r=n.entries)?r.length:void 0)&&(n=n.entries),i=$.map(n,function(t){var n;return t.label=null!=e.data.autocomplete_display_attribute?(n=t[e.data.autocomplete_display_attribute],null!=e.data.autocomplete_display_attribute_ext?n=[n,t[e.data.autocomplete_display_attribute_ext]].join(" "):void 0,n):t.label,null!=e.data.autocomplete_value_attribute&&(t.value=t[e.data.autocomplete_value_attribute]),t}),(null!=e.data.autocomplete_search_only_on_focus||null!=e.data.autocomplete_search_only_once)&&(e.setup(e.el,i),e.el.bind("blur",function(){return e.setup(e.el,e.source)})),t(i)}}(this)})},AutoComplete.prototype.select=function(event,element){var callback,el,labelValue,value;return this.data.autocomplete_clear_input_value_on_select===!0?this.el.val(""):(labelValue=element.item[this.data.autocomplete_display_attribute],null!=element.item[this.data.autocomplete_display_attribute_ext]&&(labelValue+=" "+element.item[this.data.autocomplete_display_attribute_ext]),this.el.val(labelValue)),value=null!=this.data.autocomplete_value_attribute?element.item[this.data.autocomplete_value_attribute]:element.item.value,this.data.autocomplete_blur_on_select===!0&&this.el.blur(),null!=this.data.autocomplete_value_target&&this.el.prevAll("input[name='"+this.data.autocomplete_value_target+"']").val(value).change(),null!=this.data.autocomplete_select_callback&&(el=$(event.currentTarget),callback=eval(this.data.autocomplete_select_callback),null!=callback&&callback(element,event)),this.setExtendedValue(),!1},AutoComplete.prototype.focus=function(e,t){return!1},AutoComplete.prototype.onChange=function(e){var t;return t=$(e.currentTarget),this.setExtendedValue(),$("input[name='"+this.data.autocomplete_value_target+"']").val(null)},AutoComplete.prototype.setExtendedValue=function(){return this.el.data("autocomplete_extensible")?this.el.prevAll("input[name='"+this.data.autocomplete_extended_key_target+"'][data-type='extended-value']").val(this.el.val()):void 0},AutoComplete}(),window.AutoComplete=AutoComplete}.call(this),function(){jQuery(function(){return $(document).on("focus","input[data-type='datepicker']",function(e){var t,n;return t=$(this),t.hasClass("hasDatepicker")?void 0:(t.datepicker(),n=t.prev("input[type=hidden]"),n.val().length&&t.val(moment(n.val()).format(i18n.date.L)),t.on("change",function(){var e;return e=t.val(),_.isEmpty(e)||(e=moment(e,i18n.date.L).format("YYYY-MM-DD")),n.val(e)}))})})}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ManageBookingCalendar=function(n){function i(){return this.isClosedDay=e(this.isClosedDay,this),this.getInventoryPool=e(this.getInventoryPool,this),this.selectedPartitions=e(this.selectedPartitions,this),this.setupPartitionSelector=e(this.setupPartitionSelector,this),this.getHolidays=e(this.getHolidays,this),this.setQuantityText=e(this.setQuantityText,this),this.setDayElement=e(this.setDayElement,this),this.getGroupIds=e(this.getGroupIds,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.setup=function(e){return this.partitionSelector_el=this.el.find("select#booking-calendar-partitions"),e.startDateDisabled&&(this.startDate_el.prop("disabled",!0),this.startDate_el.val(moment().format("YYYY-MM-DD"))),this.reservations=e.reservations,this.models=e.models,this.setupPartitionSelector()},i.prototype.getGroupIds=function(){return this.partitionSelector_el.find("option:selected").data("value")},i.prototype.setDayElement=function(e,t,n){var i,r,o,s,a,l,d,p,u,c;for(r=!0,p=this.models,a=0,l=p.length;l>a;a++)d=p[a],i=d.availability().withoutLines(this.reservations,!0),u=this.quantity_el.val().length?parseInt(this.quantity_el.val()):_.reduce(this.reservations,function(e,t){return t.model_id===d.id?e+t.quantity:e},0),c=i.maxAvailableInTotal(e,e),s=i.maxAvailableForGroups(e,e,this.getGroupIds()),r=s>=u&&r,o=c>=u&&o;return this.models.length>1?this.setQuantityText(t,r?1:0,o?1:0):this.setQuantityText(t,s,c),this.setAvailability(t,r),this.setSelected(t,e)},i.prototype.setQuantityText=function(e,t,n){return this.models.length>1&&(t=0>=t?"x":"\u2713",n=0>=n?"x":"\u2713"),e.find(".fc-day-content > div").text(t),null!=n?e.find(".fc-day-content .total_quantity").length?e.find(".fc-day-content .total_quantity").text("/"+n):e.find(".fc-day-content").append("<span class='total_quantity'>/"+n+"</span>"):void 0},i.prototype.getHolidays=function(){return App.InventoryPool.current.holidays().all()},i.prototype.setupPartitionSelector=function(){return this.quantity_el.val().length?null==this.partitionSelector_el||0===this.partitionSelector_el.find("option").length?!1:(this.partitionSelector_el.find("option:first").select(),this.partitionSelector_el.bind("change",function(e){return function(t){return e.render()}}(this))):this.partitionSelector_el.prop("disabled",!0)},i.prototype.selectedPartitions=function(){return null!=this.partitionSelector_el&&this.partitionSelector_el.find("option").length&&this.partitionSelector_el.find("option:selected").val().length?JSON.parse(this.partitionSelector_el.find("option:selected").val()):null},i.prototype.getInventoryPool=function(){return App.InventoryPool.current},i.prototype.isClosedDay=function(e){var t;return t=this.getInventoryPool(),i.__super__.isClosedDay.apply(this,arguments)||!t.isVisitPossible(moment(e))},i}(App.BookingCalendar)}.call(this),function(){window.App.Modules.LineProblems={anyProblems:function(){return!!this.getProblems().length},getProblems:function(){var e,t,n,i,r,o;return i=[],null!=this.model_id&&(o=null!=this.subreservations?this.subreservations:[this],t=this.model().availability().withoutLines(o).maxAvailableForGroups(this.start_date,this.end_date,this.user().groupIds),r=null!=this.subreservations?_.reduce(this.subreservations,function(e,t){return e+t.quantity},0):this.quantity),moment(this.start_date).endOf("day").diff(moment().endOf("day"),"days")<0&&_.include(["approved","submitted"],this.status)||moment(this.end_date).endOf("day").diff(moment().endOf("day"),"days")<0&&"signed"===this.status?(e=_.include(["approved","submitted"],this.status)?Math.abs(moment(this.start_date).diff(moment().endOf("day"),"days")):Math.abs(moment(this.end_date).diff(moment().endOf("day"),"days")),i.push({type:"overdue",message:_jed("Overdue")+" "+_jed("since")+" "+e+" "+_jed(e,"day")})):null!=t&&r>t&&(n=this.model().availability().withoutLines(o,!0).maxAvailableInTotal(this.start_date,this.end_date),i.push({type:"availability",message:_jed("Not available")+" "+t+"("+n+")/"+this.model().availability().total_rentable})),this.item()&&(this.item().is_borrowable||i.push({type:"unborrowable",message:_jed("Item not borrowable")}),this.item().is_broken&&i.push({type:"broken",message:_jed("Item is defective")}),this.item().is_incomplete&&i.push({type:"incomplete",message:_jed("Item is incomplete")})),i}}}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;window.App.AccessRight=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.configure("AccessRight","id","role","user_id","inventory_pool_id","suspended_until"),n.belongsTo("users","App.User","user_id"),n.extend(Spine.Model.Ajax),n.url=function(){return null!=App.InventoryPool.current?"/manage/"+App.InventoryPool.current.id+"/access_rights":"/admin/access_rights"},n.rolesHierarchy=["customer","group_manager","lending_manager","inventory_manager"],n.prototype.name=function(){switch(this.role){case"admin":return _jed("Administrator");case"customer":return _jed("Customer");case"group_manager":return _jed("Group manager");case"lending_manager":return _jed("Lending manager");case"inventory_manager":return _jed("Inventory manager")}},n.atLeastRole=function(e,t){return"admin"!==e?_.indexOf(this.rolesHierarchy,e)>=_.indexOf(this.rolesHierarchy,t):void 0},n}(Spine.Model)}.call(this),function(){window.App.Availability.url=function(e){return function(){return"/manage/"+App.InventoryPool.current.id+"/availabilities"}}(this)}.call(this),function(){window.App.Building.url=function(e){return function(){return"/manage/"+App.InventoryPool.current.id+"/buildings"}}(this)}.call(this),function(){window.App.Category.url=function(e){return function(){return"/manage/"+App.InventoryPool.current.id+"/categories"}}(this)}.call(this),function(){window.App.Contract.url=function(e){return function(){return App.InventoryPool.url+"/"+App.InventoryPool.current.id+"/contracts"}}(this),window.App.Contract.prototype.approve=function(e){return $.post("/manage/"+App.InventoryPool.current.id+"/contracts/"+this.id+"/approve",{comment:e})},window.App.Contract.prototype.approve_anyway=function(e){return $.post("/manage/"+App.InventoryPool.current.id+"/contracts/"+this.id+"/approve",{force:!0,comment:e})},window.App.Contract.prototype.reject=function(e){return $.post("/manage/"+App.InventoryPool.current.id+"/contracts/"+this.id+"/reject",{comment:e})},window.App.Contract.prototype.swapUser=function(e,t){return $.post("/manage/"+App.InventoryPool.current.id+"/contracts/"+this.id+"/swap_user",{user_id:e,delegated_user_id:t})},window.App.Contract.prototype.sign=function(e){return $.post(App.InventoryPool.url+"/"+App.InventoryPool.current.id+"/contracts/"+this.id+"/sign",e)},window.App.Contract.prototype.editPath=function(){return App.Contract.url()+"/"+this.id+"/edit"},window.App.Contract.prototype.handOverPath=function(){return App.Contract.url()+"/"+this.id+"/hand_over"}}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.Field=function(n){function i(){this.getItemValueLabel=e(this.getItemValueLabel,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.configure("Field","id","attribute","default","display_attr","display_attr_ext","forPackage","extended_key","extensible","form_name","group","label","permissions","required","search_attr","search_path","type","value_attr","item_value_label","item_value_label_ext","values","visibility_dependency_field_id","visibility_dependency_value","exclude_from_submit","values_dependency_field_id","values_url","values_label_method"),i.extend(Spine.Model.Ajax),i.url=function(){return"/manage/"+App.InventoryPool.current.id+"/fields"},i.prototype.getLabel=function(){return _jed(this.label)},i.prototype.isEditable=function(e){var t;return t=!0,null!=this.permissions&&null!=e&&(null==this.permissions.role||App.AccessRight.atLeastRole(App.User.current.role,this.permissions.role)||(t=!1),null!=this.permissions.owner&&this.permissions.owner&&null!=e.owner&&App.InventoryPool.current.id!==e.owner.id&&(t=!1)),t},i.prototype.getValue=function(e,t,n){var i;return null!=e&&(i=t instanceof Array?_.reduce(t,function(e,t){return null!=e&&null!=e[t]?e[t]:null},e):e[t]),"retired"===t&&(i=!!i),null!=i?(null!=this.currency&&(i=accounting.formatMoney(i,{format:"%v"})),i):null!=this["default"]&&n?this["default"]:null},i.prototype.getItemValueLabel=function(e,t){var n,i,r;return null!=t?(i=function(e){return e instanceof Array?_.reduce(e,function(e,t){return null!=e&&null!=e[t]?e[t]:null},t):t[e]},r=i(e),(n=i(this.item_value_label_ext))&&(r=[r,n].join(" ")),r):void 0},i.prototype.getFormName=function(e,t,n){return null==e&&(e=this.attribute),null==t&&(t=this.form_name),null==n&&(n=null),null!=t?"item["+t+"]":e instanceof Array?(t=_.reduce(e,function(e,t){return e+"["+t+"]"},"item"),null!=n&&(t+="[]"),t):"item["+e+"]"},i.prototype.getExtendedKeyFormName=function(){return this.getFormName(this.extended_key,this.form_name)},i.prototype.children=function(){return _.filter(App.Field.all(),function(e){return function(t){return t.visibility_dependency_field_id===e.id}}(this))},i.prototype.childrenWithValueDependency=function(){return _.filter(App.Field.all(),function(e){return function(t){return t.values_dependency_field_id===e.id}}(this))},i.prototype.descendants=function(){var e;return e=this.children(),_.isEmpty(e)?e:_.union(e,_.flatten(_.map(e,function(e){return e.descendants()})))},i.prototype.parent=function(){return null!=this.visibility_dependency_field_id?App.Field.find(this.visibility_dependency_field_id):void 0},i.prototype.parentWithValueDependency=function(){return null!=this.values_dependency_field_id?App.Field.find(this.values_dependency_field_id):void 0},i.prototype.getValueLabel=function(e,t){return void 0===t&&(t=null),t=_.find(e,function(e){return String(e.value)===t||e.value===t}),t?t.label:""},i.getValue=function(e){var t;if(t=App.Field.find(e.data("id")),e.find("[data-value]").length)return e.find("[data-value]").attr("data-value");switch(t.type){case"radio":return e.find("input:checked").val();case"date":return e.find("input[type=hidden]").val();case"autocomplete":return e.find("input[type=hidden]").val();case"autocomplete-search":return e.find("input[type=hidden]").val();case"text":return e.find("input[type=text]").val();case"textarea":return e.find("textarea").val();case"select":return e.find("option:selected").val()}},i.validate=function(e){var t,n,i,r,o,s;for(o=!0,e.find(".error").removeClass("error"),i=e.find("[data-required='true'][data-editable='true']:visible"),t=0,n=i.length;n>t;t++)r=i[t],s=App.Field.getValue($(r)),(null==s||0===s.length)&&(o=!1,$(r).addClass("error"));return o},i.toggleChildren=function(e,t,n,r){var o,s,a,l,d,p,u,c,h;if(p=App.Field.find(e.data("id")),t=$(t),null!=p.children&&(a=p.children()),null!=a&&a.length){for(h=[],u=0,c=a.length;c>u;u++)o=a[u],l=o.visibility_dependency_value,App.Field.getValue(e)===l||_.contains(l,App.Field.getValue(e))||_.isUndefined(l)&&App.Field.isPresent(App.Field.find(o.visibility_dependency_field_id),t)?App.Field.isPresent(o,t)?h.push(void 0):r&&o.forPackage||!r?(e.after(App.Render("manage/views/items/field",{},$.extend(n,{field:o}))),s=$("[data-type='field'][data-id='"+o.id+"']"),"composite"===o.type&&new App.CompositeFieldController({el:s,data:n}),null!=o.children&&(a=o.children()),null!=a&&a.length?h.push(i.toggleChildren(s,t,n,r)):h.push(void 0)):h.push(void 0):h.push(function(){var e,n,i,r;for(i=[o].concat(o.descendants()),r=[],e=0,n=i.length;n>e;e++)d=i[e],r.push(t.find("[data-type='field'][data-id='"+d.id+"']").remove());return r}());return h}},i.isPresent=function(e,t){return!!$(t).find("[data-id='"+e.id+"']").length},i.grouped=function(e){return _.groupBy(e,function(e){return null===e.group?"":e.group})},i}(Spine.Model)}.call(this),function(){window.App.Group.url=function(e){return function(){return"/manage/"+App.InventoryPool.current.id+"/groups"}}(this)}.call(this),function(){window.App.Holiday.url=function(e){return function(){return"/manage/"+App.InventoryPool.current.id+"/holidays"}}(this)}.call(this),function(){window.App.Inventory.url=function(e){return function(){return"/manage/"+App.InventoryPool.current.id+"/inventory"}}(this),window.App.Inventory.findByInventoryCode=function(e){return function(e){return $.get("/manage/"+App.InventoryPool.current.id+"/inventory/"+e)}}(this),window.App.Inventory.fetch=function(e){return function(e){return $.get(App.Inventory.url()+".json",e)}}(this)}.call(this),function(){window.App.InventoryPool.url="/manage",window.App.InventoryPool.prototype.isOwnerOrResponsibleFor=function(e){return this.id===e.owner_id||this.id===e.inventory_pool_id}}.call(this),function(){_.invoke([window.App.Item,window.App.License],function(){return this.url=function(){return"/manage/"+App.InventoryPool.current.id+"/items"}}),_.invoke([window.App.Item,window.App.License],function(){return this.prototype.updateWithFieldData=function(e){return $.ajax({url:this.url(),data:e,type:"PUT"})}}),_.invoke([window.App.Item,window.App.License],function(){return this.prototype.inspect=function(e){var t,n;for(t in e)n=e[t],this[t]=n;return App.Item.addRecord(this),App.Item.trigger("refresh"),$.post(window.App.Item.url()+"/"+this.id+"/inspect",e)}})}.call(this),function(){_.invoke([window.App.Model,window.App.Software],function(){return this.url=function(){return"/manage/"+App.InventoryPool.current.id+"/models"}})}.call(this),function(){window.App.ModelLink.url=function(e){return function(){return"/manage/"+App.InventoryPool.current.id+"/model_links"}}(this)}.call(this),function(){window.App.Option.url=function(e){return function(){return"/manage/"+App.InventoryPool.current.id+"/options"}}(this)}.call(this),function(){window.App.Partition.url=function(e){return function(){return"/manage/"+App.InventoryPool.current.id+"/partitions"}}(this)}.call(this),function(){window.App.Purpose.url=function(e){return function(){return"/manage/"+App.InventoryPool.current.id+"/purposes"}}(this)}.call(this),function(){window.App.Reservation.url=function(e){return function(){return"/manage/"+App.InventoryPool.current.id+"/reservations"}}(this),window.App.Reservation.createOne=function(e){return $.post("/manage/"+App.InventoryPool.current.id+"/reservations",e).done(function(e){return App.Reservation.addRecord(new App.Reservation(e)),App.Contract.trigger("refresh")})},window.App.Reservation.createForTemplate=function(e){return $.post("/manage/"+App.InventoryPool.current.id+"/reservations/for_template",e).done(function(t){var n,i;return n=function(){var e,n,r;for(r=[],e=0,n=t.length;n>e;e++)i=t[e],r.push(App.Reservation.addRecord(new App.Reservation(i)));return r}(),App.Model.ajaxFetch({data:$.param({template_id:e.template_id,paginate:!1})}).done(function(e){return function(){return App.Contract.trigger("refresh")}}(this))})},window.App.Reservation.destroyMultiple=function(e){var t,n,i;for(t=0,i=e.length;i>t;t++)n=e[t],App.Reservation.find(n).remove();return $.ajax({url:"/manage/"+App.InventoryPool.current.id+"/reservations/",type:"post",data:{line_ids:e,_method:"delete"}}),App.Reservation.trigger("destroy",e)},window.App.Reservation.changeTimeRange=function(e){return function(e,t,n){return t&&(t=moment(t).format("YYYY-MM-DD")),n=moment(n).format("YYYY-MM-DD"),$.post("/manage/"+App.InventoryPool.current.id+"/reservations/change_time_range",{line_ids:_.map(e,function(e){return e.id}),start_date:t,end_date:n}).done(function(){var i,r,o,s;for(r=0,o=e.length;o>r;r++)s=e[r],i={end_date:n},t&&(i.start_date=t),s.refresh(i);return App.Contract.trigger("refresh")})}}(this),window.App.Reservation.assignOrCreate=function(e){return $.post("/manage/"+App.InventoryPool.current.id+"/reservations/assign_or_create",e)},window.App.Reservation.takeBack=function(e,t){var n;return $.post("/manage/"+App.InventoryPool.current.id+"/reservations/take_back",{ids:function(){var t,i,r;for(r=[],t=0,i=e.length;i>t;t++)n=e[t],r.push(n.id);return r}(),returned_quantity:t})},window.App.Reservation.swapUser=function(e,t){var n;return $.post("/manage/"+App.InventoryPool.current.id+"/reservations/swap_user",{line_ids:function(){var t,i,r;for(r=[],t=0,i=e.length;i>t;t++)n=e[t],r.push(n.id);return r}(),user_id:t})},Spine.Model.include.call(App.Reservation,App.Modules.LineProblems),window.App.Reservation.prototype.assign=function(e,t){return null==t&&(t=null),$.post("/manage/"+App.InventoryPool.current.id+"/reservations/"+this.id+"/assign",{inventory_code:e.inventory_code}).fail(function(e){return function(e){return App.Flash({type:"error",message:e.responseText})}}(this)).done(function(n){return function(i){var r;return n.refresh(i),App.Reservation.trigger("update",n),App.Flash({type:"success",message:_jed("%s assigned to %s",[e.inventory_code,(null!=(r=e.model())?r:e.software()).name()])}),"function"==typeof t?t():void 0}}(this))},window.App.Reservation.prototype.removeAssignment=function(){return $.post("/manage/"+App.InventoryPool.current.id+"/reservations/"+this.id+"/remove_assignment"),this.refresh({item_id:null}),App.Reservation.trigger("update",this)}}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;window.App.Role=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.configure("Role","id","name"),n.extend(Spine.Model.Ajax),n.url=function(){return"/manage/roles"},n}(Spine.Model)}.call(this),function(){window.App.Template.url=function(e){return function(){return"/manage/"+App.InventoryPool.current.id+"/templates"}}(this)}.call(this),function(){window.App.User.url=function(e){return function(){return null!=App.InventoryPool.current?"/manage/"+App.InventoryPool.current.id+"/users":"/admin/users"}}(this),window.App.User.prototype.isSuspended=function(){return _.include(App.InventoryPool.current.suspended_user_ids,this.id)}}.call(this),function(){window.App.Workday.url=function(e){return function(){return"/manage/"+App.InventoryPool.current.id+"/workdays"}}(this)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.CategoriesFilterController=function(n){function i(){this.search=e(this.search,this),this.goBack=e(this.goBack,this),this.goRoot=e(this.goRoot,this),this.select=e(this.select,this),this.getCurrent=e(this.getCurrent,this),this.getRoot=e(this.getRoot,this),this.clickCategory=e(this.clickCategory,this),this.renderSearch=e(this.renderSearch,this),this.renderLast=e(this.renderLast,this),this.renderRoot=e(this.renderRoot,this),this.renderList=e(this.renderList,this),this.render=e(this.render,this),this.fetchCategoryLinks=e(this.fetchCategoryLinks,this),this.fetchCategories=e(this.fetchCategories,this),i.__super__.constructor.apply(this,arguments),this.categoryPath=[],this.searchTerm="",this.fetchCategories().done(function(e){return function(){return e.render()}}(this)),this.fetchCategoryLinks().done(function(e){return function(){return e.render()}}(this)),this.input.preChange()}return t(i,n),i.prototype.elements={"#category-list":"list","#category-root":"rootContainer","#category-current":"currentContainer","#category-search":"input"},i.prototype.events={"click [data-type='category-filter']":"clickCategory","click [data-type='category-root']":"goRoot","click [data-type='category-current']":"goBack","preChange #category-search":"search"},i.prototype.fetchCategories=function(){return App.Category.ajaxFetch().done(function(e){return function(t){var n;return e.categories=function(){var e,i,r;for(r=[],e=0,i=t.length;i>e;e++)n=t[e],r.push(App.Category.find(n.id));return r}()}}(this))},i.prototype.fetchCategoryLinks=function(){return App.CategoryLink.ajaxFetch().done(function(e){return function(t){var n;return e.categoryLinks=function(){var e,i,r;for(r=[],e=0,i=t.length;i>e;e++)n=t[e],r.push(App.CategoryLink.find(n.id));return r}()}}(this))},i.prototype.render=function(e){var t;return t=null!=e?e.children():null!=this.categories&&null!=this.categoryLinks?null!=this.roots?this.roots:this.roots=App.Category.roots():void 0,null!=t&&this.renderList(t),this.renderRoot(),this.renderLast()},i.prototype.renderList=function(e){return this.list.html(App.Render("manage/views/categories/filter_list_entry",e))},i.prototype.renderRoot=function(){return this.searchTerm.length?!1:null!=this.getRoot()?this.rootContainer.html(App.Render("manage/views/categories/filter_list_root",this.getRoot())):this.rootContainer.html("")},i.prototype.renderLast=function(){return null!=this.getCurrent()?this.currentContainer.html(App.Render("manage/views/categories/filter_list_current",this.getCurrent())):this.currentContainer.html("")},i.prototype.renderSearch=function(e,t){return this.rootContainer.html(App.Render("manage/views/categories/filter_list_search",{search_term:this.input.val()})),this.currentContainer.html(""),t.length?this.list.html(App.Render("manage/views/categories/filter_list_entry",t)):this.list.html("")},i.prototype.clickCategory=function(e){var t,n;return n=$(e.currentTarget),t=App.Category.find(n.data("id")),this.select(t)},i.prototype.getRoot=function(){return this.categoryPath.length>1?_.first(this.categoryPath):void 0},i.prototype.getCurrent=function(){return this.categoryPath.length>0?_.last(this.categoryPath):void 0},i.prototype.select=function(e){return this.categoryPath.push(e),this.render(e),null!=this.filter?this.filter():void 0},i.prototype.goRoot=function(e){return this.categoryPath=this.categoryPath.splice(0,1),this.render(this.categoryPath[0]),null!=this.filter?this.filter():void 0},i.prototype.goBack=function(e){var t;return this.categoryPath=this.categoryPath.length>1?this.categoryPath.splice(0,this.categoryPath.length-1):this.categoryPath=[],this.categoryPath.length>1&&(t=_.last(this.categoryPath)),this.searchTerm.length&&0===this.categoryPath.length?this.search():this.render(t),null!=this.filter?this.filter():void 0},i.prototype.search=function(){var e;return this.searchTerm!==this.input.val()?(this.searchTerm=this.input.val(),this.searchTerm.length?(e=_.filter(App.Category.all(),function(e){return function(t){return t.name.match(RegExp(e.searchTerm,"i"))}}(this)),this.renderSearch(this.searchTerm,e)):this.render()):void 0},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.CategoriesIndexController=function(n){function i(){this.renderList=e(this.renderList,this),this.fetchCategoryLinks=e(this.fetchCategoryLinks,this),this.fetchCategories=e(this.fetchCategories,this),this.showLoading=e(this.showLoading,this),this.localSearch=e(this.localSearch,this),this.resetAndRender=e(this.resetAndRender,this),i.__super__.constructor.apply(this,arguments),this.showLoading(),this.fetchCategories().done(function(e){return function(){return e.fetchCategoryLinks().done(function(){return e.renderList(App.Category.roots())})}}(this)),new App.CategoriesIndexExpandController({el:this.el.find("#list")}),this.search=new App.ListSearchController({el:this.el.find("#list-search"),reset:this.resetAndRender})}return t(i,n),i.prototype.elements={"#list":"list"},i.prototype.resetAndRender=function(){var e;return this.categories={},this.showLoading(),(e=this.search.term())?this.localSearch(e):this.renderList(App.Category.roots())},i.prototype.localSearch=function(e){var t;return t=new RegExp(e,"i"),this.categories=_.filter(App.Category.all(),function(e){return e.name.match(t)}),this.renderList(this.categories)},i.prototype.showLoading=function(){return this.list.html(App.Render("manage/views/lists/loading"))},i.prototype.fetchCategories=function(){return App.Category.ajaxFetch({data:$.param({include:{"used?":!0}})}).done(function(e){return function(t){var n;return e.categories=function(){var e,i,r;for(r=[],e=0,i=t.length;i>e;e++)n=t[e],r.push(App.Category.find(n.id));return r}()}}(this))},i.prototype.fetchCategoryLinks=function(){return App.CategoryLink.ajaxFetch().done(function(e){return function(t){var n;return e.categoryLinks=function(){var e,i,r;for(r=[],e=0,i=t.length;i>e;e++)n=t[e],r.push(App.CategoryLink.find(n.id));return r}()}}(this))},i.prototype.renderList=function(e){return this.list.html(App.Render("manage/views/categories/line",e))},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.CategoriesIndexExpandController=function(n){function i(){return this.close=e(this.close,this),this.open=e(this.open,this),this.toggle=e(this.toggle,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.events={"click [data-type='expander']":"toggle"},i.prototype.toggle=function(e){var t;return t=$(e.currentTarget),null!=t.data("_expanded")&&t.data("_expanded")===!0?this.close(t):this.open(t)},i.prototype.open=function(e){var t,n,i;return e.data("_expanded",!0),e.find(".arrow").removeClass("down right").addClass("down"),i=e.closest("[data-id]"),null!=i.data("childrenContainer")?n=i.data("childrenContainer"):(t=_(App.Category.find(i.data("id")).children()).sortBy(function(e){return function(e){return e.name}}(this)),n=$("<div class='group-of-lines level-padding'></div>"),n.append(App.Render("manage/views/categories/line",t)),i.data("childrenContainer",n)),i.after(n)},i.prototype.close=function(e){var t,n;return e.data("_expanded",!1),e.find(".arrow").removeClass("down right").addClass("right"),n=e.closest("[data-id]"),t=n.next(),t.detach()},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.AddInlineEntryController=function(n){function i(){return this.select=e(this.select,this),this.fetch=e(this.fetch,this),this.source=e(this.source,this),this.setupAutocomplete=e(this.setupAutocomplete,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.events={"focus input[data-type='autocomplete']":"setupAutocomplete"},i.prototype.elements={"input[data-type='autocomplete']":"input",".list-of-lines":"list"},i.prototype.setupAutocomplete=function(e){return this.input.autocomplete({source:this.source,focus:function(e){return function(){return!1}}(this),select:this.select,minLength:0}).data("uiAutocomplete")._renderItem=function(e){return function(e,t){return $(App.Render("views/autocomplete/element",t)).data("value",t).appendTo(e)}}(this),this.input.autocomplete("search")},i.prototype.source=function(e,t){return this.fetch(e.term).done(function(e){return function(n){return n=_.map(n,function(t){var n;return{label:null!=(n="function"==typeof e.customLabelFn?e.customLabelFn(t):void 0)?n:t.name,record:App[e.model].find(t.id)}}),e.input.is(":focus")?t(n):void 0}}(this))},i.prototype.fetch=function(e){return App[this.model].ajaxFetch({data:$.param({search_term:e})})},i.prototype.select=function(e,t){var n;return n=t.item.record,this.input.val("").blur(),this.input.autocomplete("destroy"),this.list.find(this.getExistingEntry(n)).length||this.list.prepend(App.Render(this.templatePath,n,{uid:App[this.model].uid("uid")})),e.preventDefault(),!1},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.CategoriesLinksController=function(n){function i(){this.select=e(this.select,this),this.source=e(this.source,this),this.getExistingEntry=e(this.getExistingEntry,this),i.__super__.constructor.apply(this,arguments),this.model="Category",this.templatePath="manage/views/categories/category_link_inline_entry"}return t(i,n),i.prototype.getExistingEntry=function(e){return this.list.find("input[name*='parent_id'][value='"+e.id+"']")},i.prototype.source=function(e,t){return this.fetch(e.term).done(function(e){return function(n){return e.category&&(n=_.filter(n,function(t){return t.id!==e.category.id})),n=_.map(n,function(t){return{label:t.name,record:App[e.model].find(t.id)}}),t(n)}}(this))},i.prototype.select=function(e,t){var n;return n=t.item.record,this.input.autocomplete("destroy"),this.input.val("").blur(),this.list.find(this.getExistingEntry(n)).length||this.list.prepend(App.Render(this.templatePath,n,{uid:App[this.model].uid("uid"),label:this.labelInput.val()})),!1},i}(App.AddInlineEntryController)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.FormWithUploadController=function(n){function i(){return this.setupErrorModal=e(this.setupErrorModal,this),this.collectErrorMessages=e(this.collectErrorMessages,this),this.showError=e(this.showError,this),this.hideLoading=e(this.hideLoading,this),
this.showLoading=e(this.showLoading,this),this.save=e(this.save,this),this.done=e(this.done,this),this.errorHandler=e(this.errorHandler,this),this.submit=e(this.submit,this),this.preventDefaultSubmit=e(this.preventDefaultSubmit,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.elements={"#form":"form","#save":"saveButton"},i.prototype.events={"click #save":"submit","submit #form":"preventDefaultSubmit"},i.prototype.preventDefaultSubmit=function(e){return e.preventDefault()},i.prototype.submit=function(e,t,n){var i;return null==t&&(t=this.save),null==n&&(n=this.errorHandler),this.showLoading(),(i=t())?i.fail(function(e){return function(e){return n(e)}}(this)).done(function(e){return function(t){return e.done(t)}}(this)):void 0},i.prototype.errorHandler=function(e){return this.showError(e.responseText),this.hideLoading()},i.prototype.done=function(){},i.prototype.save=function(){},i.prototype.showLoading=function(){var e;return e=$(App.Render("views/loading",{size:"micro"})),this.saveButton.data("origin",this.saveButton.html()),this.saveButton.html(e),this.saveButton.prop("disabled",!0)},i.prototype.hideLoading=function(){return this.saveButton.html(this.saveButton.data("origin")),this.saveButton.prop("disabled",!1)},i.prototype.showError=function(e){return App.Flash({type:"error",message:e})},i.prototype.collectErrorMessages=function(){},i.prototype.setupErrorModal=function(e){var t,n,i;return t=this.collectErrorMessages(),i=App.Render("manage/views/templates/upload/upload_errors_dialog",{errors:t,url:e.url("edit"),headlineMessage:_jed("%s was saved, but there were problems uploading files",_jed(e.constructor.name)),buttonLabel:_jed("Edit %s",_jed(e.constructor.name))}),n=new App.Modal(i),n.undestroyable()},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.CategoryController=function(n){function i(){this.collectErrorMessages=e(this.collectErrorMessages,this),this.finish=e(this.finish,this),this.done=e(this.done,this),i.__super__.constructor.apply(this,arguments),this.imagesController=new App.ImagesController({el:this.el.find("#images"),url:this.category.url("upload/image"),click:function(){return this.list.find(".line:not(.striked)").length||this.uploadList.length?alert(_jed("Category can have only one image.")):this.el.find("input[type='file']").trigger("click")}}),new App.InlineEntryRemoveController({el:this.el}),new App.CategoriesLinksController({el:this.el.find("#categories"),labelInput:this.el.find("#name-input"),category:this.category})}return t(i,n),i.prototype.done=function(){return this.imagesController.upload(function(e){return function(){return e.finish()}}(this))},i.prototype.finish=function(){return this.imagesController.uploadErrors.length?this.setupErrorModal(this.category):window.location=App.Category.url()+("?flash[success]="+_jed("Category saved"))},i.prototype.collectErrorMessages=function(){return this.imagesController.uploadErrors.join(", ")},i}(App.FormWithUploadController)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.EditCategoryController=function(n){function i(){return this.save=e(this.save,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.save=function(){return $.ajax({url:this.category.url(),data:this.form.serializeArray(),type:"PUT"})},i}(App.CategoryController)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.NewCategoryController=function(n){function i(){return this.updateUploadURL=e(this.updateUploadURL,this),this.save=e(this.save,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.save=function(){return $.post(App.Category.url(),this.form.serializeArray()).done(function(e){return function(t){return e.category.id=t.id,e.updateUploadURL()}}(this))},i.prototype.updateUploadURL=function(){return this.imagesController.url=this.category.url("upload/image")},i}(App.CategoryController)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ContractsApproveController=function(n){function i(){return this.fetchOptions=e(this.fetchOptions,this),this.fetchModels=e(this.fetchModels,this),this.fetchData=e(this.fetchData,this),this.approve=e(this.approve,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.events={"click [data-order-approve]":"approve"},i.prototype.approve=function(e){var t,n,i,r,o,s,a,l;return l=$(e.currentTarget),App.Button.disable(l),r=null!=(o=this.order)?o:App.Contract.findOrBuild(l.closest("[data-id]").data()),n=null!=(s=this.done)?s:function(e){return function(){var e;return e=l.closest(".line"),null!=e?e.html(App.Render("manage/views/contracts/line_approved",r,{accessRight:App.AccessRight,currentUserRole:App.User.current.role})):void 0}}(this),i=null!=(a=this.fail)?a:function(e){return function(t){var n;return n=function(){var n;return n=l.closest(".line"),new App.ContractsApproveFailedController({order:r,line:n,trigger:l,error:t.responseText,done:e.done}),App.Button.enable(l)},e.fetchData(r,n)}}(this),t=null!=this.comment?"function"==typeof this.comment?this.comment():this.comment:void 0,r.approve(t).done(n).fail(i)},i.prototype.fetchData=function(e,t){var n,i,r,o,s,a;for(o=[],s=[],a=e.reservations().all(),n=0,i=a.length;i>n;n++)r=a[n],null!=r.model_id?null==App.Model.exists(r.model_id)&&o.push(r.model_id):null!=r.option_id&&null==App.Option.exists(r.option_id)&&s.push(r.option_id);return this.fetchModels(o).done(function(e){return function(){return e.fetchOptions(s).done(function(){return t()})}}(this))},i.prototype.fetchModels=function(e){return e.length?App.Model.ajaxFetch({data:$.param({ids:e})}):{done:function(e){return e()}}},i.prototype.fetchOptions=function(e){return e.length?App.Option.ajaxFetch({data:$.param({ids:e})}):{done:function(e){return e()}}},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ContractsApproveFailedController=function(n){function i(t){this.approveAnyway=e(this.approveAnyway,this);var n;this.trigger=$(t.trigger),this.order=t.order,this.order.error=t.error,n=App.Render("manage/views/contracts/approval_failed_modal",this.order,{comment:t.comment,accessRight:App.AccessRight,currentUserRole:App.User.current.role}),this.modal=new App.Modal(n),this.el=this.modal.el,i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.elements={"#comment":"commentEl"},i.prototype.events={"click [data-approve-anyway]":"approveAnyway"},i.prototype.approveAnyway=function(){var e;return e=this.commentEl.val().length?this.commentEl.val():void 0,this.modal.destroy(!1),this.modal.undestroyable(),this.order.approve_anyway(e).done(function(e){return function(){return e.modal.destroyable().destroy(!0),e.done?e.done():e.line.html(App.Render("manage/views/contracts/line_approved",e.order,{accessRight:App.AccessRight,currentUserRole:App.User.current.role}))}}(this))},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ContractsApproveWithCommentController=function(n){function i(t){this.approved=e(this.approved,this);var n;this.trigger=t.trigger,this.contract=t.contract,n=App.Render("manage/views/contracts/approve_with_comment_modal",this.contract),this.modal=new App.Modal(n),this.el=this.modal.el,i.__super__.constructor.apply(this,arguments),new App.ContractsApproveController({el:this.el,done:this.approved,comment:function(e){return function(){return e.comment.val()}}(this)})}return t(i,n),i.prototype.elements={"#comment":"comment"},i.prototype.approved=function(){return window.location="/manage/"+App.InventoryPool.current.id+"/daily?flash[success]="+_jed("Order approved")},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ContractsEditController=function(n){function i(){this.contractApproved=e(this.contractApproved,this),this.approveContractWithComment=e(this.approveContractWithComment,this),this.renderPurpose=e(this.renderPurpose,this),this.swapUser=e(this.swapUser,this),this.editPurpose=e(this.editPurpose,this),this.render=e(this.render,this),this.fetchAvailability=e(this.fetchAvailability,this),this.validateLineDeletion=e(this.validateLineDeletion,this),this.setupLineSelection=e(this.setupLineSelection,this),this.setupAddLine=e(this.setupAddLine,this),this.delegateEvents=e(this.delegateEvents,this),i.__super__.constructor.apply(this,arguments),this.setupLineSelection(),this.fetchAvailability(),this.setupAddLine(),new App.SwapModelController({el:this.el}),new App.TimeLineController({el:this.el}),new App.ContractsApproveController({el:this.el,done:this.contractApproved}),new App.ContractsRejectController({el:this.el,async:!1}),new App.ReservationsDestroyController({el:this.el}),new App.ReservationsEditController({el:this.el,user:this.contract.user(),contract:this.contract}),new App.ModelCellTooltipController({el:this.el})}return t(i,n),i.prototype.elements={"#status":"status","#lines":"reservationsContainer","#purpose":"purposeContainer","#reject-contract":"rejectButton","#approve-contract":"approveButton"},i.prototype.events={"click #edit-purpose.button":"editPurpose","click #swap-user":"swapUser","click #approve-with-comment":"approveContractWithComment","click [data-destroy-line]":"validateLineDeletion","click [data-destroy-lines]":"validateLineDeletion","click [data-destroy-selected-lines]":"validateLineDeletion"},i.prototype.delegateEvents=function(){return i.__super__.delegateEvents.apply(this,arguments),App.Purpose.on("update",this.renderPurpose),App.Reservation.on("change destroy",this.fetchAvailability),App.Contract.on("refresh",this.fetchAvailability)},i.prototype.setupAddLine=function(){var e,t,n,i;return i=this,n=new App.ReservationsAddController({el:this.el.find("#add"),user:this.contract.user(),status:this.status,contract:this.contract,purpose:this.purpose,modelsPerPage:20}),e=function(e){return console.log("onChangeCallback"),i.inputValue=e,i.autocompleteController.setProps({isLoading:!0}),n.search(e,function(e){return i.autocompleteController.setProps({searchResults:e,isLoading:!1})})},t={onChange:_.debounce(e,300),onSelect:n.select,isLoading:!1,placeholder:_jed("Inventory code, model name, search term")},this.autocompleteController=new App.HandOverAutocompleteController(t,this.el.find("#add-input")[0]),this.autocompleteController._render(),window.autocompleteController=this.autocompleteController,n.setupAutocomplete(this.autocompleteController)},i.prototype.setupLineSelection=function(){return this.lineSelection=new App.LineSelectionController({el:this.el})},i.prototype.validateLineDeletion=function(e){var t;return t=$(e.currentTarget).closest("[data-id]").length?[$(e.currentTarget).closest("[data-id]").data("id")]:null!=$(e.currentTarget).data("ids")?$(e.currentTarget).data("ids"):App.LineSelectionController.selected,this.contract.reservations().all().length<=t.length?(App.Flash({type:"error",message:_jed("You cannot delete all reservations of an contract. Perhaps you want to reject it instead?")}),e.stopImmediatePropagation(),!1):void 0},i.prototype.fetchAvailability=function(){return this.render(!1),this.status.html(App.Render("manage/views/availabilities/loading")),App.Availability.ajaxFetch({data:$.param({model_ids:_.uniq(_.map(this.contract.reservations().all(),function(e){return e.model().id})),user_id:this.contract.user_id})}).done(function(e){return function(t){return e.status.html(App.Render("manage/views/availabilities/loaded")),e.render(!0)}}(this))},i.prototype.render=function(e){return this.reservationsContainer.html(App.Render("manage/views/reservations/grouped_lines",this.contract.groupedLinesByDateRange(!0),{linePartial:"manage/views/reservations/order_line",renderAvailability:e})),this.lineSelection.restore()},i.prototype.editPurpose=function(){return new App.ContractsEditPurposeController({purpose:this.purpose})},i.prototype.swapUser=function(){return new App.SwapUsersController({contract:this.contract,manageContactPerson:!0})},i.prototype.renderPurpose=function(){return this.purposeContainer.html(this.purpose.description)},i.prototype.approveContractWithComment=function(){return new App.ContractsApproveWithCommentController({trigger:this.approveButton,contract:this.contract})},i.prototype.contractApproved=function(){return window.location="/manage/"+App.InventoryPool.current.id+"/daily?flash[success]="+_jed("Order approved")},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ContractsEditPurposeController=function(n){function i(t){this.delegateEvents=e(this.delegateEvents,this),this.modal=new App.Modal(App.Render("manage/views/contracts/edit/purpose_modal",t.purpose)),this.el=this.modal.el,i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.elements={textarea:"textarea","#errors":"errorsContainer"},i.prototype.events={"submit form":"submit"},i.prototype.delegateEvents=function(){return i.__super__.delegateEvents.apply(this,arguments)},i.prototype.submit=function(e){return e.preventDefault(),this.purpose.description=_.string.clean(this.textarea.val()),this.errorsContainer.addClass("hidden"),this.purpose.save()?this.modal.destroy(!0):(this.errorsContainer.removeClass("hidden"),this.errorsContainer.find("strong").text(this.purpose.validate()))},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ContractsIndexController=function(n){function i(){this.render=e(this.render,this),this.fetchPurposes=e(this.fetchPurposes,this),this.fetchUsers=e(this.fetchUsers,this),this.fetchReservations=e(this.fetchReservations,this),this.fetchContracts=e(this.fetchContracts,this),this.fetch=e(this.fetch,this),this.reset=e(this.reset,this),i.__super__.constructor.apply(this,arguments),new App.LinesCellTooltipController({el:this.el}),new App.UserCellTooltipController({el:this.el}),new App.ContractsApproveController({el:this.el}),new App.ContractsRejectController({el:this.el,async:!0,callback:this.orderRejected}),this.pagination=new App.ListPaginationController({el:this.list,fetch:this.fetch}),this.search=new App.ListSearchController({el:this.el.find("#list-search"),reset:this.reset}),this.filter=new App.ListFiltersController({el:this.el.find("#list-filters"),reset:this.reset}),this.range=new App.ListRangeController({el:this.el.find("#list-range"),reset:this.reset}),this.tabs=new App.ListTabsController({el:this.el.find("#list-tabs"),reset:this.reset,data:{status:this.status}}),this.reset()}return t(i,n),i.prototype.elements={"#contracts":"list"},i.prototype.reset=function(){return this.contracts={},this.list.html(App.Render("manage/views/lists/loading")),this.fetch(1,this.list),this.pagination.page=1},i.prototype.fetch=function(e,t){return this.fetchContracts(e).done(function(n){return function(){return n.fetchUsers(e).done(function(){return n.fetchReservations(e,function(){return n.fetchPurposes(e,function(){return n.render(t,n.contracts[e],e)})})})}}(this))},i.prototype.fetchContracts=function(e){var t;return t=$.extend(this.tabs.getData(),$.extend(this.filter.getData(),{search_term:this.search.term(),page:e,range:this.range.get()})),"group_manager"===App.User.current.role&&(t=$.extend(t,{from_verifiable_users:!0})),App.Contract.ajaxFetch({data:$.param(t)}).done(function(t){return function(n,i,r){var o,s;return t.pagination.set(JSON.parse(r.getResponseHeader("X-Pagination"))),o=function(){var e,t,i;for(i=[],e=0,t=n.length;t>e;e++)s=n[e],i.push(App.Contract.find(s.id));return i}(),t.contracts[e]=o}}(this))},i.prototype.fetchReservations=function(e,t){var n,i;return i=_.map(this.contracts[e],function(e){return e.id}),i.length||t(),n=_.after(Math.ceil(i.length/50),t),_(i).each_slice(50,function(e){return function(e){return App.Reservation.ajaxFetch({data:$.param({contract_ids:e})}).done(n)}}(this))},i.prototype.fetchUsers=function(e){var t;return t=_.filter(_.map(this.contracts[e],function(e){return e.user_id}),function(e){return null==App.User.exists(e)}),t.length?App.User.ajaxFetch({data:$.param({ids:_.uniq(t),all:!0})}).done(function(e){return function(e){var t,n;return n=function(){var n,i,r;for(r=[],n=0,i=e.length;i>n;n++)t=e[n],r.push(App.User.find(t.id));return r}(),App.User.fetchDelegators(n)}}(this)):{done:function(e){return function(e){return e()}}(this)}},i.prototype.fetchPurposes=function(e,t){var n,i;return i=_.compact(_.filter(_.map(_.flatten(_.map(this.contracts[e],function(e){return e.reservations().all()})),function(e){return e.purpose_id}),function(e){return null==App.Purpose.exists(e)})),i.length||t(),n=_.after(Math.ceil(i.length/50),t),_(i).each_slice(50,function(e){return function(e){return App.Purpose.ajaxFetch({data:$.param({purpose_ids:_.uniq(e)})}).done(n)}}(this))},i.prototype.render=function(e,t,n){return e.html(App.Render("manage/views/contracts/line",t,{accessRight:App.AccessRight,currentUserRole:App.User.current.role})),1===n?this.pagination.renderPlaceholders():void 0},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ContractsRejectController=function(n){function i(){return this.fetchOptions=e(this.fetchOptions,this),this.fetchModels=e(this.fetchModels,this),this.fetchData=e(this.fetchData,this),this.reject=e(this.reject,this),this.setupModal=e(this.setupModal,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.events={"click [data-order-reject]":"setupModal"},i.prototype.setupModal=function(e){var t;return this.trigger=$(e.currentTarget),this.order=App.Contract.findOrBuild(this.trigger.closest("[data-id]").data()),t=function(e){return function(){return e.modal=new App.Modal(App.Render("manage/views/contracts/reject_modal",e.order)),e.async?e.modal.el.on("submit","form",e.reject):void 0}}(this),this.fetchData(this.order,t)},i.prototype.reject=function(e){var t,n,i;return e.preventDefault(),n=this.modal.el.find("#rejection-comment").val(),this.order.reject(n),this.modal.destroy(!0),t=null!=(i=this.callback)?i:function(e){return function(){var t;return t=$(e.trigger).closest(".multibutton").length?$(e.trigger).closest(".multibutton").find(".button:first"):$(e.trigger),t.html(App.Render("manage/views/contracts/rejected_button")),App.Button.disable(t)}}(this),t.call(this)},i.prototype.fetchData=function(e,t){var n,i,r,o,s,a;for(o=[],s=[],a=e.reservations().all(),n=0,i=a.length;i>n;n++)r=a[n],null!=r.model_id?null==App.Model.exists(r.model_id)&&o.push(r.model_id):null!=r.option_id&&null==App.Option.exists(r.option_id)&&s.push(r.option_id);return this.fetchModels(o).done(function(e){return function(){return e.fetchOptions(s).done(function(){return t()})}}(this))},i.prototype.fetchModels=function(e){return e.length?App.Model.ajaxFetch({data:$.param({ids:e})}):{done:function(e){return e()}}},i.prototype.fetchOptions=function(e){return e.length?App.Option.ajaxFetch({data:$.param({ids:e})}):{done:function(e){return e()}}},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.DocumentsAfterHandOverController=function(n){function i(){this.printContract=e(this.printContract,this),this.setupModal=e(this.setupModal,this),i.__super__.constructor.apply(this,arguments),this.setupModal(),this.printContract()}return t(i,n),i.prototype.setupModal=function(){var e,t;return t=App.Render("manage/views/users/hand_over_documents_dialog",{contract:this.contract,itemsCount:this.itemsCount}),e=new App.Modal(t),e.undestroyable(),this.el=e.el},i.prototype.printContract=function(){return App.InventoryPool.current.print_contracts?window.open(this.contract.url()+"?print=true"):void 0},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.HandOverController=function(n){function i(){this.validate=e(this.validate,this),this.swapUser=e(this.swapUser,this),this.handOver=e(this.handOver,this),this.render=e(this.render,this),this.fetchFunctionsSetup=e(this.fetchFunctionsSetup,this),this.getLines=e(this.getLines,this),this.fetchAvailability=e(this.fetchAvailability,this),this.initalFetch=e(this.initalFetch,this),this.delegateEvents=e(this.delegateEvents,this),i.__super__.constructor.apply(this,arguments),this.lineSelection=new App.LineSelectionController({el:this.el,markVisitLinesController:new App.MarkVisitLinesController({el:this.el})}),this.fetchFunctionsSetup({Model:"Item",Software:"License"}),this.initalFetch(),new App.SwapModelController({el:this.el}),new App.ReservationsDestroyController({el:this.el}),new App.ReservationAssignItemController({el:this.el}),new App.TimeLineController({el:this.el}),new App.ReservationAssignOrCreateController({el:this.el.find("#assign-or-add"),user:this.user,contract:this.contract}),new App.ReservationsEditController({el:this.el,user:this.user,contract:this.contract}),new App.OptionLineChangeController({el:this.el}),new App.ModelCellTooltipController({el:this.el})}return t(i,n),i.prototype.elements={"#status":"status","#lines":"reservationsContainer"},i.prototype.events={"click [data-hand-over-selection]":"handOver","click #swap-user":"swapUser"},i.prototype.delegateEvents=function(){return i.__super__.delegateEvents.apply(this,arguments),App.Reservation.on("change destroy",function(e){return function(t){return null!=t.option_id?e.render(!0):e.fetchAvailability()}}(this)),App.Contract.on("refresh",this.fetchAvailability),App.Reservation.on("update",function(e){return function(t){var n,i;return e.notFetchedItemIds().length&&(n=e.fetchItems()),e.notFetchedLicenseIds().length&&(i=e.fetchLicenses()),n||i?$.when(n,i).done(function(){return e.render(null!=e.initialAvailabilityFetched)}):e.render(null!=e.initialAvailabilityFetched)}}(this))},i.prototype.initalFetch=function(){var e,t;return this.getLines().length?(this.notFetchedItemIds().length&&(e=$.Deferred(this.fetchItems)),this.notFetchedLicenseIds().length&&(t=$.Deferred(this.fetchLicenses)),null!=e||null!=t?$.when(e,t).done(this.fetchAvailability):this.fetchAvailability()):void 0},i.prototype.fetchAvailability=function(){var e;return this.render(!1),e=_.uniq(_.map(_.filter(this.getLines(),function(e){return null!=e.model_id}),function(e){return e.model().id})),e.length?(this.status.html(App.Render("manage/views/availabilities/loading")),App.Availability.ajaxFetch({data:$.param({model_ids:e,user_id:this.user.id})}).done(function(e){return function(t){return e.initialAvailabilityFetched=!0,e.status.html(App.Render("manage/views/availabilities/loaded")),e.render(!0)}}(this))):this.status.html(App.Render("manage/views/users/hand_over/no_handover_found"))},i.prototype.getLines=function(){return _.flatten(_.map(this.user.contracts().all(),function(e){return e.reservations().all()}))},i.prototype.fetchFunctionsSetup=function(e){var t,n;return n=function(e){return function(t,n){return _.filter(_.compact(_.map(e.getLines(),function(e){return e.model().constructor.name===t?e.item_id:null})),function(e){return null==App[n].exists(e)})}}(this),t=function(e){return function(e,t){return App[e].ajaxFetch({data:$.param({ids:t,paginate:"false"})})}}(this),_.each(e,function(e){return function(i,r){var o;return o="notFetched"+i+"Ids",e[o]=function(){return n(r,i)},e["fetch"+i+"s"]=function(){return t(i,e[o]())}}}(this))},i.prototype.render=function(e){return this.reservationsContainer.html(App.Render("manage/views/reservations/grouped_lines_with_action_date",App.Modules.HasLines.groupByDateRange(this.getLines(),!1,"start_date"),{linePartial:"manage/views/reservations/hand_over_line",renderAvailability:e})),this.lineSelection.restore()},i.prototype.handOver=function(){return this.validate()?new App.HandOverDialogController({user:this.user,contract:this.contract}):App.Flash({type:"error",message:_jed("End Date cannot be in the past")})},i.prototype.swapUser=function(){var e,t;return t=function(){var t,n,i,r;for(i=App.LineSelectionController.selected,r=[],t=0,n=i.length;n>t;t++)e=i[t],r.push(App.Reservation.find(e));return r}(),new App.SwapUsersController({reservations:t})},i.prototype.validate=function(){var e,t;return t=function(){var t,n,i,r;for(i=App.LineSelectionController.selected,r=[],t=0,n=i.length;n>t;t++)e=i[t],r.push(App.Reservation.find(e));return r}(),_.all(t,function(e){return!moment(e.end_date).isBefore(moment().format("YYYY-MM-DD"))})},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.HandOverDialogController=function(n){function i(t){this.validateDelegatedUser=e(this.validateDelegatedUser,this),this.toggleAddPurpose=e(this.toggleAddPurpose,this),this.validatePurpose=e(this.validatePurpose,this),this.handOver=e(this.handOver,this),this.setupModal=e(this.setupModal,this),this.validateAssignment=e(this.validateAssignment,this),this.validateEndDate=e(this.validateEndDate,this),this.validateStartDate=e(this.validateStartDate,this),this.validateDialog=e(this.validateDialog,this),this.autoFocus=e(this.autoFocus,this);var n;return this.user=t.user,this.reservations=function(){var e,t,i,r;for(i=App.LineSelectionController.selected,r=[],e=0,t=i.length;t>e;e++)n=i[e],r.push(App.Reservation.find(n));return r}(),this.purpose=_.uniq(_.map(this.reservations,function(e){return e.purpose().description})).join(", "),this.validateDialog()?(this.setupModal(),this.user.isDelegation()&&App.User.ajaxFetch({data:$.param({delegation_id:this.user.id})}).done(function(e){return function(t){var n;return e.searchSetContactPersonController=new App.SearchSetUserController({el:e.el.find("#contact-person"),localSearch:!0,customAutocompleteOptions:{source:function(){var e,i,r;for(r=[],e=0,i=t.length;i>e;e++)n=t[e],r.push($.extend(App.User.find(n.id),{label:n.name}));return r}(),minLength:0},selectCallback:function(){return e.contract.delegated_user_id=e.searchSetContactPersonController.selectedUserId}})}}(this)),i.__super__.constructor.apply(this,arguments),this.contract.delegated_user_id=null,this.autoFocus(),void 0):!1}return t(i,n),i.prototype.events={"click [data-hand-over]":"handOver"},i.prototype.elements={"#purpose":"purposeTextArea","#note":"noteTextArea","#error":"errorContainer"},i.prototype.autoFocus=function(){var e;return(null!=(e=this.searchSetContactPersonController)?e.input.length:void 0)?this.searchSetContactPersonController.input.focus():this.purposeTextArea.length?this.purposeTextArea.focus():this.noteTextArea.focus()},i.prototype.validateDialog=function(){return this.validateStartDate()&&this.validateEndDate()&&this.validateAssignment()},i.prototype.validateStartDate=function(){return _.any(this.reservations,function(e){return moment(e.start_date).endOf("day").diff(moment().startOf("day"),"days")>0})?(App.Flash({type:"error",message:_jed("you cannot hand out reservations which are starting in the future")}),!1):!0},i.prototype.validateEndDate=function(){return _.any(this.reservations,function(e){return moment(e.end_date).endOf("day").diff(moment().startOf("day"),"days")<0})?(App.Flash({type:"error",message:_jed("you cannot hand out reservations which are ending in the past")}),!1):!0},i.prototype.validateAssignment=function(){return _.any(this.reservations,function(e){return null===e.item_id&&null===e.option_id})?(App.Flash({type:"error",message:_jed("you cannot hand out reservations with unassigned inventory codes")}),!1):!0},i.prototype.setupModal=function(){var e,t,n;return t=_.map(this.reservations,function(e){return e.start_date=moment().format("YYYY-MM-DD"),e}),this.itemsCount=_.reduce(t,function(e,t){return t.quantity+e},0),e={groupedLines:App.Modules.HasLines.groupByDateRange(t,!0),user:this.user,itemsCount:this.itemsCount,purpose:this.purpose},n=$(App.Render("manage/views/users/hand_over_dialog",e,{showAddPurpose:_.any(this.reservations,function(e){return null==e.purpose_id}),currentInventoryPool:App.InventoryPool.current})),n.find("#add-purpose").on("click",function(e){return function(e){return $(e.currentTarget).remove()&&n.find("#purpose-input").removeClass("hidden")}}(this)),this.modal=new App.Modal(n),this.el=this.modal.el},i.prototype.handOver=function(){var e;return this.purpose.length||(this.purpose=this.purposeTextArea.val()),this.validatePurpose()&&this.validateDelegatedUser()?this.contract.sign({line_ids:_.map(this.reservations,function(e){return e.id}),purpose:this.purposeTextArea.val(),note:this.noteTextArea.val(),delegated_user_id:null!=(e=this.contract.delegatedUser())?e.id:void 0}).fail(function(e){return function(t){return e.errorContainer.find("strong").html(t.responseText),e.errorContainer.removeClass("hidden")}}(this)).done(function(e){return function(t){return e.modal.undestroyable(),e.modal.el.detach(),new App.DocumentsAfterHandOverController({contract:new App.Contract(t),itemsCount:e.itemsCount})}}(this)):void 0},i.prototype.validatePurpose=function(){return App.InventoryPool.current.required_purpose&&!this.purpose.length?(this.errorContainer.find("strong").html(_jed("Specification of the purpose is required")),this.errorContainer.removeClass("hidden"),this.purposeTextArea.focus(),!1):!0},i.prototype.toggleAddPurpose=function(){},i.prototype.validateDelegatedUser=function(){return this.contract.user().isDelegation()&&!this.contract.delegatedUser()?(this.errorContainer.find("strong").html(_jed("Specification of the contact person is required")),this.errorContainer.removeClass("hidden"),this.searchSetContactPersonController.input.focus(),!1):!0},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.HandOversDeleteController=function(n){function i(){return this.onClick=e(this.onClick,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.events={"click [data-hand-over-delete]":"onClick"},i.prototype.onClick=function(e){var t,n;return n=$(e.currentTarget),t=n.closest("[data-id]").data("id"),$.ajax({url:"/manage/"+App.InventoryPool.current.id+"/visits/"+t,type:"post",
data:{_method:"delete"},success:function(e){return function(e){var t;return t=n.closest(".line-actions"),t.html(App.Render("manage/views/hand_overs/deleted"))}}(this)})},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.OptionLineChangeController=function(n){function i(){this.change=e(this.change,this),this.focus=e(this.focus,this),i.__super__.constructor.apply(this,arguments),new PreChange("[data-line-type='option_line'] [data-line-quantity]")}return t(i,n),i.prototype.events={"change [data-line-type='option_line'] [data-line-quantity]":"change","focus [data-line-type='option_line'] [data-line-quantity]":"focus"},i.prototype.focus=function(e){var t;return t=$(e.currentTarget),t.select()},i.prototype.change=function(e){var t,n,i;return i=$(e.currentTarget),n=App.Reservation.find(i.closest("[data-id]").data("id")),t=parseInt(i.val()),t>0&&t!==n.quantity?(n.updateAttributes({quantity:t}),"preChange"===e.type?$("[data-line-type='option_line'][data-id='"+n.id+"'] [data-line-quantity]:first").focus():void 0):i.val(n.quantity)},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ReservationAssignOrCreateController=function(n){function i(){this.assignedOrCreated=e(this.assignedOrCreated,this),this.submit=e(this.submit,this),this.getEndDate=e(this.getEndDate,this),this.getStartDate=e(this.getStartDate,this);var t,n,r,o;i.__super__.constructor.apply(this,arguments),o=this,r=new App.ReservationsAddController({el:this.el,user:this.user,status:this.status,contract:this.contract,optionsEnabled:!0,modelsPerPage:30,optionsPerPage:100,onSubmitInventoryCode:this.submit,addModelForHandOver:!0}),t=function(e){return o.inputValue=e,o.autocompleteController.setProps({isLoading:!0}),r.search(e,function(e){return o.autocompleteController.setProps({searchResults:e,isLoading:!1})})},n={onChange:_.debounce(t,300),onSelect:r.select,isLoading:!1,placeholder:_jed("Inventory code, model name, search term")},this.autocompleteController=new App.HandOverAutocompleteController(n,this.el.find("#assign-or-add-input")[0]),this.autocompleteController._render(),window.autocompleteController=this.autocompleteController,r.setupAutocomplete(this.autocompleteController)}return t(i,n),i.prototype.elements={"#add-start-date":"addStartDate","#add-end-date":"addEndDate"},i.prototype.getStartDate=function(){return moment(this.addStartDate.val(),i18n.date.L)},i.prototype.getEndDate=function(){return moment(this.addEndDate.val(),i18n.date.L)},i.prototype.submit=function(e){return console.log("TEST",e),(null!=e?e.length:void 0)?(App.Reservation.assignOrCreate({start_date:this.getStartDate().format("YYYY-MM-DD"),end_date:this.getEndDate().format("YYYY-MM-DD"),code:e,contract_id:this.contract.id}).done(function(t){return function(n){return console.log(n),t.assignedOrCreated(e,n)}}(this)).error(function(e){return function(e){return App.Flash({type:"error",message:e.responseText})}}(this)),this.autocompleteController.getInstance().resetInput()):!1},i.prototype.assignedOrCreated=function(e,t){var n;return console.log("assignedOrCreated",{inventoryCode:e,data:t},App.Reservation.exists(t.id)),n=function(n){return function(){var i;return App.Reservation.exists(t.id)?(i=App.Reservation.update(t.id,t),null!=i.model_id?App.Flash({type:"success",message:_jed("%s assigned to %s",[e,i.model().name()])}):null!=i.option_id&&App.Flash({type:"notice",message:_jed("%s quantity increased to %s",[i.option().name(),i.quantity])})):(i=App.Reservation.addRecord(new App.Reservation(t)),App.Contract.trigger("refresh",n.contract),App.Flash({type:"success",message:_jed("Added %s",i.model().name())})),App.LineSelectionController.add(i.id)}}(this),null!=t.model_id?App.Item.ajaxFetch({data:$.param({ids:[t.item_id]})}).done(function(e){return function(){return App.Model.ajaxFetch({data:$.param({ids:[t.model_id]})}).done(n)}}(this)):null!=t.option_id?App.Option.ajaxFetch({data:$.param({ids:[t.option_id]})}).done(n):void 0},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ReturnedQuantityController=function(n){function i(){return this.updateWith=e(this.updateWith,this),this.restore=e(this.restore,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.returnedQuantities=[],i.prototype.restore=function(){return _.each(this.returnedQuantities,function(e){return function(t){var n;return null!=(n=e.el.find(".line[data-id='"+t.id+"'] [data-quantity-returned]"))?n.val(t.quantity):void 0}}(this))},i.prototype.updateWith=function(e,t){return this.returnedQuantities=_.reject(this.returnedQuantities,function(t){return t.id===e}),this.returnedQuantities.push({id:e,quantity:t})},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.SearchSetUserController=function(n){function i(t){this.removeUser=e(this.removeUser,this),i.__super__.constructor.apply(this,arguments),this.localSearch===!0?(this.setupAutocomplete(),this.input.on("focus",function(){return $(this).autocomplete("search")}),this.input.autocomplete("search")):this.input.preChange({delay:200})}return t(i,n),i.prototype.events={"preChange #user-id":"searchUser","click #remove-user":"removeUser"},i.prototype.elements={"#user-id":"input","#selected-user":"selectedUser"},i.prototype.setupAutocomplete=function(e){var t;return t={appendTo:this.el,source:function(t){return function(t,n){var i;return i=_.map(e,function(e){return e.value=e.id,e}),n(i)}}(this),focus:function(e){return function(){return!1}}(this),select:function(e){return function(t,n){return e.selectUser(n.item),!1}}(this)},$.extend(t,this.customAutocompleteOptions),this.input.autocomplete(t).data("uiAutocomplete")._renderItem=function(e){return function(e,t){return $(App.Render("manage/views/users/autocomplete_element",t)).data("value",t).appendTo(e)}}(this)},i.prototype.searchUser=function(){var e,t;return t=this.input.val(),0===t.length?!1:(e={search_term:t},$.extend(e,this.additionalSearchParams),App.User.ajaxFetch({data:$.param(e)}).done(function(e){return function(t){var n;return e.setupAutocomplete(function(){var e,i,r;for(r=[],e=0,i=t.length;i>e;e++)n=t[e],r.push(App.User.find(n.id));return r}()),e.input.autocomplete("search")}}(this)))},i.prototype.selectUser=function(e){return this.input.hide().autocomplete("disable").attr("value",e.id),this.selectedUserId=e.id,this.selectedUser.html(App.Render("manage/views/contracts/edit/swapped_user",e)),"function"==typeof this.selectCallback?this.selectCallback():void 0},i.prototype.removeUser=function(){return this.input.show().autocomplete("enable").val("").focus(),this.selectedUserId=null,this.selectedUser.html("")},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.SwapUsersController=function(n){function i(t){this.setupContactPerson=e(this.setupContactPerson,this),this.renderContactPerson=e(this.renderContactPerson,this),this.swapReservations=e(this.swapReservations,this),this.swapContract=e(this.swapContract,this),this.delegateEvents=e(this.delegateEvents,this),this.contract=null!=t.reservations?t.reservations[0].contract():t.contract,this.modal=new App.Modal(App.Render("manage/views/contracts/edit/swap_user_modal",this.contract)),this.el=this.modal.el,i.__super__.constructor.apply(this,arguments),this.searchSetUserController=new App.SearchSetUserController({el:this.el.find("#user #swapped-person"),selectCallback:this.manageContactPerson?function(e){return function(){return e.setupContactPerson()}}(this):null}),this.manageContactPerson&&this.setupContactPerson()}return t(i,n),i.prototype.events={"submit form":"submit"},i.prototype.elements={form:"form","#errors":"errorsContainer","button[type='submit']":"submitButton"},i.prototype.delegateEvents=function(){return i.__super__.delegateEvents.apply(this,arguments)},i.prototype.submit=function(e){return e.preventDefault(),this.errorsContainer.addClass("hidden"),App.Button.disable(this.submitButton),null!=this.reservations?this.swapReservations():this.swapContract()},i.prototype.swapContract=function(){var e,t,n;return n=null!=(e=this.searchSetUserController.selectedUserId)?e:this.contract.user().id,this.contract.swapUser(n,null!=(t=this.searchSetContactPersonController)?t.selectedUserId:void 0).done(function(e){return function(e){var t;return t=new App.Contract(e),window.location=t.editPath()}}(this)).fail(function(e){return function(t){return e.errorsContainer.removeClass("hidden"),App.Button.enable(e.submitButton),e.errorsContainer.find("strong").text(t.responseText)}}(this))},i.prototype.swapReservations=function(){return App.Reservation.swapUser(this.reservations,this.searchSetUserController.selectedUserId).done(function(e){return function(){return window.location=App.User.find(e.searchSetUserController.selectedUserId).url("hand_over")}}(this)).fail(function(e){return function(){return e.errorsContainer.removeClass("hidden"),App.Button.enable(e.submitButton),e.errorsContainer.find("strong").text(_jed("Invalid data"))}}(this))},i.prototype.renderContactPerson=function(){return this.form.append(App.Render("manage/views/contracts/edit/contact_person",this.contract))},i.prototype.setupContactPerson=function(){var e,t;return this.el.find("#contact-person").remove(),this.searchSetContactPersonController=null,t=null!=(e=this.searchSetUserController.selectedUserId)?e:this.contract.user().id,App.User.find(t).isDelegation()?(this.renderContactPerson(),App.User.ajaxFetch({data:$.param({delegation_id:t})}).done(function(e){return function(t){var n;return e.searchSetContactPersonController=new App.SearchSetUserController({el:e.el.find("#contact-person #swapped-person"),localSearch:!0,customAutocompleteOptions:{source:function(){var e,i,r;for(r=[],e=0,i=t.length;i>e;e++)n=t[e],r.push($.extend(App.User.find(n.id),{label:n.name}));return r}(),minLength:0}})}}(this))):void 0},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.TakeBackController=function(n){function i(){this.inspectItem=e(this.inspectItem,this),this.changeQuantity=e(this.changeQuantity,this),this.showAutocomplete=e(this.showAutocomplete,this),this.select=e(this.select,this),this.setupAutocomplete=e(this.setupAutocomplete,this),this.increaseOption=e(this.increaseOption,this),this.getQuantity=e(this.getQuantity,this),this.getCheckLineFunction=e(this.getCheckLineFunction,this),this.assign=e(this.assign,this),this.takeBack=e(this.takeBack,this),this.render=e(this.render,this),this.getLines=e(this.getLines,this),this.fetchAvailability=e(this.fetchAvailability,this),this.delegateEvents=e(this.delegateEvents,this),i.__super__.constructor.apply(this,arguments),App.TakeBackController.readyForTakeBack=[],this.lineSelection=new App.LineSelectionController({el:this.el,markVisitLinesController:new App.MarkVisitLinesController({el:this.el})}),this.returnedQuantitiesController=new App.ReturnedQuantityController({el:this.el}),this.getLines().length&&this.fetchAvailability(),this.setupAutocomplete(),new App.TimeLineController({el:this.el}),new App.ReservationsEditController({el:this.el,user:this.user,contract:this.contract,startDateDisabled:!0,quantityDisabled:!0}),new PreChange("[data-quantity-returned]"),new App.ModelCellTooltipController({el:this.el})}return t(i,n),i.prototype.elements={"#status":"status","#lines":"reservationsContainer","form#assign":"form","#assign-input":"input"},i.prototype.events={"click [data-take-back-selection]":"takeBack","click [data-inspect-item]":"inspectItem","submit form#assign":"assign","focus #assign-input":"showAutocomplete","change [data-quantity-returned]":"changeQuantity","preChange [data-quantity-returned]":"changeQuantity"},i.prototype.delegateEvents=function(){return i.__super__.delegateEvents.apply(this,arguments),App.Reservation.on("refresh",this.fetchAvailability),App.Item.on("refresh",function(e){return function(){return e.render(!0)}}(this))},i.prototype.fetchAvailability=function(){var e,t;return this.render(!1),t=_.uniq(_.map(_.filter(this.getLines(),function(e){return null!=e.model_id}),function(e){return e.model().id})),e=function(e){return function(t){return e.initalAvailabilityFetched=!0,e.status.html(App.Render("manage/views/availabilities/loaded")),e.render(!0)}}(this),t.length?(this.status.html(App.Render("manage/views/availabilities/loading")),App.Availability.ajaxFetch({data:$.param({model_ids:t,user_id:this.user.id})}).done(e)):e()},i.prototype.getLines=function(){return _.flatten(_.map(this.user.contracts().all(),function(e){return e.reservations().all()}))},i.prototype.render=function(e){return this.reservationsContainer.html(App.Render("manage/views/reservations/grouped_lines_with_action_date",App.Modules.HasLines.groupByDateRange(this.getLines(),!1,"end_date"),{linePartial:"manage/views/reservations/take_back_line",renderAvailability:e})),this.returnedQuantitiesController.restore(),this.lineSelection.restore()},i.prototype.takeBack=function(){var e,t,n,i,r,o,s;for(s={},o=function(){var e,n,i,r;for(i=App.LineSelectionController.selected,r=[],e=0,n=i.length;n>e;e++)t=i[e],r.push(App.Reservation.find(t));return r}(),e=0,n=o.length;n>e;e++)if(i=o[e],null!=i.option_id){if(r=this.getQuantity(i),0===r)return App.Flash({type:"error",message:_jed("You have to provide the quantity for the things you want to return")}),!1;s[i.id]=this.getQuantity(i)}return new App.TakeBackDialogController({user:this.user,reservations:o,returnedQuantity:s})},i.prototype.assign=function(e){var t,n,i;return null!=e&&e.preventDefault(),t=this.input.val(),n=_.find(this.getLines(),this.getCheckLineFunction(t)),n?(App.Flash({type:"success",message:_jed("%s selected for take back",n.model().name())}),App.LineSelectionController.add(n.id),n.option_id&&this.increaseOption(n)):App.Reservation.findByAttribute("option_id",null!=(i=App.Option.findByAttribute("inventory_code",t))?i.id:void 0)?App.Flash({type:"error",message:_jed("You can not take back more options then you handed over")}):App.Flash({type:"error",message:_jed("%s was not found for this take back",t)}),this.input.val("").blur()},i.prototype.getCheckLineFunction=function(e){var t;return t=this.el,function(n){return n.inventoryCode()===e&&(n.option()?t.find(".line[data-id='"+n.id+"'] input[data-quantity-returned]").val()<n.quantity:!0)}},i.prototype.getQuantity=function(e){var t,n;return t=this.el.find(".line[data-id='"+e.id+"'] input[data-quantity-returned]"),n=t.val().length?parseInt(t.val()):0,_.isNaN(n)&&(n=1),n},i.prototype.increaseOption=function(e){var t,n;return n=this.getQuantity(e)+1,t=this.el.find(".line[data-id='"+e.id+"'] input[data-quantity-returned]"),t.val(n),App.Flash({type:"success",message:_jed("%s quantity increased to %s",[e.model().name(),n])}),this.changeQuantity({currentTarget:t})},i.prototype.setupAutocomplete=function(){return this.input.autocomplete({appendTo:this.el,source:function(e){return function(t,n){var i,r,o;return i=function(){var e,t,n,i;for(n=this.getLines(),i=[],e=0,t=n.length;t>e;e++)r=n[e],i.push({name:r.model().name(),inventoryCode:r.inventoryCode(),record:r});return i}.call(e),o=RegExp(t.term,"i"),i=_.filter(i,function(e){var t;return e.name.match(o)||(null!=(t=e.inventoryCode)?t.match(o):void 0)}),n(i)}}(this),focus:function(e){return function(){return!1}}(this),select:this.select}).data("uiAutocomplete")._renderItem=function(e){return function(e,t){return $(App.Render("manage/views/reservations/assign/autocomplete_element",t)).data("value",t).appendTo(e)}}(this)},i.prototype.select=function(e,t){return this.input.val(t.item.record.inventoryCode()),this.assign()},i.prototype.showAutocomplete=function(){return this.input.autocomplete("search")},i.prototype.changeQuantity=function(e){var t,n,i,r,o;return o=$(e.currentTarget),t=App.Reservation.find(o.closest("[data-id]").data("id")),App.LineSelectionController.add(t.id),null!=(i=this.lineSelection.markVisitLinesController)&&i.update(App.LineSelectionController.selected),n=parseInt(o.val()),_.isNaN(n)&&o.val(0),0>n&&o.val(0),t.quantity<n?(App.Flash({type:"error",message:_jed("You can not take back more items then you handed over")}),o.val(t.quantity),null!=(r=this.lineSelection.markVisitLinesController)?r.update(App.LineSelectionController.selected):void 0):this.returnedQuantitiesController.updateWith(t.id,n)},i.prototype.inspectItem=function(e){var t;return t=App.Item.find($(e.currentTarget).data("item-id")),new App.ItemInspectDialogController({item:t})},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.TakeBackDialogController=function(n){function i(){this.showDocuments=e(this.showDocuments,this),this.takeBack=e(this.takeBack,this),this.getItemsCount=e(this.getItemsCount,this),this.setupModal=e(this.setupModal,this),i.__super__.constructor.apply(this,arguments),this.setupModal(),this.el.on("click","[data-take-back]",this.takeBack)}return t(i,n),i.prototype.setupModal=function(){var e,t,n;return n=_.map(this.reservations,function(e){return e.end_date=moment().format("YYYY-MM-DD"),e}),e={groupedLines:App.Modules.HasLines.groupByDateRange(n,!0),user:this.user,itemsCount:this.getItemsCount()},t={returnedQuantity:this.returnedQuantity},this.modal=new App.Modal(App.Render("manage/views/users/take_back_dialog",e,t)),this.el=this.modal.el},i.prototype.getItemsCount=function(){return _.reduce(this.reservations,function(e){return function(t,n){return(e.returnedQuantity[n.id]||n.quantity)+t}}(this),0)},i.prototype.takeBack=function(){return this.modal.undestroyable(),this.modal.el.detach(),App.Reservation.takeBack(this.reservations,this.returnedQuantity).done(function(e){return function(t){return e.showDocuments(e.reservations)}}(this))},i.prototype.showDocuments=function(e){var t,n,i;return t=_.uniq(_.map(e,function(e){return e.contract()}),function(e){return e.id}),i=App.Render("manage/views/users/take_back_documents_dialog",{user:this.user,contracts:t,itemsCount:this.getItemsCount()}),n=new App.Modal(i),n.undestroyable()},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.TakeBacksSendReminderController=function(n){function i(){return this.send=e(this.send,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.events={"click [data-send-takeback-reminder]":"send"},i.prototype.send=function(e){var t,n,i;return i=$(e.currentTarget),n=App.Visit.findOrBuild(i.closest("[data-id]").data()),n.remind(),t=i.closest(".line"),t.length&&t.find(".latest-reminder-cell").html(App.Render("manage/views/take_backs/reminder_send")),i.closest(".dropdown").hide()},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.VisitsIndexController=function(n){function i(){this.render=e(this.render,this),this.fetchPurposes=e(this.fetchPurposes,this),this.fetchUsers=e(this.fetchUsers,this),this.fetchReservations=e(this.fetchReservations,this),this.fetchVisits=e(this.fetchVisits,this),this.fetch=e(this.fetch,this),this.reset=e(this.reset,this),i.__super__.constructor.apply(this,arguments),new App.LinesCellTooltipController({el:this.el}),new App.UserCellTooltipController({el:this.el}),new App.LatestReminderTooltipController({el:this.el}),new App.HandOversDeleteController({el:this.el}),new App.TakeBacksSendReminderController({el:this.el}),this.pagination=new App.ListPaginationController({el:this.list,fetch:this.fetch}),this.search=new App.ListSearchController({el:this.el.find("#list-search"),reset:this.reset}),this.range=new App.ListRangeController({el:this.el.find("#list-range"),reset:this.reset}),this.tabs=new App.ListTabsController({el:this.el.find("#list-tabs"),reset:this.reset,data:{status:["approved","signed"]}}),this.reset()}return t(i,n),i.prototype.elements={"#visits":"list"},i.prototype.reset=function(){return this.visits={},this.list.html(App.Render("manage/views/lists/loading")),this.fetch(1,this.list)},i.prototype.fetch=function(e,t){return this.fetchVisits(e).done(function(n){return function(){return n.fetchReservations(e,function(){return n.fetchUsers(e).done(function(){return n.fetchPurposes(e,function(){return n.render(t,n.visits[e],e)})})})}}(this))},i.prototype.fetchVisits=function(e){return App.Visit.ajaxFetch({data:$.param($.extend(this.tabs.getData(),{search_term:this.search.term(),page:e,range:this.range.get()}))}).done(function(t){return function(n,i,r){var o,s;return t.pagination.set(JSON.parse(r.getResponseHeader("X-Pagination"))),s=function(){var e,t,i;for(i=[],e=0,t=n.length;t>e;e++)o=n[e],i.push(App.Visit.find(o.id));return i}(),t.visits[e]=s}}(this))},i.prototype.fetchReservations=function(e,t){var n,i;return i=_.flatten(_.map(this.visits[e],function(e){return e.reservation_ids})),i.length||t(),n=_.after(Math.ceil(i.length/50),t),_(i).each_slice(50,function(e){return function(e){return App.Reservation.ajaxFetch({data:$.param({ids:e})}).done(n)}}(this))},i.prototype.fetchUsers=function(e){var t;return t=_.filter(_.map(this.visits[e],function(e){return e.user_id}),function(e){return null==App.User.exists(e)}),t.length?App.User.ajaxFetch({data:$.param({ids:t})}).done(function(e){return function(e){var t,n;return n=function(){var n,i,r;for(r=[],n=0,i=e.length;i>n;n++)t=e[n],r.push(App.User.find(t.id));return r}(),App.User.fetchDelegators(n)}}(this)):{done:function(e){return function(e){return e()}}(this)}},i.prototype.fetchPurposes=function(e,t){var n,i;return i=_.compact(_.filter(_.map(_.flatten(_.map(this.visits[e],function(e){return e.reservations().all()})),function(e){return e.purpose_id}),function(e){return null==App.Purpose.exists(e)})),i.length||t(),n=_.after(Math.ceil(i.length/50),t),_(i).each_slice(50,function(e){return function(e){return App.Purpose.ajaxFetch({data:$.param({purpose_ids:e})}).done(n)}}(this))},i.prototype.render=function(e,t,n){return e.html(App.Render("manage/views/visits/line",t)),1===n?this.pagination.renderPlaceholders():void 0},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.SearchOverviewController=function(n){function i(){this.searchOptions=e(this.searchOptions,this),this.fetchPurposes=e(this.fetchPurposes,this),this.searchOrders=e(this.searchOrders,this),this.fetchReservations=e(this.fetchReservations,this),this.fetchUsers=e(this.fetchUsers,this),this.searchContracts=e(this.searchContracts,this),this.searchUsers=e(this.searchUsers,this),this.searchDelegations=e(this.searchDelegations,this),this.fetchModels=e(this.fetchModels,this),this.searchLicenses=e(this.searchLicenses,this),this.searchItems=e(this.searchItems,this),this.fetchAvailability=e(this.fetchAvailability,this),this.render=e(this.render,this),this.searchSoftware=e(this.searchSoftware,this),this.searchModels=e(this.searchModels,this),i.__super__.constructor.apply(this,arguments),this.previewAmount=5,this.searchModels(),this.searchSoftware(),this.searchItems(),this.searchLicenses(),this.searchOptions(),this.searchUsers(),this.searchDelegations(),this.searchContracts(),this.searchOrders(),new App.LatestReminderTooltipController({el:this.el}),new App.LinesCellTooltipController({el:this.el}),new App.UserCellTooltipController({el:this.el}),new App.HandOversDeleteController({el:this.el}),new App.ContractsApproveController({el:this.el}),new App.TakeBacksSendReminderController({el:this.el}),new App.ContractsRejectController({el:this.el,async:!0,callback:this.orderRejected}),new App.TimeLineController({el:this.el})}return t(i,n),i.prototype.elements={"#models":"models","#software":"software","#items":"items","#licenses":"licenses","#users":"users","#delegations":"delegations","#contracts":"contracts","#orders":"orders","#options":"options","#loading":"loading"},i.prototype.removeLoading=_.after(5,function(){return this.loading.remove()}),i.prototype.searchModels=function(){return App.Model.ajaxFetch({data:$.param({type:"model",per_page:this.previewAmount,search_term:this.searchTerm})}).done(function(e){return function(t,n,i){var r,o;return o=function(){var e,n,i;for(i=[],e=0,n=t.length;n>e;e++)r=t[e],i.push(App.Model.find(r.id));return i}(),e.fetchAvailability(o).done(function(){return e.render(e.models,"manage/views/models/line",o,i)})}}(this))},i.prototype.searchSoftware=function(){return App.Software.ajaxFetch({data:$.param({type:"software",per_page:this.previewAmount,search_term:this.searchTerm})}).done(function(e){return function(t,n,i){var r,o;return o=function(){var e,n,i;for(i=[],e=0,n=t.length;n>e;e++)r=t[e],i.push(App.Software.find(r.id));return i}(),e.fetchAvailability(o).done(function(){return e.render(e.software,"manage/views/software/line",o,i)})}}(this))},i.prototype.render=function(e,t,n,i){var r;return r=JSON.parse(i.getResponseHeader("X-Pagination")).total_count,this.removeLoading(),n.length&&(e.find(".list-of-lines").html(App.Render(t,n,{currentInventoryPool:App.InventoryPool.current,accessRight:App.AccessRight,currentUserRole:App.User.current.role})),e.removeClass("hidden")),r>this.previewAmount?e.find("[data-type='show-all']").removeClass("hidden").append($("<span class='badge margin-left-s'>"+r+"</span>")):void 0},i.prototype.fetchAvailability=function(e){var t;return t=_.map(e,function(e){return e.id}),t.length?App.Availability.ajaxFetch({url:App.Availability.url()+"/in_stock",data:$.param({model_ids:t})}):{done:function(e){return e()}}},i.prototype.searchItems=function(){return App.Item.ajaxFetch({data:$.param({type:"item",per_page:this.previewAmount,search_term:this.searchTerm,current_inventory_pool:!1})}).done(function(e){return function(t,n,i){var r,o;return o=function(){var e,n,i;for(i=[],e=0,n=t.length;n>e;e++)r=t[e],i.push(App.Item.find(r.id));return i}(),e.fetchModels(o).done(function(){return e.render(e.items,"manage/views/items/line",o,i)})}}(this))},i.prototype.searchLicenses=function(){return App.License.ajaxFetch({data:$.param({type:"license",per_page:this.previewAmount,search_term:this.searchTerm,current_inventory_pool:!1})}).done(function(e){return function(t,n,i){var r,o;return o=function(){var e,n,i;for(i=[],e=0,n=t.length;n>e;e++)r=t[e],i.push(App.License.find(r.id));return i}(),e.fetchModels(o).done(function(){return e.render(e.licenses,"manage/views/licenses/line",o,i)})}}(this))},i.prototype.fetchModels=function(e){var t;return t=_.uniq(_.map(e,function(e){return e.model_id})),t.length?App.Model.ajaxFetch({data:$.param({ids:t,paginate:!1,include_package_models:!0})}):{done:function(e){return e()}}},i.prototype.searchDelegations=function(){return App.User.ajaxFetch({data:$.param({per_page:this.previewAmount,search_term:this.searchTerm,type:"delegation"})}).done(function(e){return function(t,n,i){var r,o;return o=function(){var e,n,i;for(i=[],e=0,n=t.length;n>e;e++)r=t[e],i.push(App.User.find(r.id));return i}(),App.User.fetchDelegators(o,function(){return e.render(e.delegations,"manage/views/users/search_result_line",o,i)})}}(this))},i.prototype.searchUsers=function(){return App.User.ajaxFetch({data:$.param({per_page:this.previewAmount,search_term:this.searchTerm,type:"user"})}).done(function(e){return function(t,n,i){var r,o;return o=function(){var e,n,i;for(i=[],e=0,n=t.length;n>e;e++)r=t[e],i.push(App.User.find(r.id));return i}(),e.render(e.users,"manage/views/users/search_result_line",o,i)}}(this))},i.prototype.searchContracts=function(){return App.Contract.ajaxFetch({data:$.param({per_page:this.previewAmount,global_contracts_search:!0,search_term:this.searchTerm,status:["signed","closed"]})}).done(function(e){return function(t,n,i){var r,o;return r=function(){var e,n,i;for(i=[],e=0,n=t.length;n>e;e++)o=t[e],i.push(App.Contract.find(o.id));return i}(),e.fetchUsers(r,"all").done(function(){return e.fetchReservations(r).done(function(){return e.render(e.contracts,"manage/views/contracts/line",r,i)})})}}(this))},i.prototype.fetchUsers=function(e,t){var n,i;return null==t&&(t=!1),i=_.uniq(_.map(e,function(e){return e.user_id})),i.length?(n={ids:i,paginate:!1},"all"===t&&$.extend(n,{all:!0}),App.User.ajaxFetch({data:$.param(n)}).done(function(e){return function(e){var t,n;return n=function(){var n,i,r;for(r=[],n=0,i=e.length;i>n;n++)t=e[n],r.push(App.User.find(t.id));return r}(),App.User.fetchDelegators(n)}}(this))):{done:function(e){return e()}}},i.prototype.fetchReservations=function(e){var t;return t=_.flatten(_.map(e,function(e){return e.id})),t.length?App.Reservation.ajaxFetch({data:$.param({contract_ids:t,paginate:!1})}):{done:function(e){return e()}}},i.prototype.searchOrders=function(){return App.Contract.ajaxFetch({data:$.param({per_page:this.previewAmount,search_term:this.searchTerm,status:["approved","submitted","rejected"]})}).done(function(e){return function(t,n,i){var r,o;return r=function(){var e,n,i;for(i=[],e=0,n=t.length;n>e;e++)o=t[e],i.push(App.Contract.find(o.id));return i}(),e.fetchUsers(r).done(function(){return e.fetchReservations(r).done(function(){return e.fetchPurposes(r).done(function(){return e.render(e.orders,"manage/views/contracts/line",r,i)})})})}}(this))},i.prototype.fetchPurposes=function(e){var t;return t=_.compact(_.filter(_.map(_.flatten(_.map(e,function(e){return e.reservations().all()})),function(e){return e.purpose_id}),function(e){return null==App.Purpose.exists(e)})),t.length?App.Purpose.ajaxFetch({data:$.param({purpose_ids:t,paginate:!1})}):{done:function(e){return function(e){return e()}}(this)}},i.prototype.searchOptions=function(){return App.Option.ajaxFetch({data:$.param({per_page:this.previewAmount,search_term:this.searchTerm})}).done(function(e){return function(t,n,i){var r,o;return o=function(){var e,n,i;for(i=[],e=0,n=t.length;n>e;e++)r=t[e],i.push(App.Option.find(r.id));return i}(),e.render(e.options,"manage/views/options/line",o,i)}}(this))},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.SearchResultsController=function(n){function i(){this.render=e(this.render,this),this._fetch=e(this._fetch,this),this.reset=e(this.reset,this),i.__super__.constructor.apply(this,arguments),this.additionalData={accessRight:App.AccessRight,currentUserRole:App.User.current.role,currentInventoryPool:App.InventoryPool.current},this.pagination=new App.ListPaginationController({el:this.list,fetch:this._fetch}),this.reset()}return t(i,n),i.prototype.elements={".list-of-lines":"list"},i.prototype.reset=function(){return this.records={},this.list.html(App.Render("manage/views/lists/loading")),this._fetch(1,this.list)},i.prototype._fetch=function(e,t){var n;return n=_.after(2,function(n){
return function(){return n.render(t,n.records[e],e,n.additionalData)}}(this)),this.fetch(e,t,n).done(function(t){return function(i,r,o){var s,a;return t.pagination.set(JSON.parse(o.getResponseHeader("X-Pagination"))),a=function(){var e,t,n;for(n=[],e=0,t=i.length;t>e;e++)s=i[e],n.push(App[this.model].find(s.id));return n}.call(t),t.records[e]=a,n()}}(this))},i.prototype.render=function(e,t,n,i){return 1!==n||null!=t&&0!==t.length?(e.html(App.Render(this.templatePath,t,i)),1===n?this.pagination.renderPlaceholders():void 0):e.html(App.Render("manage/views/lists/no_results"))},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.SearchResultsContractsController=function(n){function i(){this.fetchReservations=e(this.fetchReservations,this),this.fetchUsers=e(this.fetchUsers,this),this.fetchContracts=e(this.fetchContracts,this),this.fetch=e(this.fetch,this),i.__super__.constructor.apply(this,arguments),new App.LinesCellTooltipController({el:this.el}),new App.UserCellTooltipController({el:this.el}),new App.TakeBacksSendReminderController({el:this.el})}return t(i,n),i.prototype.model="Contract",i.prototype.templatePath="manage/views/contracts/line",i.prototype.fetch=function(e,t,n){return this.fetchContracts(e).done(function(e){return function(t){var i,r;return i=function(){var e,n,i;for(i=[],e=0,n=t.length;n>e;e++)r=t[e],i.push(App.Contract.find(r.id));return i}(),e.fetchUsers(i).done(function(){return e.fetchReservations(i).done(function(){return n()})})}}(this))},i.prototype.fetchContracts=function(e){return App.Contract.ajaxFetch({data:$.param({search_term:this.searchTerm,global_contracts_search:!0,page:e,status:["signed","closed"]})})},i.prototype.fetchUsers=function(e){var t;return t=_.uniq(_.map(e,function(e){return e.user_id})),t.length?App.User.ajaxFetch({data:$.param({ids:t,all:!0,paginate:!1})}).done(function(e){return function(e){var t,n;return n=function(){var n,i,r;for(r=[],n=0,i=e.length;i>n;n++)t=e[n],r.push(App.User.find(t.id));return r}(),App.User.fetchDelegators(n)}}(this)):{done:function(e){return e()}}},i.prototype.fetchReservations=function(e){var t;return t=_.flatten(_.map(e,function(e){return e.id})),t.length?App.Reservation.ajaxFetch({data:$.param({contract_ids:t})}):{done:function(e){return e()}}},i}(App.SearchResultsController)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.SearchResultsItemsController=function(n){function i(){return this.fetchModels=e(this.fetchModels,this),this.fetchItems=e(this.fetchItems,this),this.fetch=e(this.fetch,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.model="Item",i.prototype.dependingOnModel="Model",i.prototype.templatePath="manage/views/items/line",i.prototype.type="item",i.prototype.fetch=function(e,t,n){return this.fetchItems(e).done(function(e){return function(t){var i,r;return r=function(){var e,n,r;for(r=[],e=0,n=t.length;n>e;e++)i=t[e],r.push(App[this.model].find(i.id));return r}.call(e),e.fetchModels(r).done(function(){return n()})}}(this))},i.prototype.fetchItems=function(e){return App[this.model].ajaxFetch({data:$.param({search_term:this.searchTerm,type:this.type,page:e,current_inventory_pool:!1})})},i.prototype.fetchModels=function(e){var t;return t=_.uniq(_.map(e,function(e){return e.model_id})),t.length?App[this.dependingOnModel].ajaxFetch({data:$.param({ids:t,paginate:!1,include_package_models:!0})}):{done:function(e){return e()}}},i}(App.SearchResultsController)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;window.App.SearchResultsLicensesController=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.model="License",n.prototype.templatePath="manage/views/licenses/line",n.prototype.type="license",n}(App.SearchResultsItemsController)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.SearchResultsModelsController=function(n){function i(){this.fetchAvailability=e(this.fetchAvailability,this),this.fetchModels=e(this.fetchModels,this),this.fetch=e(this.fetch,this),i.__super__.constructor.apply(this,arguments),new App.TimeLineController({el:this.el})}return t(i,n),i.prototype.model="Model",i.prototype.templatePath="manage/views/models/line",i.prototype.type="model",i.prototype.fetch=function(e,t,n){return this.fetchModels(e).done(function(e){return function(t){var i,r;return r=function(){var e,n,r;for(r=[],e=0,n=t.length;n>e;e++)i=t[e],r.push(App[this.model].find(i.id));return r}.call(e),e.fetchAvailability(r).done(function(){return n()})}}(this))},i.prototype.fetchModels=function(e){return App[this.model].ajaxFetch({data:$.param({search_term:this.searchTerm,type:this.type,page:e})})},i.prototype.fetchAvailability=function(e){var t;return t=_.map(e,function(e){return e.id}),t.length?App.Availability.ajaxFetch({url:App.Availability.url()+"/in_stock",data:$.param({model_ids:t})}):{done:function(e){return e()}}},i}(App.SearchResultsController)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.SearchResultsOptionsController=function(n){function i(){this.fetchOptions=e(this.fetchOptions,this),this.fetch=e(this.fetch,this),i.__super__.constructor.apply(this,arguments),new App.TimeLineController({el:this.el})}return t(i,n),i.prototype.model="Option",i.prototype.templatePath="manage/views/options/line",i.prototype.fetch=function(e,t,n){return this.fetchOptions(e).done(function(e){return function(e){var t,i;return i=function(){var n,i,r;for(r=[],n=0,i=e.length;i>n;n++)t=e[n],r.push(App.Option.find(t.id));return r}(),n()}}(this))},i.prototype.fetchOptions=function(e){return App.Option.ajaxFetch({data:$.param({search_term:this.searchTerm,page:e})})},i}(App.SearchResultsController)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.SearchResultsOrdersController=function(n){function i(){this.fetchPurposes=e(this.fetchPurposes,this),this.fetchReservations=e(this.fetchReservations,this),this.fetchUsers=e(this.fetchUsers,this),this.fetchOrders=e(this.fetchOrders,this),this.fetch=e(this.fetch,this),i.__super__.constructor.apply(this,arguments),new App.LinesCellTooltipController({el:this.el}),new App.UserCellTooltipController({el:this.el}),new App.ContractsApproveController({el:this.el}),new App.ContractsRejectController({el:this.el,async:!0,callback:this.orderRejected})}return t(i,n),i.prototype.model="Contract",i.prototype.templatePath="manage/views/contracts/line",i.prototype.fetch=function(e,t,n){return this.fetchOrders(e).done(function(e){return function(t){var i,r;return r=function(){var e,n,r;for(r=[],e=0,n=t.length;n>e;e++)i=t[e],r.push(App.Contract.find(i.id));return r}(),e.fetchUsers(r).done(function(){return e.fetchReservations(r).done(function(){return e.fetchPurposes(r).done(function(){return n()})})})}}(this))},i.prototype.fetchOrders=function(e){return App.Contract.ajaxFetch({data:$.param({page:e,search_term:this.searchTerm,status:["approved","submitted","rejected"]})})},i.prototype.fetchUsers=function(e){var t;return t=_.uniq(_.map(e,function(e){return e.user_id})),t.length?App.User.ajaxFetch({data:$.param({ids:t,paginate:!1})}).done(function(e){return function(e){var t,n;return n=function(){var n,i,r;for(r=[],n=0,i=e.length;i>n;n++)t=e[n],r.push(App.User.find(t.id));return r}(),App.User.fetchDelegators(n)}}(this)):{done:function(e){return e()}}},i.prototype.fetchReservations=function(e){var t;return t=_.flatten(_.map(e,function(e){return e.id})),t.length?App.Reservation.ajaxFetch({data:$.param({contract_ids:t})}):{done:function(e){return e()}}},i.prototype.fetchPurposes=function(e){var t;return t=_.compact(_.filter(_.map(_.flatten(_.map(e,function(e){return e.reservations().all()})),function(e){return e.purpose_id}),function(e){return null==App.Purpose.exists(e)})),t.length?App.Purpose.ajaxFetch({data:$.param({purpose_ids:t,paginate:!1})}):{done:function(e){return function(e){return e()}}(this)}},i}(App.SearchResultsController)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;window.App.SearchResultsSoftwareController=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.model="Software",n.prototype.templatePath="manage/views/software/line",n.prototype.type="software",n}(App.SearchResultsModelsController)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.SearchResultsUsersController=function(n){function i(){return this.fetchUsers=e(this.fetchUsers,this),this.fetch=e(this.fetch,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.model="User",i.prototype.templatePath="manage/views/users/search_result_line",i.prototype.fetch=function(e,t,n){return this.fetchUsers(e).done(function(e){return function(){return n()}}(this))},i.prototype.fetchUsers=function(e){return App.User.ajaxFetch({data:$.param({search_term:this.searchTerm,page:e})}).done(function(e){return function(e){var t,n;return n=function(){var n,i,r;for(r=[],n=0,i=e.length;i>n;n++)t=e[n],r.push(App.User.find(t.id));return r}(),App.User.fetchDelegators(n)}}(this))},i}(App.SearchResultsController)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;window.App.GroupController=function(t){function n(){n.__super__.constructor.apply(this,arguments),new App.GroupPartitionsController({el:this.el.find("#models-allocations"),removeHandler:this.removePartitionHandler}),new App.ManageUsersViaAutocompleteController({el:this.el.find("#users"),removeHandler:this.removeUserHandler,paramName:"group[users][][id]"})}return e(n,t),n.removeHandler=function(e){return e.preventDefault(),$(e.currentTarget).closest(".line").remove()},n.prototype.removeUserHandler=n.removeHandler,n.prototype.removePartitionHandler=n.removeHandler,n}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.GroupEditController=function(n){function i(){return this.removePartitionHandler=e(this.removePartitionHandler,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.include(App.Modules.InlineEntryHandlers),i.prototype.removeUserHandler=i.prototype.strikeRemoveUserHandler,i.prototype.removePartitionHandler=function(e){var t,n,i;return e.preventDefault(),i=$(e.currentTarget),t=i.closest(".line"),n=t.find("[data-model-name]"),n.hasClass("striked")?(n.removeClass("striked"),t.find("[data-quantities]").removeClass("hidden"),i.text(_jed("Remove")),t.find("[name*='_destroy']").val(null)):(n.addClass("striked"),t.find("[data-quantities]").addClass("hidden"),i.text(_jed("undo")),t.find("[name*='_destroy']").val(1))},i}(App.GroupController)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.GroupPartitionsController=function(n){function i(){this.select=e(this.select,this),this.setupAutocomplete=e(this.setupAutocomplete,this),this.fetchModels=e(this.fetchModels,this),this.search=e(this.search,this),i.__super__.constructor.apply(this,arguments),this.input.preChange()}return t(i,n),i.prototype.elements={"input[data-search-models]":"input","[data-models-list]":"modelsList"},i.prototype.events={"preChange input[data-search-models]":"search","click [data-remove-group]":"removeHandler"},i.prototype.search=function(){return this.input.val().length?this.fetchModels().done(function(e){return function(t){var n;return e.setupAutocomplete(function(){var e,i,r;for(r=[],e=0,i=t.length;i>e;e++)n=t[e],r.push(App.Model.find(n.id));return r}())}}(this)):!1},i.prototype.fetchModels=function(){return App.Model.ajaxFetch({data:$.param({search_term:this.input.val(),borrowable:!0,per_page:5})})},i.prototype.setupAutocomplete=function(e){return this.input.autocomplete({source:function(t){return function(t,n){return n(e)}}(this),focus:function(e){return function(){return!1}}(this),select:this.select}).data("uiAutocomplete")._renderItem=function(e){return function(e,t){return $(App.Render("manage/views/groups/partitions/autocomplete_element",t)).data("value",t).appendTo(e)}}(this),this.input.autocomplete("search")},i.prototype.select=function(e,t){return App.Availability.ajaxFetch({url:App.Availability.url()+"/in_stock",data:$.param({model_ids:t.item.id})}).done(function(e){return function(n){var i;return i=e.modelsList.find("input[name='group[partitions_attributes][][model_id]'][value='"+t.item.id+"']").closest(".line"),i.length?e.modelsList.prepend(i):e.modelsList.prepend(App.Render("manage/views/groups/partitions/model_allocation_entry",App.Model.find(t.item.id),{currentInventoryPool:App.InventoryPool.current}))}}(this))},i}(Spine.Controller)}.call(this),function(){window.App.HandOverAutocompleteController=function(){function e(e,t,n){this.props=e,this.container=t,this.opts=n}return e.prototype._render=function(){return this.instance=ReactDOM.render(React.createElement(HandoverAutocomplete,this.props),this.container),window.reactBarcodeScannerTarget=this.instance},e.prototype.setProps=function(e){return _.extend(this.props,e),this._render()},e.prototype.getInstance=function(){return this.instance},e}()}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.InventoryExpandController=function(n){function i(){return this.renderChildren=e(this.renderChildren,this),this.updateChildren=e(this.updateChildren,this),this.setupChildren=e(this.setupChildren,this),this.fetchPackageModels=e(this.fetchPackageModels,this),this.fetchPackageItems=e(this.fetchPackageItems,this),this.fetchData=e(this.fetchData,this),this.open=e(this.open,this),this.close=e(this.close,this),this.toggle=e(this.toggle,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.events={"click [data-type='inventory-expander']":"toggle"},i.prototype.toggle=function(e){var t;return t=$(e.currentTarget),null!=t.data("_expanded")&&t.data("_expanded")===!0?this.close(t):this.open(t)},i.prototype.close=function(e){var t;return e.data("_expanded",!1),e.find(".arrow").removeClass("down right").addClass("right"),t=e.closest("[data-id]"),t.data("_children").detach()},i.prototype.open=function(e){var t;return e.data("_expanded",!0),e.find(".arrow").removeClass("down right").addClass("down"),t=e.closest("[data-id]"),_.contains(["model","software"],t.data("type"))&&null==t.data("_children")&&this.fetchData(t,this.updateChildren),this.setupChildren(t)},i.prototype.fetchData=function(e,t){var n,i,r,o;return"model"===e.data("type")&&(i=App.Model.find(e.data("id"))),"software"===e.data("type")&&(o=App.Software.find(e.data("id"))),n=_.map((null!=(r=null!=i?i.items():void 0)?r:null!=o?o.licenses():void 0).all(),function(e){return e.id}),this.fetchPackageItems(e,n).done(function(i){return function(r){return i.fetchPackageModels(e,n).done(function(){return t(e)})}}(this))},i.prototype.fetchPackageItems=function(e,t){return e.data("is_package")===!0?App.Item.ajaxFetch({data:$.param({package_ids:t,paginate:!1})}):{done:function(e){return e()}}},i.prototype.fetchPackageModels=function(e,t){var n,i,r,o;return e.data("is_package")===!0?(r=function(){var e,n,r;for(r=[],e=0,n=t.length;n>e;e++)i=t[e],r.push(App.Item.find(i));return r}(),n=_.flatten(_.map(r,function(e){return e.children().all()})),o=_.uniq(_.map(n,function(e){return e.model_id})),App.Model.ajaxFetch({data:$.param({ids:o,paginate:!1,include_package_models:!0})})):{done:function(e){return e()}}},i.prototype.setupChildren=function(e){return null==e.data("_children")&&this.renderChildren(e),e.after(e.data("_children"))},i.prototype.updateChildren=function(e){var t;return t=e.data("_children"),this.renderChildren(e,"additionalDataFetched"),null!=t?t.replaceWith(e.data("_children")):void 0},i.prototype.renderChildren=function(e,t){var n,i,r;return null==t&&(t=!1),r=App[_.string.classify(e.data("type"))].find(e.data("id")),i=function(){switch(e.data("type")){case"model":return r.items().all();case"software":return r.licenses().all();case"item":return r.children().all()}}(),n=$("<div class='group-of-lines'></div>"),n.html($(App.Render("manage/views/inventory/line",i,{additionalDataFetched:t,accessRight:App.AccessRight,currentUserRole:App.User.current.role}))),e.data("_children",n)},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;App.InventoryHelperController=function(n){function i(){this.showOwnerChangeNotification=e(this.showOwnerChangeNotification,this),this.disableFlexibleFields=e(this.disableFlexibleFields,this),this.setupSavedItem=e(this.setupSavedItem,this),this.saveItem=e(this.saveItem,this),this.cancelEdit=e(this.cancelEdit,this),this.editItem=e(this.editItem,this),this.updateItem=e(this.updateItem,this),this.fetchItemWithFlexibleFields=e(this.fetchItemWithFlexibleFields,this),this.fetchItem=e(this.fetchItem,this),this.setupItemEdit=e(this.setupItemEdit,this),this.highlightChangedFields=e(this.highlightChangedFields,this),this.setupAppliedItem=e(this.setupAppliedItem,this),this.prepareRequestData=e(this.prepareRequestData,this),this.applyFields=e(this.applyFields,this),this.addField=e(this.addField,this),this.fetchItems=e(this.fetchItems,this),this.setupItemAutocomplete=e(this.setupItemAutocomplete,this),this.toggleChildren=e(this.toggleChildren,this),this.removeField=e(this.removeField,this),this.selectField=e(this.selectField,this),this.getFields=e(this.getFields,this),this.fetchFields=e(this.fetchFields,this),this.delegateEvents=e(this.delegateEvents,this),i.__super__.constructor.apply(this,arguments),this.fetchFields().done(function(e){return function(){return e.fieldInput.is(":focus")?e.setupFieldAutocomplete():void 0}}(this)),this.setupItemAutocomplete()}return t(i,n),i.prototype.elements={"#field-selection":"fieldSelection","#field-input":"fieldInput","#item-selection":"itemSelection","#flexible-fields":"flexibleFields","#item-section":"itemSection","#item-input":"itemInput","#item-edit":"editButton","#save-edit":"saveButton","#cancel-edit":"cancelButton","#notifications":"notifications","#no-fields-message":"noFieldsMessage","#field-form-left-side":"formLeftSide","#field-form-right-side":"formRightSide"},i.prototype.events={"focus #field-input":"setupFieldAutocomplete","click [data-type='remove-field']":"removeField","change #field-selection [data-type='field']":"toggleChildren","submit #item-selection":"applyFields","click #item-edit":"editItem","click #cancel-edit":"cancelEdit","click #save-edit":"saveItem","change #field-selection input[name='item[owner][id]']":"showOwnerChangeNotification"},i.prototype.delegateEvents=function(){return i.__super__.delegateEvents.apply(this,arguments),this.el.on("submit","form",function(e){return function(e){return e.preventDefault()}}(this))},i.prototype.fetchFields=function(){return App.Field.ajaxFetch({data:$.param({target_type:"item"})})},i.prototype.setupFieldAutocomplete=function(){return this.fieldInput.autocomplete({source:this.getFields,focus:function(e){return function(){return!1}}(this),select:this.selectField,minLength:0}).data("uiAutocomplete")._renderItem=function(e){return function(e,t){return $(App.Render("views/autocomplete/element",t)).data("value",t).appendTo(e)}}(this),this.fieldInput.autocomplete("search")},i.prototype.getFields=function(e,t){var n;return n=_.filter(App.Field.all(),function(t){return function(n){return null!=n.getLabel().match(new RegExp(e.term,"i"))&&!App.Field.isPresent(n,t.fieldSelection)&&null==n.visibility_dependency_field_id&&null==n.values_dependency_field_id&&"attachments"!==n.id}}(this)),t(_.map(_.sortBy(n,function(e){return e.getLabel()}),function(e){return{label:e.getLabel(),value:e.value,field:e}}))},i.prototype.selectField=function(e,t){var n,i,r,o;for(this.addField(t.item.field),this.fieldInput.val("").autocomplete("destroy").blur(),n=_.filter(App.Field.all(),function(e){return e.values_dependency_field_id===t.item.field.id}),r=0,o=n.length;o>r;r++)i=n[r],new App.ValuesDependencyFieldController({el:this.el,renderData:{writeable:!0,removeable:!0,fieldColor:"white"},parentField:t.item.field,childField:i});return!1},i.prototype.removeField=function(e){var t,n,i,r,o,s,a,l,d,p;for(p=$(e.currentTarget).closest("[data-type='field']"),n=App.Field.find(p.data("id")),l=n.children(),i=0,o=l.length;o>i;i++)t=l[i],this.fieldSelection.find("[name='"+t.getFormName()+"']").closest("#"+t.id).remove();for(d=n.childrenWithValueDependency(),r=0,s=d.length;s>r;r++)t=d[r],this.fieldSelection.find("[name='"+t.getFormName()+"']").closest("#"+t.id).remove();return(a=n.parentWithValueDependency())&&this.fieldSelection.find("[name='"+a.getFormName()+"']").closest("#"+a.id).remove(),p.closest("#"+n.id).remove(),this.fieldSelection.find("[data-type='field']").length?void 0:this.noFieldsMessage.removeClass("hidden")},i.prototype.toggleChildren=function(e){var t,n;return t=null!=(n=e.field)?n:$(e.currentTarget).closest("[data-type='field']"),App.Field.toggleChildren(t,this.fieldSelection,{writeable:!0,removeable:!0,fieldColor:"white"})},i.prototype.setupItemAutocomplete=function(){return this.itemInput.autocomplete({source:function(e){return function(t,n){return e.fetchItems(t.term).done(function(e){var t,i;return i=function(){var n,i,r;for(r=[],n=0,i=e.length;i>n;n++)t=e[n],r.push(App.Item.find(t.id));return r}(),n(i)})}}(this),focus:function(e){return function(){return!1}}(this),select:function(e){return function(t,n){return e.itemInput.val(n.item.inventory_code),e.applyFields()}}(this),minLength:0}).data("uiAutocomplete")._renderItem=function(e){return function(e,t){return $(App.Render("manage/views/inventory/helper/item_autocomplete_element",t)).data("value",t).appendTo(e)}}(this)},i.prototype.fetchItems=function(e){return App.Item.ajaxFetch({data:$.param({search_term:e,paginate:!1})})},i.prototype.addField=function(e){var t,n;return App.Field.isPresent(e,this.fieldSelection)?!0:(this.fieldSelection.find("[data-type='field']").length||this.noFieldsMessage.addClass("hidden"),t=this.formLeftSide.find("[data-type='field']").length<=this.formRightSide.find("[data-type='field']").length?this.formLeftSide:this.formRightSide,n=$(App.Render("manage/views/items/field",{},{field:e,writeable:!0,removeable:!0,fieldColor:"white"})),t.append(n),this.toggleChildren({field:t.find("[data-type='field']")}))},i.prototype.applyFields=function(){var e,t;return this.resetNotifications(),t=this.itemInput.val(),this.itemInput.val("").blur(),App.Flash.reset(),t.length?App.Field.validate(this.fieldSelection)?(e=this.prepareRequestData(),this.fetchItem(t,function(t){return function(n){return t.updateItem(n,e).fail(function(e,i){return t.fetchItemWithFlexibleFields(n).done(function(e){return t.currentItemData=e,t.setupAppliedItem("error")})}).done(function(e){return t.currentItemData=e,t.setupAppliedItem("success")})}}(this))):App.Flash({type:"error",message:_jed("Please provide all required fields")}):App.Flash({type:"error",message:_jed("Please provide an inventory code")})},i.prototype.prepareRequestData=function(){var e,t,n,i,r;for(r=this.fieldSelection.serializeArray(),i=_.filter(App.Field.all(),function(e){return e.exclude_from_submit}),t=0,n=i.length;n>t;t++)e=i[t],r=_.reject(r,function(t){return t.name===e.getFormName()});return r.concat([{name:"item[skip_serial_number_validation]",value:!0}])},i.prototype.setupAppliedItem=function(e){var t;return t=function(t){return function(){return(t.currentItemData.owner_id===App.InventoryPool.current.id||t.currentItemData.inventory_pool_id===App.InventoryPool.current.id)&&(t.editButton.removeClass("hidden"),t.saveButton.addClass("hidden"),t.cancelButton.addClass("hidden")),t.highlightChangedFields(t.fieldSelection.find(".field"),e),$(document).scrollTop(t.itemSection.offset().top)}}(this),this.setupItemEdit(!1,t)},i.prototype.highlightChangedFields=function(e,t){var n,i,r,o;for(o=[],i=0,r=e.length;r>i;i++)n=e[i],o.push(this.flexibleFields.find(".field[data-id='"+$(n).data("id")+"']").addClass(t));return o},i.prototype.setupItemEdit=function(e,t){var n;return null!=this.flexibleFieldsController&&(n=this.flexibleFields.clone(!1),this.flexibleFields.replaceWith(n),this.flexibleFieldsController.release(),this.flexibleFields=n),this.flexibleFieldsController=new App.ItemFlexibleFieldsController({el:this.flexibleFields,itemData:this.currentItemData,writeable:e,hideable:!0,excludeIds:["attachments"],callback:t,showInitialFlashNotice:!0})},i.prototype.fetchItem=function(e,t){return App.Item.ajaxFetch({data:$.param({inventory_code:e})}).done(function(n){return function(n){return n.length?t(App.Item.find(n[0].id)):App.Flash({type:"error",message:_jed("The Inventory Code %s was not found.",e)})}}(this))},i.prototype.fetchItemWithFlexibleFields=function(e){return App.Item.ajax().find(e.id,{data:$.param({"for":"flexibleFields"})})},i.prototype.updateItem=function(e,t){var n;return t.length?e.updateWithFieldData(t).fail(function(e){return function(t){return e.setNotification(t.responseText,"error")}}(this)):n={always:function(e){return e()},fail:function(e){return e()},done:function(e){return e()}}},i.prototype.setNotification=function(e,t){return this.notifications.html(App.Render("manage/views/inventory/helper/"+t,{text:e}))},i.prototype.resetNotifications=function(){return this.notifications.html(""),App.Flash.reset()},i.prototype.editItem=function(){return this.editButton.addClass("hidden"),this.saveButton.removeClass("hidden"),this.cancelButton.removeClass("hidden"),this.setupItemEdit(!0),this.resetNotifications(),this.currentItemData.owner_id!==App.InventoryPool.current.id?this.setNotification(_jed("You are not the owner of this item")+" "+_jed("therefore you may not be able to change some of these fields"),"error"):void 0},i.prototype.cancelEdit=function(){return this.editButton.removeClass("hidden"),this.saveButton.addClass("hidden"),this.cancelButton.addClass("hidden"),this.setupItemEdit(!1),this.resetNotifications(),this.resetNotifications()},i.prototype.saveItem=function(){var e;return this.flexibleFieldsController.validate()?(e=App.Item.find(this.currentItemData.id),this.updateItem(e,this.prepareRequestData()).done(function(t){return function(){return t.fetchItemWithFlexibleFields(e).done(function(e){return t.currentItemData=e,t.setupSavedItem()})}}(this)),this.disableFlexibleFields()):void 0},i.prototype.setupSavedItem=function(){return this.setupItemEdit(!1),this.editButton.removeClass("hidden"),this.saveButton.addClass("hidden"),this.cancelButton.addClass("hidden"),this.resetNotifications(),this.setNotification(_jed("%s successfully saved",_jed("Item")),"success")},i.prototype.disableFlexibleFields=function(){return this.flexibleFields.find("input,textarea,select").prop("disabled",!0)},i.prototype.showOwnerChangeNotification=function(){return App.Flash({type:"notice",message:_jed("If you transfer an item to a different inventory pool it's not visible for you anymore.")})},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.InventoryIndexController=function(n){function i(){this.toggleFiltersVisibility=e(this.toggleFiltersVisibility,this),this.closeCategories=e(this.closeCategories,this),this.openCategories=e(this.openCategories,this),this.toggleCategories=e(this.toggleCategories,this),this.render=e(this.render,this),this.getData=e(this.getData,this),this.fetchLicenses=e(this.fetchLicenses,this),this.fetchItems=e(this.fetchItems,this),this.fetchAvailability=e(this.fetchAvailability,this),this.fetchInventory=e(this.fetchInventory,this),this.fetch=e(this.fetch,this),this.updateExportButtons=e(this.updateExportButtons,this),this.reset=e(this.reset,this),i.__super__.constructor.apply(this,arguments),this.pagination=new App.ListPaginationController({el:this.list,fetch:this.fetch}),this.search=new App.ListSearchController({el:this.el.find("#list-search"),reset:this.reset}),this.tabs=new App.ListTabsController({el:this.el.find("#list-tabs"),reset:this.reset}),this.filter=new App.ListFiltersController({el:this.filterElement,reset:this.reset}),this.range=new App.ListRangeController({el:this.filterElement,reset:this.reset}),new App.TimeLineController({el:this.el}),new App.InventoryExpandController({el:this.el}),[this.csvExportButton,this.excelExportButton].map(function(e){return e.data("href",e.attr("href"))}),this.reset()}return t(i,n),i.prototype.elements={"#inventory":"list","#csv-export":"csvExportButton","#excel-export":"excelExportButton","#categories":"categoriesContainer","[data-filter]":"filterElement"},i.prototype.events={"click #categories-toggle":"toggleCategories"},i.prototype.reset=function(){return this.toggleFiltersVisibility(),this.inventory={},_.invoke([App.Item,App.License,App.Model,App.Software,App.Option],function(){return this.deleteAll()}),this.updateExportButtons(),this.list.html(App.Render("manage/views/lists/loading")),this.fetch(1,this.list)},i.prototype.updateExportButtons=function(){var e,t;return e=this.getData(),e.software&&(e.type="license"),(null!=(t=this.search.term())?t.length:void 0)&&(e.search_term=this.search.term()),[this.csvExportButton,this.excelExportButton].map(function(t){return t.attr("href",URI(t.data("href")).query(e).toString())})},i.prototype.fetch=function(e,t){return this.fetchInventory(e).done(function(n){return function(){return n.fetchAvailability(e).done(function(){return n.fetchItems(e).done(function(){return n.fetchLicenses(e).done(function(){return n.render(t,n.inventory[e],e)})})})}}(this))},i.prototype.fetchInventory=function(e){var t,n;return App.Inventory.fetch($.extend(this.getData(),{page:e,search_term:this.search.term(),category_id:null!=(t=this.categoriesFilter)&&null!=(n=t.getCurrent())?n.id:void 0,include_package_models:!0,sort:"name",order:"ASC"})).done(function(t){return function(n,i,r){var o,s,a,l;for(t.pagination.set(JSON.parse(r.getResponseHeader("X-Pagination"))),s=[],a=0,l=n.length;l>a;a++)o=n[a],s.push(new App.Inventory.findOrCreate(o));return t.inventory[e]=s}}(this))},i.prototype.fetchAvailability=function(e){var t,n;return n=_.filter(this.inventory[e],function(e){return _.contains(["Model","Software"],e.constructor.className)}),t=_.map(n,function(e){return e.id}),t.length?App.Availability.ajaxFetch({
url:App.Availability.url()+"/in_stock",data:$.param({model_ids:t})}):{done:function(e){return e()}}},i.prototype.fetchItems=function(e){var t,n;return n=_.filter(this.inventory[e],function(e){return"Model"===e.constructor.className}),t=_.map(n,function(e){return e.id}),t.length?App.Item.ajaxFetch({data:$.param($.extend(this.getData(),{model_ids:t,paginate:!1,search_term:this.search.term(),all:!0}))}):{done:function(e){return e()}}},i.prototype.fetchLicenses=function(e){var t,n;return n=_.filter(this.inventory[e],function(e){return"Software"===e.constructor.className}),t=_.map(n,function(e){return e.id}),t.length?App.License.ajaxFetch({data:$.param($.extend(this.getData(),{model_ids:t,paginate:!1,search_term:this.search.term(),all:!0}))}):{done:function(e){return e()}}},i.prototype.getData=function(){return _.clone($.extend(this.tabs.getData(),this.filter.getData()))},i.prototype.render=function(e,t,n){if(null!=t){if(!t.length)return e.html(App.Render("manage/views/lists/no_results"));if(e.html(App.Render("manage/views/inventory/line",t,{accessRight:App.AccessRight,currentUserRole:App.User.current.role})),1===n)return this.pagination.renderPlaceholders()}},i.prototype.toggleCategories=function(){return null==this.categoriesFilter&&(this.categoriesFilter=new App.CategoriesFilterController({el:this.categoriesContainer,filter:this.reset})),this.categoriesContainer.hasClass("hidden")?this.openCategories():this.closeCategories()},i.prototype.openCategories=function(){return this.list.addClass("col4of5"),this.categoriesContainer.addClass("col1of5").removeClass("hidden")},i.prototype.closeCategories=function(){return this.list.removeClass("col4of5"),this.categoriesContainer.removeClass("col1of5").addClass("hidden")},i.prototype.toggleFiltersVisibility=function(){var e;return"option"===this.tabs.getData().type?this.filterElement.addClass("hidden"):(this.filterElement.removeClass("hidden"),"false"===this.filterElement.find("select[name='used']").val()?this.filterElement.find("select[name!='used'], label.button:has(input[type='checkbox'])").hide():(this.filterElement.find("select[name!='used'], label.button:has(input[type='checkbox'])").show(),e=this.filterElement.find("select[name!='used'], input[type='checkbox']").serializeArray(),_.any(e,function(e){return""!==e.value})?this.filterElement.find("select[name='used']").hide():this.filterElement.find("select[name='used']").show()))},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.InventoryPoolDailyController=function(n){function i(){this.updateNavigationLinks=e(this.updateNavigationLinks,this),this.toggleDatepicker=e(this.toggleDatepicker,this),this.renderWorkload=e(this.renderWorkload,this),this.fetchWorkload=e(this.fetchWorkload,this),this.fetchData=e(this.fetchData,this),i.__super__.constructor.apply(this,arguments),this.visits=[],this.datepickerOpen=!1,this.fetchData()}return t(i,n),i.prototype.events={"click #datepicker":"toggleDatepicker"},i.prototype.elements={"#datepicker-input":"datepickerInput","#daily-navigation":"dailyNavigation","#workload":"workloadContainer"},i.prototype.fetchData=function(){return this.fetchWorkload()},i.prototype.fetchWorkload=function(){return null!=this.workload?!0:App.Workload.ajaxFetch({data:$.param({date:this.date})}).done(function(e){return function(t){return e.workload=new App.Workload(t),e.renderWorkload()}}(this))},i.prototype.renderWorkload=function(){return this.workloadContainer.html(App.Render("manage/views/inventory_pools/daily/workload")),this.workloadContainer.find(".bar-chart").jqBarGraph({data:this.workload.data,colors:["#999999","#cccccc"],gridColors:["#bbbbbb","#dddddd"],width:960,height:300,barSpace:105,animate:!1,interGrids:0})},i.prototype.toggleDatepicker=function(){return null==this.datepicker&&(this.datepicker=this.datepickerInput.datepicker({defaultDate:moment(this.date).toDate(),onSelect:function(e){return function(e,t){var n;return n=URI(window.location.href).removeQuery("date").addQuery("date",moment(e,i18n.date.L).format("YYYY-MM-DD")),window.location=n}}(this)})),this.datepickerOpen=!this.datepickerOpen,this.datepickerOpen?this.datepickerInput.focus():this.datepickerInput.datepicker("hide")},i.prototype.updateNavigationLinks=function(e,t){var n,i,r,o,s,a;for(o=this.dailyNavigation.find("a[href]"),s=[],i=0,r=o.length;r>i;i++)n=o[i],n=$(n),a=URI(n.attr("href")).removeQuery("tab").addQuery("tab",t),s.push(n.attr("href",a));return s},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.InventoryPoolHolidaysController=function(n){function i(){this.removeHoliday=e(this.removeHoliday,this),this.addHoliday=e(this.addHoliday,this),this.setupHolidaysDatepickers=e(this.setupHolidaysDatepickers,this),i.__super__.constructor.apply(this,arguments),this.setupHolidaysDatepickers()}return t(i,n),i.prototype.events={"click [data-add-holiday]":"addHoliday","click [data-remove-holiday]":"removeHoliday"},i.prototype.elements={"[data-holidays-list]":"holidaysList"},i.prototype.setupHolidaysDatepickers=function(){return this.el.find("#holiday-start-date, #holiday-end-date").datepicker()},i.prototype.addHoliday=function(e){var t,n,i,r;return e.preventDefault(),r=moment(this.el.find("#holiday-start-date").val(),i18n.date.L).format("DD.MM.YYYY"),t=moment(this.el.find("#holiday-end-date").val(),i18n.date.L).format("DD.MM.YYYY"),i=this.el.find("#holiday-name").val(),n=_.last(_.sortBy(_.map(this.holidaysList.find(".line"),function(e){return $(e).data("index")}),function(e){return Number(e)})),$("[data-holidays-list]").append(App.Render("manage/views/inventory_pools/admin/holiday_entry",{start_date:r,end_date:t,name:i,i:null!=n?n+1:0}))},i.prototype.removeHoliday=function(e){var t,n;return e.preventDefault(),n=$(e.currentTarget).closest(".line"),t=n.data("index"),n.find("input[name='inventory_pool[holidays_attributes]["+t+"][_destroy]']").length?(n.find(".line-col").removeClass("striked"),n.find("input[name='inventory_pool[holidays_attributes]["+t+"][_destroy]']").remove()):(n.find(".line-col").addClass("striked"),n.prepend("<input type='hidden' name='inventory_pool[holidays_attributes]["+t+"][_destroy]' value='1' />"))},i}(Spine.Controller)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;window.App.CompositeFieldController=function(t){function n(){n.__super__.constructor.apply(this,arguments),"Quantity allocations"===this.data.field.label&&new App.LicenseQuantityPartitionsController({el:this.el,data:this.data})}return e(n,t),n}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.UploadController=function(n){function i(){this.remove=e(this.remove,this),this.showUploading=e(this.showUploading,this),this.upload=e(this.upload,this),this.setupPreviewImage=e(this.setupPreviewImage,this),this.renderFile=e(this.renderFile,this),this.processNewFile=e(this.processNewFile,this),this.add=e(this.add,this),this.click=e(this.click,this),i.__super__.constructor.apply(this,arguments),this.uploadList=[],this.uploadErrors=[],this.el.fileupload({autoUpload:!1})}return t(i,n),i.prototype.elements={".list-of-lines":"list"},i.prototype.events={"click [data-type='select']":"click",fileuploadadd:"add","click [data-type='inline-entry'][data-new] [data-remove]":"remove"},i.prototype.click=function(){return this.el.find("input[type='file']").trigger("click")},i.prototype.add=function(e,t){var n,i,r,o,s;for(this.uploadList.push(t),o=t.files,s=[],i=0,r=o.length;r>i;i++)n=o[i],s.push(this.processNewFile(this.renderFile(n,t),n));return s},i.prototype.processNewFile=function(e,t){},i.prototype.renderFile=function(e,t){var n;return n=$(App.Render(this.templatePath,e)),n.data("uploadData",t),this.list.prepend(n),n},i.prototype.setupPreviewImage=function(e,t){var n;return n=new FileReader,n.onload=function(t){return function(t){return e.find("img").attr("src",t.target.result)}}(this),n.readAsDataURL(t)},i.prototype.upload=function(e){var t,n,i,r,o,s,a;if(!this.uploadList.length)return void e();for(this.showUploading(),this.el.data("blueimpFileupload").options.url=this.url,t=_.after(this.uploadList.length,function(t){return function(){return e()}}(this)),n=function(e){return function(t){return e.uploadErrors.push(t.responseText)}}(this),o=this.uploadList,s=[],i=0,r=o.length;r>i;i++)a=o[i],s.push(a.submit().fail(n).always(t));return s},i.prototype.showUploading=function(){return null!=this.modal?!0:(this.modal=new App.Modal($("<div></div>")),this.modal.undestroyable(),App.Flash({type:"notice",message:_jed("Uploading files - please wait"),loading:!0},9999))},i.prototype.remove=function(e){var t;return t=$(e.currentTarget).closest("[data-type='inline-entry']"),this.uploadList=_.filter(this.uploadList,function(e){return e!==t.data("uploadData")})},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ItemAttachmentsController=function(n){function i(){this.setUrl=e(this.setUrl,this),i.__super__.constructor.apply(this,arguments),this.type="attachment",this.templatePath="manage/views/items/fields/writeable/partials/attachment_inline_entry",new App.InlineEntryRemoveController({el:this.el})}return t(i,n),i.prototype.setUrl=function(e){return this.url=e.url("upload/"+this.type)},i}(App.UploadController)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ItemEditController=function(n){function i(){this.removeField=e(this.removeField,this),this.saveAndCopy=e(this.saveAndCopy,this),this.submitCopy=e(this.submitCopy,this),this.submit=e(this.submit,this),this.errorHandler=e(this.errorHandler,this),this.finish=e(this.finish,this),this.done=e(this.done,this),this.prepareRequestData=e(this.prepareRequestData,this),this.save=e(this.save,this),i.__super__.constructor.apply(this,arguments),this.flexibleFieldsController=new App.ItemFlexibleFieldsController({el:this.flexibleFields,itemData:this.itemData,itemType:this.itemType,writeable:!0,hideable:!0,callback:function(e){return function(){return e.attachmentsController=new App.ItemAttachmentsController({el:e.el.find("#attachments")})}}(this)})}return t(i,n),i.prototype.elements={"#flexible-fields":"flexibleFields","#form":"itemForm","input[name='copy']":"copyInput"},i.prototype.events={"click #item-save-and-copy":"submitCopy","click #show-all-fields":"showAllFields","click [data-type='remove-field']":"removeField"},i.prototype.save=function(e){var t,n;return n=null!=(t=(null!=e?e:{}).skipSerialNumberValidation)?t:!1,this.flexibleFieldsController.validate()?$.ajax({url:this.url,data:this.prepareRequestData(n),type:this.method}):(this.hideLoading(),!1)},i.prototype.prepareRequestData=function(e){var t,n,i,r,o;for(null==e&&(e=!1),o=this.itemForm.serializeArray(),r=_.filter(App.Field.all(),function(e){return e.exclude_from_submit}),n=0,i=r.length;i>n;n++)t=r[n],o=_.reject(o,function(e){return e.name===t.getFormName()});return o.concat([{name:"item[skip_serial_number_validation]",value:e}])},i.prototype.done=function(e){return null==this.item&&(this.item=new App.Item({id:e.id})),this.attachmentsController.setUrl(this.item),this.attachmentsController.upload(function(t){return function(){return t.finish(e.redirect_url)}}(this))},i.prototype.finish=function(e){var t;return null==e&&(e=null),this.attachmentsController.uploadErrors.length?this.setupErrorModal(this.item):(t=null!=e?e:App.Inventory.url(),window.location=t+"?flash[success]="+_jed("Item saved"))},i.prototype.errorHandler=function(e){var t;return e.responseJSON.can_bypass_unique_serial_number_validation?(t=confirm(e.responseJSON.message+" "+_jed("Save anyway")+"?"),t?this.submit(e,function(e){return function(){return e.save({skipSerialNumberValidation:!0})}}(this)):this.hideLoading()):(this.showError(e.responseJSON.message),this.hideLoading())},i.prototype.submit=function(e,t,n){return null==t&&(t=this.save),null==n&&(n=this.errorHandler),i.__super__.submit.call(this,e,t,n)},i.prototype.submitCopy=function(e){return this.submit(e,this.saveAndCopy)},i.prototype.saveAndCopy=function(){return this.flexibleFieldsController.validate()?(this.copyInput.prop("disabled",!1),$.ajax({url:this.url,data:this.prepareRequestData(),type:this.method})):this.hideLoading()},i.prototype.showAllFields=function(){return $.ajax({url:"/manage/"+App.InventoryPool.current.id+"/fields",type:"post",data:{_method:"delete"},success:function(e){return function(e){return $(".hidden.field").removeClass("hidden"),$("#show-all-fields").hide()}}(this)})},i.prototype.removeField=function(e){var t;return t=$(e.currentTarget).closest("[data-type='field']"),$.ajax({url:"/manage/"+App.InventoryPool.current.id+"/fields/"+t.data("id"),type:"post",success:function(e){return function(e){var n,i,r,o,s;for(i=App.Field.find(t.data("id")),s=i.children(),r=0,o=s.length;o>r;r++)n=s[r],t.closest("form").find("[name='"+n.getFormName()+"']").closest("[data-type='field']").addClass("hidden");return t.addClass("hidden"),$("#show-all-fields").show()}}(this)})},i}(App.FormWithUploadController)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ItemFlexibleFieldsController=function(n){function i(){this.toggleChildren=e(this.toggleChildren,this),this.validate=e(this.validate,this),this.showOwnerChangeNotification=e(this.showOwnerChangeNotification,this),this.setupFieldsWithValuesDependency=e(this.setupFieldsWithValuesDependency,this),this.setupFields=e(this.setupFields,this),this.renderForm=e(this.renderForm,this),this.fetchFields=e(this.fetchFields,this),this.getFieldsWithValuesDependency=e(this.getFieldsWithValuesDependency,this),this.setupInitialFlashNotice=e(this.setupInitialFlashNotice,this),i.__super__.constructor.apply(this,arguments),this.fetchFields().done(function(e){return function(){var t,n,i,r;for(e.renderForm(),e.setupFields(),r=e.el.find("[data-type='field']"),n=0,i=r.length;i>n;n++)t=r[n],e.toggleChildren({currentTarget:t});return $(".hidden.field").length&&$("#show-all-fields").show(),e.getFieldsWithValuesDependency().length>0?e.setupFieldsWithValuesDependency(e.callback):"function"==typeof e.callback?e.callback():void 0}}(this)),this.setupInitialFlashNotice()}return t(i,n),i.prototype.events={"change input[name='item[owner][id]']":"showOwnerChangeNotification",submit:"validate","change [data-type='field']":"toggleChildren"},i.prototype.setupInitialFlashNotice=function(){return this.showInitialFlashNotice&&!this.itemData["unique_serial_number?"]?App.Flash({type:"notice",message:_jed("Same or similar serial number already exists.")}):void 0},i.prototype.getFieldsWithValuesDependency=function(){return _.filter(App.Field.all(),function(e){return e.values_dependency_field_id})},i.prototype.fetchFields=function(){return App.Field.all().length?{done:function(e){return e()}}:App.Field.ajaxFetch({data:$.param({target_type:this.itemType})})},i.prototype.renderForm=function(){return this.el.html(App.Render("manage/views/items/form")),this.formLeftSide=this.el.find("#item-form-left-side"),this.formRightSide=this.el.find("#item-form-right-side")},i.prototype.setupFields=function(){var e,t,n,i,r,o,s,a,l,d;t=_.filter(App.Field.all(),function(e){return function(t){return!_.contains(e.excludeIds,t.id)}}(this)),t=_.filter(t,function(e){return null==e.visibility_dependency_field_id}),this.forPackage&&(t=_.filter(t,function(e){return e.forPackage})),s=App.Field.grouped(t),a=[];for(i in s){for(t=s[i],d=$(App.Render("manage/views/items/group_of_fields",{name:i})),n=d.find(".group-of-fields"),r=0,o=t.length;o>r;r++)e=t[r],n.append(App.Render("manage/views/items/field",{},{field:e,itemData:this.itemData,writeable:this.writeable,hideable:this.hideable}));l=this.formLeftSide.find("[data-type='field']").length<=this.formRightSide.find("[data-type='field']").length?this.formLeftSide:this.formRightSide,a.push(l.append(d))}return a},i.prototype.setupFieldsWithValuesDependency=function(e){var t,n,i,r,o;for(r=this.getFieldsWithValuesDependency(),o=[],n=0,i=r.length;i>n;n++)t=r[n],o.push(new App.ValuesDependencyFieldController({el:this.el,renderData:{itemData:this.itemData,writeable:this.writeable,hideable:this.hideable},parentField:App.Field.find(t.values_dependency_field_id),childField:t,callback:e}));return o},i.prototype.showOwnerChangeNotification=function(){return App.Flash({type:"notice",message:_jed("If you transfer an item to a different inventory pool it's not visible for you anymore.")})},i.prototype.validate=function(e){return App.Field.validate(this.el)?!0:(App.Flash({type:"error",message:_jed("Please provide all required fields")}),null!=e&&e.preventDefault(),!1)},i.prototype.toggleChildren=function(e){return App.Field.toggleChildren($(e.currentTarget),this.el,{itemData:this.itemData,writeable:this.writeable},this.forPackage)},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ItemInspectDialogController=function(n){function i(t){this.submit=e(this.submit,this),this.setupModal=e(this.setupModal,this),this.setupModal(t.item),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.events={"submit form":"submit"},i.prototype.elements={form:"form"},i.prototype.setupModal=function(e){return this.el=$(App.Render("manage/views/items/inspect_dialog",e)),this.modal=new App.Modal(this.el)},i.prototype.submit=function(e){var t,n,i,r,o;for(e.preventDefault(),t={},o=this.form.serializeArray(),i=0,r=o.length;r>i;i++)n=o[i],t[n.name]="true"===n.value||"false"===n.value?JSON.parse(n.value):n.value;return this.item.inspect(t).done(function(e){return function(){return e.modal.destroy(!0)}}(this))},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.LicenseQuantityPartitionsController=function(n){function i(){this.updateRemainingQuantity=e(this.updateRemainingQuantity,this),this.getRemainingQuantity=e(this.getRemainingQuantity,this),this.render=e(this.render,this),this.add=e(this.add,this),this.registerEventHandlers=e(this.registerEventHandlers,this),i.__super__.constructor.apply(this,arguments),this.el.append("<div class='row list-of-lines even'></div>"),this.list=this.el.find(".list-of-lines"),this.dataSourceElement=$(".field[data-id='"+this.data.field.data_dependency_field_id+"'] [data-type='value'] input").preChange(),this.dataSourceElement.on("preChange",this.updateRemainingQuantity),this.allocations=this.data.itemData.properties.quantity_allocations,this.render(this.allocations),this.allocationElements=this.el.find("[data-quantity-allocation]").preChange(),this.updateRemainingQuantity(),new App.InlineEntryRemoveController({el:this.list,removeCallback:function(e){return function(t){return e.allocationElements=_.reject(_.map(e.allocationElements,$),function(e){return e.get(0)===t.find("[data-quantity-allocation]").get(0)}),e.updateRemainingQuantity()}}(this),strikeCallback:function(e){return this.removeCallback(e)},unstrikeCallback:function(e){return function(t){return e.allocationElements.push(t.find("[data-quantity-allocation]")),e.updateRemainingQuantity()}}(this)})}return t(i,n),i.prototype.events={"click #add-inline-entry":"add","preChange [data-quantity-allocation]":"updateRemainingQuantity"},i.prototype.elements={"#remaining-total-quantity":"remainingQuantityElement"},i.prototype.registerEventHandlers=function(){},i.prototype.add=function(e){var t;return e.preventDefault(),t=$(App.Render("manage/views/items/fields/writeable/composite_partials/license_quantity_allocation",{field:this.data.field})),this.list.prepend(t),t.data("new",!0),this.allocationElements.push(t.find("[data-quantity-allocation]").preChange())},i.prototype.render=function(e){var t,n,i,r;if(e){for(r=[],n=0,i=e.length;i>n;n++)t=e[n],r.push(this.list.append(App.Render("manage/views/items/fields/writeable/composite_partials/license_quantity_allocation",{field:this.data.field,allocation:t})));return r}},i.prototype.getRemainingQuantity=function(){var e;return e=parseInt(this.dataSourceElement.val()),(_.isNaN(e)?0:e)-_.reduce(_.map(this.allocationElements,function(e){var t;return t=parseInt($(e).val()),_.isNaN(t)?0:t}),function(e,t){return e+t},0)},i.prototype.updateRemainingQuantity=function(){return this.remainingQuantityElement.text(_jed("remaining")+" "+this.getRemainingQuantity())},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ValuesDependencyFieldController=function(n){function i(){this.transformResponseData=e(this.transformResponseData,this),this.updateChildValues=e(this.updateChildValues,this),this.renderChildElement=e(this.renderChildElement,this),this.removeChildElement=e(this.removeChildElement,this),this.rerenderChildElement=e(this.rerenderChildElement,this),i.__super__.constructor.apply(this,arguments),this.parentElement=this.el.find("#"+this.parentField.id),this.renderData.itemData||(this.renderData.itemData={}),this.rerenderChildElement(),this.parentElement.change(function(e){return function(){return e.renderData.itemData[e.childField.id]=null,e.rerenderChildElement()}}(this))}return t(i,n),i.prototype.rerenderChildElement=function(){return this.removeChildElement(),this.renderChildElement()},i.prototype.removeChildElement=function(){return this.el.find("#"+this.childField.id).remove()},i.prototype.renderChildElement=function(){return this.updateChildValues({callback:function(e){return function(){return e.parentElement.after(App.Render("manage/views/items/field",{},$.extend(e.renderData,{field:e.childField})))}}(this)})},i.prototype.updateChildValues=function(e){var t,n,i;return t=e.callback,n=App.Field.getValue(this.parentElement.find(".field[data-id]")),n?(i=this.childField.values_url.replace("$$$parent_value$$$",n),$.ajax({url:i,success:function(e){return function(n){return e.childField.values=e.transformResponseData(n),t(),"function"==typeof e.callback?e.callback():void 0}}(this)})):void 0},i.prototype.transformResponseData=function(e){return _.map(e,function(e){return function(t){return{value:t.id,label:t[e.childField.values_label_method]}}}(this))},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ModelCellTooltipController=function(n){function i(){return this.onEnter=e(this.onEnter,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.events={"mouseenter [data-type='model-cell']":"onEnter"},i.prototype.onEnter=function(e){var t;return t=$(e.currentTarget),new App.Tooltip({el:t.closest("[data-type='model-cell']"),content:App.Render("manage/views/models/tooltip",App.Model.findOrBuild(t.data()))})},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ModelsAccessoriesController=function(n){function i(){return this.add=e(this.add,this),this.enter=e(this.enter,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.events={"click #add-accessory":"add","keypress #accessory-name":"enter"},i.prototype.elements={"input#accessory-name":"input",".list-of-lines":"list"},i.prototype.enter=function(e){return e.keyCode===$.ui.keyCode.ENTER?(e.preventDefault(),this.add({preventDefault:function(){return null}})):void 0},i.prototype.add=function(e){var t;return e.preventDefault(),t=this.input.val(),this.list.find("[data-name='"+t+"']").length||this.list.prepend(App.Render("manage/views/models/form/accessory_inline_entry",{name:t},{uid:App.Model.uid("uid")})),this.input.val("").blur()},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ModelsAllocationsController=function(n){function i(){this.getExistingEntry=e(this.getExistingEntry,this),i.__super__.constructor.apply(this,arguments),this.model="Group",this.templatePath="manage/views/models/form/allocation_inline_entry"}return t(i,n),i.prototype.getExistingEntry=function(e){return this.list.find("input[name*='[group_id]'][value='"+e.id+"']")},i}(App.AddInlineEntryController)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;window.App.ModelsAttachmentsController=function(t){function n(){n.__super__.constructor.apply(this,arguments),this.type="attachment",this.templatePath="manage/views/models/form/attachment_inline_entry",this.url=this.model.url("upload/"+this.type)}return e(n,t),n}(App.UploadController)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ModelsCategoriesController=function(n){function i(){this.getExistingEntry=e(this.getExistingEntry,this),i.__super__.constructor.apply(this,arguments),this.model="Category",this.templatePath="manage/views/models/form/category_inline_entry"}return t(i,n),i.prototype.getExistingEntry=function(e){return this.list.find("input[name='model[category_ids][]'][value='"+e.id+"']")},i}(App.AddInlineEntryController)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ModelsCompatiblesController=function(n){function i(){this.getExistingEntry=e(this.getExistingEntry,this),i.__super__.constructor.apply(this,arguments),this.model="Model",this.templatePath="manage/views/models/form/compatible_inline_entry"}return t(i,n),i.prototype.getExistingEntry=function(e){return this.list.find("input[name*='[compatible_ids]'][value='"+e.id+"']")},i}(App.AddInlineEntryController)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ModelsEditController=function(n){function i(){this.collectErrorMessages=e(this.collectErrorMessages,this),this.save=e(this.save,this),this.finish=e(this.finish,this),this.done=e(this.done,this),this.setupManufacturer=e(this.setupManufacturer,this),i.__super__.constructor.apply(this,arguments),new App.ModelsAllocationsController({el:this.el.find("#allocations")}),new App.ModelsCategoriesController({el:this.el.find("#categories")}),new App.ModelsAccessoriesController({el:this.el.find("#accessories")}),new App.ModelsCompatiblesController({el:this.el.find("#compatibles"),customLabelFn:function(e){var t;return t=e.product,e.version&&(t=[t,e.version].join(" ")),t}}),new App.ModelsPropertiesController({el:this.el.find("#properties")}),this.el.find("#packages").length&&new App.ModelsPackagesController({el:this.el.find("#packages")}),this.imagesController=new App.ImagesController({el:this.el.find("#images"),url:this.model.url("upload/image")}),this.attachmentsController=new App.ModelsAttachmentsController({el:this.el.find("#attachments"),model:this.model}),new App.InlineEntryRemoveController({el:this.el}),this.setupManufacturer()}return t(i,n),i.prototype.elements={"input[name='model[manufacturer]']":"manufacturer"},i.prototype.setupManufacturer=function(){return this.manufacturer.autocomplete({source:this.manufacturers,minLength:0,delay:0}).data("uiAutocomplete")._renderItem=function(e){return function(e,t){return $(App.Render("views/autocomplete/element",t)).data("value",t).appendTo(e)}}(this),this.manufacturer.focus(function(){return $(this).autocomplete("search")})},i.prototype.done=function(){return this.imagesController.upload(function(e){return function(){return e.attachmentsController.upload(function(){return e.finish()})}}(this))},i.prototype.finish=function(){return this.imagesController.uploadErrors.length||this.attachmentsController.uploadErrors.length?this.setupErrorModal(this.model):window.location=App.Inventory.url()+("?flash[success]="+_jed("Model saved"))},i.prototype.save=function(){return $.ajax({url:this.model.url(),data:this.form.serializeArray(),type:"PUT"})},i.prototype.collectErrorMessages=function(){return this.imagesController.uploadErrors.concat(this.attachmentsController.uploadErrors).join(", ")},i}(App.FormWithUploadController)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ModelsNewController=function(n){function i(){return this.updateUploadURL=e(this.updateUploadURL,this),this.save=e(this.save,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.save=function(){return $.post(App.Model.url(),this.form.serializeArray()).done(function(e){return function(t){return e.model.id=t.id,e.updateUploadURL()}}(this))},i.prototype.updateUploadURL=function(){return this.imagesController.url=this.model.url("upload/image")},i}(App.ModelsEditController)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ModelsPackageDialogController=function(n){function i(){this.save=e(this.save,this),this.prepareRequestData=e(this.prepareRequestData,this),this.removeItem=e(this.removeItem,this),this.addItem=e(this.addItem,this),this.select=e(this.select,this),this.fetchModels=e(this.fetchModels,this),this.fetchItems=e(this.fetchItems,this),this.setupAutocomplete=e(this.setupAutocomplete,this),this.setupFlexibleFields=e(this.setupFlexibleFields,this),this.el=$(App.Render("manage/views/models/packages/package_dialog")),i.__super__.constructor.apply(this,arguments),this.searchItemInput.preChange(),this.childrenContainer.html(App.Render("manage/views/models/packages/item",this.children)),this.modal=new App.Modal(this.el),
new App.InlineEntryRemoveController({el:this.el}),this.setupFlexibleFields()}return t(i,n),i.prototype.elements={"#notifications":"notifications","#item-form":"itemForm","#search-item":"searchItemInput","#items":"childrenContainer"},i.prototype.events={"focus #search-item":"setupAutocomplete","inline-entry-remove [data-type='inline-entry']":"removeItem","click #save-package":"save"},i.prototype.setupFlexibleFields=function(){return this.flexibleFieldsController=new App.ItemFlexibleFieldsController({el:this.itemForm.find("#flexible-fields"),itemData:this.item,itemType:"item",forPackage:!0,writeable:!0,hideable:!1})},i.prototype.setupAutocomplete=function(e){var t;return t=$(e.currentTarget),t.autocomplete({source:function(e){return function(n,i){return i([]),e.fetchItems(n.term).done(function(n){var r,o;return o=function(){var e,t,i;for(i=[],e=0,t=n.length;t>e;e++)r=n[e],i.push(App.Item.find(r.id));return i}(),e.fetchModels(o).done(function(){return t.is(":focus")?i(o):void 0})})}}(this),focus:function(e){return function(){return!1}}(this),select:function(e){return function(n,i){return e.select(n,i)&&t.val("")&&t.blur()}}(this),appendTo:this.modal.el,minLength:1}).data("uiAutocomplete")._renderItem=function(e){return function(e,t){return $(App.Render("manage/views/models/packages/item_autocomplete_element",t)).data("value",t).appendTo(e)}}(this),t.autocomplete("search")},i.prototype.fetchItems=function(e){return App.Item.ajaxFetch({data:$.param({search_term:e,not_packaged:!0,packages:!1,retired:!1})})},i.prototype.fetchModels=function(e){var t;return t=_.uniq(_.map(e,function(e){return e.model_id})),t.length?App.Model.ajaxFetch({data:$.param({ids:t,paginate:!1})}):{done:function(e){return e()}}},i.prototype.select=function(e,t){return this.addItem(t.item)},i.prototype.addItem=function(e){return _.find(this.children,function(t){return t.id===e.id})?!0:(this.children.push(e),this.modal.el.find("#items").append(App.Render("manage/views/models/packages/item",e)))},i.prototype.removeItem=function(e){var t;return t=$(e.currentTarget).closest("[data-type='inline-entry']"),this.children=_.filter(this.children,function(e){return e.id!==t.data("id")})},i.prototype.prepareRequestData=function(){var e,t,n,i,r;for(r=this.itemForm.serializeArray(),i=_.filter(App.Field.all(),function(e){return e.exclude_from_submit}),t=0,n=i.length;n>t;t++)e=i[t],r=_.reject(r,function(t){return t.name===e.getFormName()});return _.map(r,function(e){return{name:e.name.replace(/item/,""),value:e.value}})},i.prototype.save=function(){return this.notifications.addClass("hidden").html(""),this.children.length?App.Field.validate(this.itemForm)?(this.modal.destroy(!0),this.done(this.prepareRequestData(),this.children,this.entry)):this.notifications.removeClass("hidden").html(App.Render("manage/views/models/packages/missing_data_error")):this.notifications.removeClass("hidden").html(App.Render("manage/views/models/packages/no_items_error"))},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ModelsPackagesController=function(n){function i(){this.editNewPackage=e(this.editNewPackage,this),this.saveExistingPackage=e(this.saveExistingPackage,this),this.fetchChildren=e(this.fetchChildren,this),this.fetchItem=e(this.fetchItem,this),this.fetchModels=e(this.fetchModels,this),this.getRemoteItemData=e(this.getRemoteItemData,this),this.editExistingPackage=e(this.editExistingPackage,this),this.editPackage=e(this.editPackage,this),this.saveNotExistingPackage=e(this.saveNotExistingPackage,this),this.createPackage=e(this.createPackage,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.events={"click #add-package":"createPackage","click [data-edit-package]":"editPackage"},i.prototype.elements={".list-of-lines":"list","#add-package":"addPackageButton"},i.prototype.createPackage=function(){return new App.ModelsPackageDialogController({item:new App.Item($(this.addPackageButton).data()),done:this.saveNotExistingPackage,children:[]})},i.prototype.saveNotExistingPackage=function(e,t,n){return null!=n&&n.remove(),this.list.prepend(App.Render("manage/views/models/form/package_inline_entry",{children:t,data:e},{uid:App.Model.uid("uid")}))},i.prototype.editPackage=function(e){var t,n;return n=$(e.currentTarget),t=n.closest("[data-type='inline-entry']"),null!=t.data("id")?this.editExistingPackage(t):this.editNewPackage(t)},i.prototype.editExistingPackage=function(e){var t;return t=new App.Modal("<div>"),t.undestroyable(),this.getRemoteItemData(e,function(n){return function(i,r){return t.destroyable().destroy(),new App.ModelsPackageDialogController({item:i,children:r,done:n.saveExistingPackage,entry:e})}}(this))},i.prototype.getRemoteItemData=function(e,t){var n;return n=e.data("id"),this.fetchItem(n).done(function(e){return function(i){return e.fetchChildren(n).done(function(n){var r,o;return r=function(){var e,t,i;for(i=[],e=0,t=n.length;t>e;e++)o=n[e],i.push(App.Item.find(o.id));return i}(),e.fetchModels(r).done(function(){return t(i,r)})})}}(this))},i.prototype.fetchModels=function(e){var t,n;return t=function(){var t,i,r;for(r=[],t=0,i=e.length;i>t;t++)n=e[t],r.push(n.model_id);return r}(),t.length?App.Model.ajaxFetch({data:$.param({ids:t,paginate:!1,include_package_models:!0})}):{done:function(e){return e()}}},i.prototype.fetchItem=function(e){return $.get(App.Item.url()+("/"+e),{"for":"flexibleFields"})},i.prototype.fetchChildren=function(e){return App.Item.ajaxFetch({data:$.param({package_ids:[e],paginate:!1})})},i.prototype.saveExistingPackage=function(e,t,n){return this.list.prepend(n),n.find("[data-type='updated-text']").removeClass("hidden"),n.find("[data-type='form-data']").html(function(){return App.Render("manage/views/models/form/package_inline_entry/updated_package_form_data",{children:t,data:e},{uid:n.data("id")})})},i.prototype.editNewPackage=function(e){var t;return t=App.ElementFormDataAsObject(e),new App.ModelsPackageDialogController({item:t,done:this.saveNotExistingPackage,children:_.map(t.children,function(e){return App.Item.find(e.id)}),entry:e})},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ModelsPropertiesController=function(n){function i(){this.add=e(this.add,this),i.__super__.constructor.apply(this,arguments),this.list.sortable({handle:"[data-type='sort-handle']"})}return t(i,n),i.prototype.events={"click #add-property":"add"},i.prototype.elements={".list-of-lines":"list"},i.prototype.add=function(e){return e.preventDefault(),this.list.prepend(App.Render("manage/views/models/form/property_inline_entry",{},{uid:App.Model.uid("uid")})),this.list.find("input[type='text']:first").focus()},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ManageBookingCalendarDialogController=function(n){function i(){return this.store=e(this.store,this),this.valid=e(this.valid,this),this.validationAlerts=e(this.validationAlerts,this),this.getSelectedInventoryPool=e(this.getSelectedInventoryPool,this),this.calendarRendered=e(this.calendarRendered,this),this.setupBookingCalendar=e(this.setupBookingCalendar,this),this.setupPartitions=e(this.setupPartitions,this),this.initalizeDialog=e(this.initalizeDialog,this),this.fetchGroups=e(this.fetchGroups,this),this.fetchPartitions=e(this.fetchPartitions,this),this.fetchAvailability=e(this.fetchAvailability,this),this.fetchData=e(this.fetchData,this),this.setupDates=e(this.setupDates,this),this.setupModal=e(this.setupModal,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.setupModal=function(){return this.dialog=$(App.Render("manage/views/booking_calendar/calendar_dialog",{user:this.user},{startDateDisabled:this.startDateDisabled,quantityDisabled:this.quantityDisabled})),this.listOfLines=this.dialog.find("#booking-calendar-lines .list-of-lines"),this.partitionsEl=this.dialog.find("#booking-calendar-partitions"),i.__super__.setupModal.apply(this,arguments)},i.prototype.setupDates=function(){return this.startDateEl.val(_.min(this.reservations,function(e){return Date.parse(e.start_date)}).start_date),this.endDateEl.val(_.max(this.reservations,function(e){return Date.parse(e.end_date)}).end_date)},i.prototype.fetchData=function(){return this.fetchWorkdays().done(function(e){return function(){return e.initalizeDialog()}}(this)),this.fetchHolidays().done(function(e){return function(){return e.initalizeDialog()}}(this)),this.fetchPartitions().done(function(e){return function(){return e.fetchGroups().done(function(){return e.initalizeDialog()})}}(this)),_.any(this.models,function(e){return null==("function"==typeof e.availability?e.availability():void 0)})?this.fetchAvailability().done(function(e){return function(){return e.initalizeDialog()}}(this)):this.availabilities=!0},i.prototype.fetchAvailability=function(){return App.Availability.ajaxFetch({data:$.param({model_ids:_.map(this.models,function(e){return e.id}),user_id:this.user.id})}).done(function(e){return function(){return e.availabilities=!0}}(this))},i.prototype.fetchPartitions=function(){return App.Partition.ajaxFetch({data:$.param({model_ids:_.map(this.models,function(e){return e.id})})}).done(function(e){return function(t){var n;return e.partitions=function(){var e,i,r;for(r=[],e=0,i=t.length;i>e;e++)n=t[e],r.push(App.Partition.find(""+n.model_id+n.inventory_pool_id+n.group_id));return r}()}}(this))},i.prototype.fetchGroups=function(){return App.Group.ajaxFetch({data:$.param({group_ids:_.compact(_.uniq(_.map(this.partitions,function(e){return e.group_id})))})}).done(function(e){return function(t){var n;return e.groups=function(){var e,i,r;for(r=[],e=0,i=t.length;i>e;e++)n=t[e],r.push(App.Group.find(n.id));return r}(),e.setupPartitions()}}(this))},i.prototype.initalizeDialog=function(){return this.workdays&&this.holidays&&this.availabilities&&this.partitions&&this.groups?i.__super__.initalizeDialog.apply(this,arguments):!1},i.prototype.setupPartitions=function(){var e,t,n,i,r;for(e={user:[],userGroups:[],otherGroups:[]},e.user=this.user.groupIds,r=this.partitions,t=0,n=r.length;n>t;t++)i=r[t],null!=i.group_id&&(_.include(this.user.groupIds,i.group_id)?e.userGroups.push(i.group()):e.otherGroups.push(i.group()));return this.partitionsEl.html(App.Render("manage/views/booking_calendar/partitions",e))},i.prototype.setupBookingCalendar=function(){return new App.ManageBookingCalendar({calendarEl:this.dialog.find("#booking-calendar"),startDateEl:this.startDateEl,startDateDisabled:this.startDateDisabled,endDateEl:this.endDateEl,quantityEl:this.dialog.find("#booking-calendar-quantity"),groupIds:this.user.groupIds,partitions:this.partitions,reservations:this.reservations,models:this.models,renderFunctionCallback:this.calendarRendered})},i.prototype.calendarRendered=function(){var e;return e={groupIds:this.user.groupIds,start_date:moment(this.startDateEl.val(),i18n.date.L),end_date:moment(this.endDateEl.val(),i18n.date.L),quantity:this.getQuantity()},this.listOfLines.html(App.Render("manage/views/booking_calendar/line",this.mergedLines,e))},i.prototype.getSelectedInventoryPool=function(){return App.InventoryPool.current},i.prototype.validationAlerts=function(){var e,t;return t=this.getSelectedInventoryPool(),e=[],t.isVisitPossible(this.getStartDate())||e.push(_jed("Booking is no longer possible on this start date")),t.isVisitPossible(this.getEndDate())||e.push(_jed("Booking is no longer possible on this end date")),t.isClosedOn(this.getStartDate())&&e.push(_jed("Inventory pool is closed on start date")),t.isClosedOn(this.getEndDate())&&e.push(_jed("Inventory pool is closed on end date")),e.length?this.showError(e.join(", ")):this.errorsContainer.html("")},i.prototype.valid=function(){return!0},i.prototype.store=function(){},i}(App.BookingCalendarDialogController)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ReservationsAddController=function(n){function i(t){this.onSubmitInventoryCode=t,this.showExplorativeSearch=e(this.showExplorativeSearch,this),this.addTemplate=e(this.addTemplate,this),this.addOption=e(this.addOption,this),this.addModel=e(this.addModel,this),this.add=e(this.add,this),this.addInventoryItem=e(this.addInventoryItem,this),this.submit=e(this.submit,this),this.getInputValue=e(this.getInputValue,this),this.fetchAvailabilities=e(this.fetchAvailabilities,this),this.searchTemplates=e(this.searchTemplates,this),this.searchOptions=e(this.searchOptions,this),this.searchModels=e(this.searchModels,this),this.pushOptionsTo=e(this.pushOptionsTo,this),this.pushTemplatesTo=e(this.pushTemplatesTo,this),this.pushModelsTo=e(this.pushModelsTo,this),this.getEndDate=e(this.getEndDate,this),this.getStartDate=e(this.getStartDate,this),this.setupDatepickers=e(this.setupDatepickers,this),this.select=e(this.select,this),this.search=e(this.search,this),this.setupAutocomplete=e(this.setupAutocomplete,this),this.handleEvents=e(this.handleEvents,this),i.__super__.constructor.apply(this,arguments),this.preventSubmit=!1,this.setupDatepickers()}return t(i,n),i.prototype.elements={"#add-start-date":"addStartDate","#add-end-date":"addEndDate"},i.prototype.events={"click [type='submit']":"handleEvents",submit:"handleEvents"},i.prototype.handleEvents=function(e){var t,n;return null!=e&&e.preventDefault(),t=document.querySelector(":focus"),n=this.getInputValue(),0!==n.length?this.submit(e):t&&"BUTTON"!==t.nodeName?"INPUT"===t.nodeName?this.submit(e):void 0:this.showExplorativeSearch(e)},i.prototype.setupAutocomplete=function(e){return this.autocompleteController=e},i.prototype.search=function(e,t){var n;return e.length?(this.models=this.options=this.templates=this.availabilities=this.options=null,n=function(e){return function(){var n;return null==e.models||null==e.templates||null==e.availabilities||(e.optionsEnabled?null==e.options:0)?void 0:(n=[],e.pushModelsTo(n),e.optionsEnabled&&e.pushOptionsTo(n),e.pushTemplatesTo(n),t(n))}}(this),this.searchModels(e,n),this.searchTemplates(e,n),this.optionsEnabled?this.searchOptions(e,n):void 0):!1},i.prototype.select=function(e){return this.add(e.record,this.getStartDate(),this.getEndDate()),this.autocompleteController._render()},i.prototype.setupDatepickers=function(){var e,t,n,i;for(i=[this.addStartDate,this.addEndDate],t=0,n=i.length;n>t;t++)e=i[t],$(e).datepicker();return this.addStartDate.datepicker("option","minDate",moment().startOf("day").toDate()),this.addEndDate.datepicker("option","minDate",{getTime:function(e){return function(){return moment(e.addStartDate.val(),i18n.date.L).startOf("day").toDate()}}(this)}),this.addStartDate.datepicker("option","onSelect",function(e){return function(t){var n;return t=moment(t,i18n.date.L).startOf("day"),n=moment(e.addEndDate.val(),i18n.date.L).startOf("day"),t.toDate()>n.toDate()?e.addEndDate.val(t.format(i18n.date.L)):void 0}}(this))},i.prototype.getStartDate=function(){return moment(this.addStartDate.val(),i18n.date.L)},i.prototype.getEndDate=function(){return moment(this.addEndDate.val(),i18n.date.L)},i.prototype.pushModelsTo=function(e){var t,n,i,r,o,s,a;for(s=this.models,a=[],t=0,n=s.length;n>t;t++)o=s[t],null!=o.availability()?(i=o.availability().maxAvailableForGroups(this.getStartDate(),this.getEndDate(),this.user.groupIds),r=o.availability().maxAvailableInTotal(this.getStartDate(),this.getEndDate()),a.push(e.push({name:o.name(),availability:i+"("+r+")/"+o.availability().total_rentable,available:i>0,type:_jed("Model"),record:o}))):a.push(void 0);return a},i.prototype.pushTemplatesTo=function(e){var t,n,i,r,o;for(i=this.templates,r=[],t=0,n=i.length;n>t;t++)o=i[t],r.push(e.push({name:o.name,available:!0,type:_jed("Template"),record:o}));return r},i.prototype.pushOptionsTo=function(e){var t,n,i,r,o;for(r=this.options,o=[],t=0,n=r.length;n>t;t++)i=r[t],o.push(e.push({name:i.name(),available:!0,type:_jed("Option"),record:i}));return o},i.prototype.searchModels=function(e,t){return App.Model.ajaxFetch({data:$.param({search_term:e,used:!0,as_responsible_only:!0,per_page:this.modelsPerPage||5})}).done(function(e){return function(n){var i;return e.models=function(){var e,t,r;for(r=[],e=0,t=n.length;t>e;e++)i=n[e],r.push(App.Model.find(i.id));return r}(),e.fetchAvailabilities(function(){return t()})}}(this))},i.prototype.searchOptions=function(e,t){return App.Option.ajaxFetch({data:$.param({search_term:e,per_page:this.optionsPerPage||5})}).done(function(e){return function(n){var i;return e.options=function(){var e,t,r;for(r=[],e=0,t=n.length;t>e;e++)i=n[e],r.push(App.Option.find(i.id));return r}(),t()}}(this))},i.prototype.searchTemplates=function(e,t){return App.Template.ajaxFetch({data:$.param({search_term:e,per_page:this.templatesPerPage||5})}).done(function(e){return function(n){var i;return e.templates=function(){var e,t,r;for(r=[],e=0,t=n.length;t>e;e++)i=n[e],r.push(App.Template.find(i.id));return r}(),t()}}(this))},i.prototype.fetchAvailabilities=function(e){return null!=this.models&&this.models.length?App.Availability.ajaxFetch({data:$.param({model_ids:_.map(this.models,function(e){return e.id}),user_id:this.user.id})}).done(function(t){return function(n){var i;return t.availabilities=function(){var e,t,r;for(r=[],e=0,t=n.length;t>e;e++)i=n[e],r.push(App.Availability.find(i.id));return r}(),e()}}(this)):(this.availabilities=[],e())},i.prototype.getInputValue=function(){return this.autocompleteController.getInstance().state.value},i.prototype.submit=function(e){var t;return this.preventSubmit?!1:(t=this.getInputValue(),t.length&&App.Inventory.findByInventoryCode(t).done(function(e){return function(n){return e.addInventoryItem(n,t)}}(this)),this.autocompleteController.getInstance().resetInput())},i.prototype.addInventoryItem=function(e,t){var n;return null!=e?null==e.error?null!=e.model_id?App.Model.ajaxFetch({id:e.model_id}).done(function(e){return function(n){return e.add(App.Model.find(n.id),e.getStartDate(),e.getEndDate(),t)}}(this)):(n=App.Option.addRecord(new App.Option(e)),this.add(n,this.getStartDate(),this.getEndDate())):App.Flash({type:"error",message:e.error}):App.Flash({type:"error",message:_jed("The Inventory Code %s was not found.",t)})},i.prototype.add=function(e,t,n,i){return e instanceof App.Model?this.addModel(e,t,n,i):e instanceof App.Option?this.addOption(e,t,n):e instanceof App.Template?this.addTemplate(e,t,n):void 0},i.prototype.addModel=function(e,t,n,i){var r;return this.addModelForHandOver&&i?"function"==typeof this.onSubmitInventoryCode?this.onSubmitInventoryCode(i):void 0:App.Reservation.createOne({inventory_pool_id:App.InventoryPool.current.id,start_date:moment(t).format("YYYY-MM-DD"),end_date:moment(n).format("YYYY-MM-DD"),contract_id:this.contract.id,purpose_id:null!=(r=this.purpose)?r.id:void 0,quantity:1,model_id:e.id}).done(function(t){return function(n){return App.LineSelectionController.add(n.id),"function"==typeof t.onSubmitInventoryCode&&t.onSubmitInventoryCode(i),App.Flash({type:"notice",message:_jed("Added %s",e.name())})}}(this)).fail(function(e){return App.Flash({type:"error",message:e.responseText})})},i.prototype.addOption=function(e,t,n){var i,r,o;return i=_.find(this.contract.reservations().all(),function(i){return i.option_id===e.id&&0===moment(i.start_date).diff(t,"days")&&0===moment(i.end_date).diff(n,"days")}),i?(r=i.quantity+1,i.updateAttributes({quantity:r}),App.Flash({type:"notice",message:_jed("%s quantity increased to %s",[e.name(),r])}),App.LineSelectionController.add(i.id)):App.Reservation.create({inventory_pool_id:App.InventoryPool.current.id,start_date:moment(t).format("YYYY-MM-DD"),end_date:moment(n).format("YYYY-MM-DD"),contract_id:this.contract.id,purpose_id:null!=(o=this.purpose)?o.id:void 0,quantity:1,option_id:e.id},{done:function(){return App.LineSelectionController.add(this.id),App.Flash({type:"notice",message:_jed("Added %s",e.name())})}})},i.prototype.addTemplate=function(e,t,n){var i;return App.Reservation.createForTemplate({inventory_pool_id:App.InventoryPool.current.id,start_date:moment(t).format("YYYY-MM-DD"),end_date:moment(n).format("YYYY-MM-DD"),contract_id:this.contract.id,purpose_id:null!=(i=this.purpose)?i.id:void 0,template_id:e.id}).done(function(t){return function(t){var n,i,r;for(n=0,i=t.length;i>n;n++)r=t[n],App.LineSelectionController.add(r.id);return App.Flash({type:"notice",message:_jed("Added %s",e.name)})}}(this))},i.prototype.showExplorativeSearch=function(e){return new App.ReservationsExplorativeAddController({contract:this.contract,startDate:this.getStartDate(),endDate:this.getEndDate(),addModel:this.addModel})},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ReservationAssignItemController=function(n){function i(){this.submitAssignment=e(this.submitAssignment,this),this.removeAssignment=e(this.removeAssignment,this),this.assignItem=e(this.assignItem,this),this.fetchWithIds=e(this.fetchWithIds,this),this.fetchItemsOrLicences=e(this.fetchItemsOrLicences,this),this.searchItems=e(this.searchItems,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.events={"focus [data-assign-item]":"searchItems","submit [data-assign-item-form]":"submitAssignment","click [data-remove-assignment]":"removeAssignment"},i.prototype.searchItems=function(e){var t,n;return n=$(e.currentTarget),t=App.Reservation.find(n.closest("[data-id]").data("id")).model(),(t.constructor===App.Model?this.fetchItems(t):t.constructor===App.Software?this.fetchLicenses(t):void 0).done(function(e){return function(t){var i,r;return r=function(){var e,n,r,o;for(o=[],e=0,n=t.length;n>e;e++)i=t[e],o.push(null!=(r=App.Item.exists(i.id))?r:App.License.find(i.id));return o}(),r.length?e.setupAutocomplete(n,r):void 0}}(this))},i.prototype.setupAutocomplete=function(e,t){return!e.is(":focus")||e.is(":disabled")?!1:(e.autocomplete({appendTo:e.closest(".line"),source:function(e){return function(e,n){var i;return i=_.map(t,function(e){return e.value=e.id,e}),i=_.filter(i,function(t){return t.inventory_code.match(e.term)}),n(i)}}(this),focus:function(e){return function(){return!1}}(this),minLength:0,select:function(t){return function(n,i){return t.assignItem(e,i.item),!1}}(this)}).data("uiAutocomplete")._renderItem=function(e){return function(e,t){return $(App.Render("manage/views/items/autocomplete_element",t)).data("value",t).appendTo(e)}}(this),e.autocomplete("search",""))},i.prototype.fetchItemsOrLicences=function(e,t){return e.ajaxFetch({data:$.param({model_ids:[t.id],in_stock:!0,responsible_inventory_pool_id:App.InventoryPool.current.id,retired:!1})})},i.prototype.fetchItems=_.partial(i.prototype.fetchItemsOrLicences,App.Item),i.prototype.fetchLicenses=_.partial(i.prototype.fetchItemsOrLicences,App.License),i.prototype.fetchWithIds=function(e,t){return t.length?e.ajaxFetch({data:$.param({ids:t})}):{done:function(e){return e()}}},i.prototype.fetchBuildings=_.partial(i.prototype.fetchWithIds,App.Building),i.prototype.assignItem=function(e,t){var n;return e.blur(),e.autocomplete("destroy"),n=App.Reservation.find(e.closest("[data-id]").data("id")),n.assign(t,function(i){return function(){return e.val(t.inventory_code),e.prop("disabled",!0),App.LineSelectionController.add(n.id)}}(this))},i.prototype.removeAssignment=function(e){var t,n;return n=$(e.currentTarget),t=App.Reservation.find(n.closest("[data-id]").data("id")),t.removeAssignment(),App.Flash({type:"notice",message:_jed("The assignment for %s was removed",t.model().name())})},i.prototype.submitAssignment=function(e){var t,n,i,r,o;return e.preventDefault(),o=$(e.currentTarget).find("[data-assign-item]"),i=App.Reservation.find(o.closest("[data-id]").data("id")),t=o.val(),n=i.model(),r=n.constructor===App.Model?App.Item:n.constructor===App.Software?App.License:void 0,r.ajaxFetch({data:$.param({inventory_code:t})}).done(function(e){return function(n){return 1===n.length?e.assignItem(o,r.find(n[0].id)):App.Flash({type:"error",message:_jed("The Inventory Code %s was not found for %s",[t,i.model().name()])})}}(this))},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ReservationsChangeController=function(n){function i(){return this.changeRange=e(this.changeRange,this),this.storeOptionLine=e(this.storeOptionLine,this),this.storeItemLine=e(this.storeItemLine,this),this.store=e(this.store,this),this.done=e(this.done,this),this.createReservation=e(this.createReservation,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.createReservation=function(){var e;return App.Reservation.createOne({model_id:_.first(this.models).id,start_date:this.getStartDate().format("YYYY-MM-DD"),end_date:this.getEndDate().format("YYYY-MM-DD"),contract_id:null!=(e=this.contract)?e.id:void 0,purpose_id:_.first(this.reservations).purpose_id,quantity:1}).fail(function(e){return function(t){return e.fail(t)}}(this))},i.prototype.done=function(e){var t;return App.Reservation.trigger("refresh",function(){var n,i,r;for(r=[],n=0,i=e.length;i>n;n++)t=e[n],r.push(App.Reservation.find(t.id));return r}()),i.__super__.done.apply(this,arguments)},i.prototype.store=function(){return null!=this.contract?1===this.models.length?this.storeItemLine():0===this.models.length?this.storeOptionLine():this.changeRange():this.changeRange()},i.prototype.storeItemLine=function(){var e,t,n,i,r,o,s,a,l,d,p,u;if(t=this.getQuantity()-this.quantity,0>t){for(l=this.reservations.slice(0,+(Math.abs(t)-1)+1||9e9),e=_.after(l.length,this.changeRange),this.reservations=_.reject(this.reservations,function(e){return _.include(l,e)}),d=[],i=0,o=l.length;o>i;i++)s=l[i],d.push(function(t){return App.Reservation.ajaxChange(t,"destroy",{}).done(function(n){return function(){return t.remove(),e()}}(this))}(s));return d}if(t>0){for(n=_.after(t,this.changeRange),p=[],u=r=1,a=t;a>=1?a>=r:r>=a;u=a>=1?++r:--r)p.push(this.createReservation().done(function(e){return function(t){return e.reservations.push(App.Reservation.find(t.id)),n()}}(this)));return p}return this.changeRange()},i.prototype.storeOptionLine=function(){var e;return null!=this.getQuantity()?(e=_.first(this.reservations),e.updateAttributes({quantity:this.getQuantity(),start_date:this.getStartDate().format("YYYY-MM-DD"),end_date:this.getEndDate().format("YYYY-MM-DD")}),this.done(e.contract())):this.changeRange()},i.prototype.changeRange=function(){return this.getStartDate().format("YYYY-MM-DD")!==this.startDate||this.getEndDate().format("YYYY-MM-DD")!==this.endDate?App.Reservation.changeTimeRange(this.reservations,this.startDateDisabled?void 0:this.getStartDate(),this.getEndDate()).done(this.done).fail(this.fail):this.done()},i}(window.App.ManageBookingCalendarDialogController)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ReservationsDestroyController=function(n){function i(){return this.destroyReservations=e(this.destroyReservations,this),this.destroySelectedLines=e(this.destroySelectedLines,this),this.destroyLines=e(this.destroyLines,this),this.destroyLine=e(this.destroyLine,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.events={"click [data-destroy-line]":"destroyLine","click [data-destroy-lines]":"destroyLines","click [data-destroy-selected-lines]":"destroySelectedLines"},i.prototype.destroyLine=function(e){return this.destroyReservations($(e.currentTarget),[$(e.currentTarget).closest("[data-id]").data("id")])},i.prototype.destroyLines=function(e){return this.destroyReservations($(e.currentTarget),$(e.currentTarget).data("ids"))},i.prototype.destroySelectedLines=function(e){return this.destroyReservations($(e.currentTarget),App.LineSelectionController.selected)},i.prototype.destroyReservations=function(e,t){return App.LineSelectionController.selected=_.difference(App.LineSelectionController.selected,t),App.Reservation.destroyMultiple(t)},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ReservationsEditController=function(n){function i(){return this.editLines=e(this.editLines,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.events={"click [data-edit-lines]":"editLines"},i.prototype.editLines=function(e){var t,n,i,r,o,s,a,l;return l=$(e.currentTarget),a="selected-lines"===l.data("edit-lines"),n=a?App.LineSelectionController.selected:l.data("ids"),s=function(){var e,i,r;for(r=[],e=0,i=n.length;i>e;e++)t=n[e],r.push(App.Reservation.find(t));return r}(),i=App.Modules.HasLines.mergeLinesByModel(s),o=a?null:_.reduce(i,function(e,t){return e+(null!=t.subreservations?_.reduce(t.subreservations,function(e,t){return e+t.quantity},0):t.quantity)},0),r=_.unique(_.map(_.filter(i,function(e){return null!=e.model_id}),function(e){return e.model()}),!1,function(e){return e.id}),new App.ReservationsChangeController({mergedLines:i,reservations:s,user:this.user,models:r,quantity:o,contract:this.contract,startDateDisabled:this.startDateDisabled,quantityDisabled:this.quantityDisabled})},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ReservationsExplorativeAddController=function(n){function i(t){this.select=e(this.select,this),this.render=e(this.render,this),this.fetchAvailability=e(this.fetchAvailability,this),this.fetchModels=e(this.fetchModels,this),this.fetch=e(this.fetch,this),this.reset=e(this.reset,this),this.setupModal=e(this.setupModal,this),this.startDate=t.startDate,this.endDate=t.endDate,this.setupModal(),i.__super__.constructor.apply(this,arguments),this.categoriesFilter=new App.CategoriesFilterController({el:this.categoriesContainer,filter:this.reset}),this.pagination=new App.ListPaginationController({el:this.list,fetch:this.fetch}),this.reset()}return t(i,n),i.prototype.elements={"#categories":"categoriesContainer","#models":"list"},i.prototype.events={"click [data-type='select']":"select"},i.prototype.setupModal=function(){return this.el=$(App.Render("manage/views/reservations/explorative_add_dialog",{startDate:this.startDate,endDate:this.endDate})),this.modal=new App.Modal(this.el)},i.prototype.reset=function(){return this.models={},this.list.html(App.Render("manage/views/lists/loading")),this.fetch(1,this.list)},i.prototype.fetch=function(e,t){return this.fetchModels(e).done(function(n){return function(){return n.fetchAvailability(e).done(function(){return n.render(t,n.models[e],e)})}}(this))},i.prototype.fetchModels=function(e){var t;return App.Model.ajaxFetch({data:$.param({page:e,category_id:null!=(t=this.categoriesFilter.getCurrent())?t.id:void 0,used:!0,borrowable:!0,responsible_inventory_pool_id:App.InventoryPool.current.id})}).done(function(t){return function(n,i,r){var o,s;return t.pagination.set(JSON.parse(r.getResponseHeader("X-Pagination"))),s=function(){var e,t,i;for(i=[],e=0,t=n.length;t>e;e++)o=n[e],i.push(App.Model.find(o.id));return i}(),t.models[e]=s}}(this))},i.prototype.fetchAvailability=function(e){var t,n;return n=_.filter(this.models[e],function(e){
return"Model"===e.constructor.className}),t=_.map(n,function(e){return e.id}),t.length?App.Availability.ajaxFetch({url:App.Availability.url(),data:$.param({model_ids:t,user_id:this.contract.user_id})}):{done:function(e){return e()}}},i.prototype.render=function(e,t,n){if(null!=t){if(!t.length)return e.html(App.Render("manage/views/lists/no_results"));if(e.html(App.Render("manage/views/models/explorative_add_line",t,{startDate:this.startDate,endDate:this.endDate,groupIds:this.contract.user().groupIds})),1===n)return this.pagination.renderPlaceholders()}},i.prototype.select=function(e){var t,n;return n=$(e.currentTarget),t=App.Model.find(n.closest("[data-id]").data("id")),this.addModel(t,this.startDate,this.endDate),this.modal.destroy(!0)},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.SwapModelController=function(n){function i(){return this.exploreModels=e(this.exploreModels,this),this.swapModel=e(this.swapModel,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.events={"click [data-swap-model]":"exploreModels"},i.prototype.swapModel=function(e,t,n){var i;return $.post("/manage/"+App.InventoryPool.current.id+"/reservations/swap_model",{line_ids:function(){var e,t,n,r;for(n=this.reservations,r=[],e=0,t=n.length;t>e;e++)i=n[e],r.push(i.id);return r}.call(this),model_id:e.id},function(e){var t,n,r;for(r=[],t=0,n=e.length;n>t;t++)i=e[t],r.push(App.Reservation.update(i.id,i));return r})},i.prototype.exploreModels=function(e){var t;return this.reservations=$(e.currentTarget).closest("[data-ids]").length?_.map($(e.currentTarget).closest("[data-ids]").data("ids"),function(e){return App.Reservation.find(e)}):[App.Reservation.find($(e.currentTarget).closest("[data-id]").data("id"))],t=this.reservations[0],new App.ReservationsExplorativeAddController({contract:t.contract(),startDate:t.start_date,endDate:t.end_date,addModel:this.swapModel})},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ImagesController=function(n){function i(){this.processNewFile=e(this.processNewFile,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.templatePath="manage/views/templates/upload/image_inline_entry",i.prototype.processNewFile=function(e,t){var n;return n=new FileReader,n.onload=function(t){return function(t){return e.find("img").attr("src",t.target.result)}}(this),n.readAsDataURL(t)},i}(App.UploadController)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.InlineEntryRemoveController=function(n){function i(){return this.toggleDestroy=e(this.toggleDestroy,this),this.remove=e(this.remove,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.events={"click [data-type='inline-entry'] [data-remove]":"remove"},i.prototype.remove=function(e){var t;return e.preventDefault(),t=$(e.currentTarget).closest("[data-type='inline-entry']"),t.trigger("inline-entry-remove",t),null!=t.data("new")?(t.remove(),"function"==typeof this.removeCallback?this.removeCallback(t):void 0):this.toggleDestroy(t,$(e.currentTarget))},i.prototype.toggleDestroy=function(e,t){var n,i,r;return i=t,n=e.find("[name*='_destroy']"),null!=e.data("destroyOnSave")?(e.removeClass("striked"),e.find("input:visible").prop("disabled",!1),e.data("removedOnSaveInfo").remove(),e.find("[data-disable-on-remove]").prop("disabled",!1),n.length&&n.val(null),e.data("destroyOnSave",null),t.text(_jed("Remove")),"function"==typeof this.unstrikeCallback?this.unstrikeCallback(e):void 0):(e.addClass("striked"),e.find("input:visible").prop("disabled",!0),r=$(App.Render("manage/views/inline_entries/removed_on_save_info")),e.data("removedOnSaveInfo",r),e.prepend(r),e.find("[data-disable-on-remove]").prop("disabled",!0),n.length&&n.val(1),e.data("destroyOnSave",!0),t.text(_jed("undo")),"function"==typeof this.strikeCallback?this.strikeCallback(e):void 0)},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.LatestReminderTooltipController=function(n){function i(){return this.onEnter=e(this.onEnter,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.events={"mouseenter .latest-reminder-cell":"onEnter"},i.prototype.onEnter=function(e){var t,n;return n=$(e.currentTarget),t=new App.Tooltip({el:n,content:App.Render("views/loading",{size:"micro"})}),App.LatestReminder.ajaxFetch({url:"/manage/"+App.InventoryPool.current.id+"/latest_reminder",data:$.param({user_id:n.data("user-id"),visit_id:n.data("visit-id")})}).done(function(e){return function(e){return e.length?t.update(App.Render("manage/views/inventory_pools/latest_reminder/tooltip",e)):t.update(_jed("No reminder yet"))}}(this))},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.LinesCellTooltipController=function(n){function i(){return this.fetchOptions=e(this.fetchOptions,this),this.fetchModels=e(this.fetchModels,this),this.sliceFetchOptions=e(this.sliceFetchOptions,this),this.sliceFetchModels=e(this.sliceFetchModels,this),this.fetchData=e(this.fetchData,this),this.onEnter=e(this.onEnter,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.events={"mouseenter [data-type='lines-cell']":"onEnter"},i.prototype.onEnter=function(e){var t,n,i;return i=$(e.currentTarget),t=i.closest(".line[data-type='contract']").length?App.Contract.findOrBuild(i.closest(".line[data-type='contract']").data()):i.closest(".line[data-type='take_back']").length?App.Visit.findOrBuild(i.closest(".line[data-type='take_back']").data()):i.closest(".line[data-type='hand_over']").length?App.Visit.findOrBuild(i.closest(".line[data-type='hand_over']").data()):void 0,n=new App.Tooltip({el:i.closest(".line-col"),content:App.Render("views/loading",{size:"micro"})}),this.fetchData(t,function(e){return function(){return n.update(App.Render("manage/views/reservations/tooltip",t))}}(this))},i.prototype.fetchData=function(e,t){var n,i,r,o,s,a;for(o=[],s=[],a=e.reservations().all(),n=0,i=a.length;i>n;n++)r=a[n],null!=r.model_id?null==App.Model.exists(r.model_id)&&o.push(r.model_id):null!=r.option_id&&null==App.Option.exists(r.option_id)&&s.push(r.option_id);return o.length>0?this.sliceFetchModels(o,function(e){return function(){return s.length>0?e.sliceFetchOptions(s,t):e.fetchOptions(s).done(function(){return t()})}}(this)):this.fetchModels(o).done(function(e){return function(){return s.length>0?e.sliceFetchOptions(s,t):e.fetchOptions(s).done(function(){return t()})}}(this))},i.prototype.sliceFetchModels=function(e,t){var n;return n=_.after(Math.ceil(e.length/50),t),_(e).each_slice(50,function(e){return function(t){return e.fetchModels(t).done(n)}}(this))},i.prototype.sliceFetchOptions=function(e,t){var n;return n=_.after(Math.ceil(e.length/50),t),_(e).each_slice(50,function(e){return function(t){return e.fetchOptions(t).done(n)}}(this))},i.prototype.fetchModels=function(e){return e.length?App.Model.ajaxFetch({data:$.param({ids:e,paginate:!1})}):{done:function(e){return e()}}},i.prototype.fetchOptions=function(e){return e.length?App.Option.ajaxFetch({data:$.param({ids:e,paginate:!1})}):{done:function(e){return e()}}},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.LineSelectionController=function(n){function i(){this.storeIdsToInputValues=e(this.storeIdsToInputValues,this),this.storeIdsToHrefs=e(this.storeIdsToHrefs,this),this.storeIds=e(this.storeIds,this),this.disable=e(this.disable,this),this.enable=e(this.enable,this),this.restore=e(this.restore,this),this.update=e(this.update,this),this.blurLines=e(this.blurLines,this),this.focusLines=e(this.focusLines,this),this.toggleContainerAbove=e(this.toggleContainerAbove,this),this.toggleLinesIn=e(this.toggleLinesIn,this),this.toggleContainer=e(this.toggleContainer,this),this.toggleLine=e(this.toggleLine,this),this.delegateEvents=e(this.delegateEvents,this),i.__super__.constructor.apply(this,arguments),this.delegateEvents(),App.LineSelectionController.Singleton=this}return t(i,n),i.selected=[],i.Singleton=null,i.prototype.elements={"#line-selection-counter":"lineSelectionCounter"},i.prototype.delegateEvents=function(){return this.el.on("change","input[data-select-line]",this.toggleLine),this.el.on("change","input[data-select-lines]",this.toggleContainer),this.el.on("change","input[data-select-lines], input[data-select-line]",this.update),this.el.on("mouseenter","input[data-select-lines]",this.focusLines),this.el.on("mouseleave","input[data-select-lines]",this.blurLines),App.Reservation.on("destroy",this.update),App.Contract.on("refresh",this.update)},i.prototype.toggleLine=function(e){var t;return t=$(e.currentTarget).closest(".line"),this.toggleContainerAbove(t)},i.prototype.toggleContainer=function(e){var t;return t=$(e.currentTarget).closest("[data-selected-lines-container]"),this.toggleLinesIn(t)},i.prototype.toggleLinesIn=function(e){var t,n,i,r,o,s;for(t=e.find("[data-select-lines]").is(":checked"),o=e.find("[data-select-line]"),s=[],i=0,r=o.length;r>i;i++)n=o[i],s.push($(n).prop("checked",t));return s},i.prototype.toggleContainerAbove=function(e){var t;return t=e.closest("[data-selected-lines-container]"),t.find("[data-select-line]:not(:checked)").length?t.find("[data-select-lines]").prop("checked",!1):t.find("[data-select-lines]").prop("checked",!0)},i.prototype.focusLines=function(e){return $(e.currentTarget).closest(".emboss").addClass("focus-thin")},i.prototype.blurLines=function(e){return $(e.currentTarget).closest(".emboss").removeClass("focus-thin")},i.prototype.update=function(){var e,t;return t=$("[data-select-line]:checked").closest(".line"),this.store(t),null!=(e=this.markVisitLinesController)&&e.update(App.LineSelectionController.selected),this.lineSelectionCounter.html(t.length),t.length?this.enable():this.disable(),this.storeIds()},i.prototype.store=function(e){var t;return t=_.flatten(_.map(e,function(e){var t;return null!=(t=$(e).data("ids"))?t:[$(e).data("id")]})),App.LineSelectionController.selected=t},i.prototype.restore=function(){var e,t,n,i,r,o,s,a;for(o=$("[data-select-line]"),n=0,i=o.length;i>n;n++)t=o[n],t=$(t),r=t.closest(".line"),e=null!=(s=$(r).data("ids"))?s:[$(r).data("id")],e.length&&_.all(e,function(e){return _.include(App.LineSelectionController.selected,e)})&&(t.prop("checked",!0),this.toggleContainerAbove(r));return e=App.LineSelectionController.selected,null!=(a=this.markVisitLinesController)&&a.update(App.LineSelectionController.selected),this.lineSelectionCounter.html(e.length),e.length?this.enable():this.disable(),this.storeIds()},i.prototype.enable=function(){var e,t,n,i,r;for(i=$(".button[data-selection-enabled]"),r=[],t=0,n=i.length;n>t;t++)e=i[t],r.push(App.Button.enable($(e)));return r},i.prototype.disable=function(){var e,t,n,i,r;for(i=$(".button[data-selection-enabled]"),r=[],t=0,n=i.length;n>t;t++)e=i[t],r.push(App.Button.disable($(e)));return r},i.prototype.storeIds=function(){return this.storeIdsToHrefs(),this.storeIdsToInputValues()},i.prototype.storeIdsToHrefs=function(){var e,t,n,i,r,o;for(i=$("a[data-update-href]"),r=[],e=0,t=i.length;t>e;e++)n=i[e],n=$(n),o=URI(n.attr("href")).removeQuery("ids[]").addQuery("ids[]",App.LineSelectionController.selected),r.push(n.attr("href",o.toString()));return r},i.prototype.storeIdsToInputValues=function(){var e,t,n,i,r,o;for(this.el.find("[data-input-fields-container]").remove(),this.el.find("[data-insert-before]").before("<div data-input-fields-container></div>"),e=this.el.find("[data-input-fields-container]"),r=App.LineSelectionController.selected,o=[],n=0,i=r.length;i>n;n++)t=r[n],o.push(e.append("<input type='hidden' name='ids[]' data-store-id value='"+t+"'>"));return o},i.add=function(e){return _.find(i.selected,function(t){return t===e})?void 0:(i.selected.push(e),i.Singleton.restore())},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ListFiltersController=function(n){function i(){return this.getData=e(this.getData,this),this.reset=e(this.reset,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.events={change:"reset"},i.prototype.reset=function(){return this.reset()},i.prototype.getData=function(){var e,t,n,i,r;for(e={},r=$(":visible",this.el).serializeArray(),n=0,i=r.length;i>n;n++)t=r[n],t.value.length&&"0"!==t.value&&(e[t.name]=t.value);return e},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ListPaginationController=function(n){function i(){return this.inview=e(this.inview,this),this.renderPlaceholders=e(this.renderPlaceholders,this),this.totalPages=e(this.totalPages,this),this.set=e(this.set,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.events={"inview .page:not(.fetched)":"inview"},i.prototype.set=function(e){return this.totalCount=e.total_count,this.perPage=e.per_page},i.prototype.totalPages=function(){return Math.ceil(this.totalCount/this.perPage)},i.prototype.renderPlaceholders=function(){var e;return e=this.totalPages()-1,e>0?_.each(_.range(1,e+1),function(e){return function(t){var n;return t+=1,n=$(App.Render("manage/views/lists/page",t,{entries:_.range(e.perPage),page:t})),e.el.append(n)}}(this)):void 0},i.prototype.inview=function(e){var t;return t=$(e.currentTarget),t.addClass("fetched"),this.fetch(t.data("page"),t)},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ListRangeController=function(n){function i(){this.getBeforeLastCheck=e(this.getBeforeLastCheck,this),this.getEndDate=e(this.getEndDate,this),this.getStartDate=e(this.getStartDate,this),this.get=e(this.get,this),this.setupInputs=e(this.setupInputs,this),i.__super__.constructor.apply(this,arguments),this.setupInputs()}return t(i,n),i.prototype.elements={"input[name='start_date']":"startDate","input[name='end_date']":"endDate","input[name='before_last_check']":"beforeLastCheck"},i.prototype.events={"change input[name='start_date']":"reset","change input[name='end_date']":"reset","change input[name='before_last_check']":"reset"},i.prototype.setupInputs=function(){var e,t,n,i,r;for(i=[this.startDate,this.endDate,this.beforeLastCheck],r=[],e=0,n=i.length;n>e;e++)t=i[e],$(t).length?($(t).val().length&&$(t).val(moment($(t).val()).format(i18n.date.L)),r.push($(t).datepicker({dateFormat:i18n.datepicker.L}))):r.push(void 0);return r},i.prototype.get=function(){var e;return e={},null!=this.getStartDate()&&(e.start_date=this.getStartDate().format("YYYY-MM-DD")),null!=this.getEndDate()&&(e.end_date=this.getEndDate().format("YYYY-MM-DD")),null!=this.getBeforeLastCheck()&&(e.before_last_check=this.getBeforeLastCheck().format("YYYY-MM-DD")),e},i.prototype.getStartDate=function(){return""!==this.startDate.val()?moment(this.startDate.val(),i18n.date.L):void 0},i.prototype.getEndDate=function(){return""!==this.endDate.val()?moment(this.endDate.val(),i18n.date.L):void 0},i.prototype.getBeforeLastCheck=function(){return""!==this.beforeLastCheck.val()?moment(this.beforeLastCheck.val(),i18n.date.L):void 0},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ListSearchController=function(n){function i(){this.term=e(this.term,this),this.search=e(this.search,this),i.__super__.constructor.apply(this,arguments),this.el.preChange()}return t(i,n),i.prototype.events={change:"search",preChange:"search"},i.prototype.search=function(){return this.currentSearch!==this.term()&&this.reset(),this.currentSearch=this.term()},i.prototype.term=function(){return this.el.val().length?this.el.val():null},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ListTabsController=function(n){function i(){this.getData=e(this.getData,this),this["switch"]=e(this["switch"],this),i.__super__.constructor.apply(this,arguments),this.data=this.el.find(".active").data()}return t(i,n),i.prototype.events={"click .inline-tab-item":"switch"},i.prototype["switch"]=function(e){var t;return t=$(e.currentTarget),this.data=t.data(),this.el.find(".inline-tab-item.active").removeClass("active"),t.addClass("active"),this.reset()},i.prototype.getData=function(){return _.clone(this.data)},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ManageUsersViaAutocompleteController=function(n){function i(){this.select=e(this.select,this),this.setupAutocomplete=e(this.setupAutocomplete,this),this.fetchUsers=e(this.fetchUsers,this),this.search=e(this.search,this),i.__super__.constructor.apply(this,arguments),this.input.preChange()}return t(i,n),i.prototype.elements={"input[data-search-users]":"input","[data-users-list]":"usersList"},i.prototype.events={"preChange input[data-search-users]":"search","click [data-remove-user]":"removeHandler"},i.prototype.search=function(){return this.input.val().length?this.fetchUsers().done(function(e){return function(t){var n;return e.setupAutocomplete(function(){var e,i,r;for(r=[],e=0,i=t.length;i>e;e++)n=t[e],r.push(App.User.find(n.id));return r}())}}(this)):!1},i.prototype.fetchUsers=function(){var e;return e={search_term:this.input.val(),per_page:5},$.extend(e,this.fetchUsersParams),App.User.ajaxFetch({data:$.param(e)})},i.prototype.setupAutocomplete=function(e){return this.input.autocomplete({source:function(t){return function(t,n){return n(e)}}(this),focus:function(e){return function(){return!1}}(this),select:this.select}).data("uiAutocomplete")._renderItem=function(e){return function(e,t){return $(App.Render("manage/views/templates/users/autocomplete_element",t)).data("value",t).appendTo(e)}}(this),this.input.autocomplete("search")},i.prototype.select=function(e,t){var n;return n=this.usersList.find("input[value='"+t.item.id+"']").closest(".line"),n.length?this.usersList.prepend(n):this.usersList.prepend(App.Render("manage/views/templates/users/user_inline_entry",App.User.find(t.item.id),{paramName:this.paramName}))},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.MarkVisitLinesController=function(n){function i(){return this.markSelectedLines=e(this.markSelectedLines,this),this.unmarkAllLines=e(this.unmarkAllLines,this),this.update=e(this.update,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.update=function(e){return this.unmarkAllLines(),this.markSelectedLines(e)},i.prototype.unmarkAllLines=function(){var e,t,n,i,r;for(i=this.el.find(".line[data-id]"),r=[],e=0,t=i.length;t>e;e++)n=i[e],r.push($(n).removeClass("green").addClass("light"));return r},i.prototype.markSelectedLines=function(e){var t,n,i,r,o,s,a;for(a=[],i=0,o=e.length;o>i;i++)r=e[i],n=App.Reservation.find(r),n.item()?(s=this.el.find(".line[data-id='"+r+"']"),a.push(s.removeClass("light").addClass("green"))):n.option()?(s=this.el.find(".line[data-id='"+r+"']"),t=n.status,"approved"===t?Number(s.find("input[data-line-quantity]").val())>=1?a.push(s.removeClass("light").addClass("green")):a.push(void 0):"signed"===t&&Number(s.find("input[data-quantity-returned]").val())===n.quantity?a.push(s.removeClass("light").addClass("green")):a.push(void 0)):a.push(void 0);return a},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.TimeLineController=function(n){function i(){return this.onload=e(this.onload,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.events={"click [data-open-time-line]":"show"},i.prototype.show=function(e){var t,n,i,r;return r=$(e.currentTarget),t=r.data("model-id"),n=App.Model.exists(t)||App.Software.find(t),i=App.Render("manage/views/models/timeline_modal",n),this.modal=new App.Modal(i),this.modal.el.find("iframe").load(this.onload)},i.prototype.onload=function(){return this.modal.el.find("#loading").remove()},i}(Spine.Controller)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;window.App.TemplateController=function(t){function n(){n.__super__.constructor.apply(this,arguments),new App.TemplateModelsController({el:this.el.find("#models")}),new App.InlineEntryRemoveController({el:this.el})}return e(n,t),n}(Spine.Controller)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;window.App.TemplateEditController=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n}(App.TemplateController)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.TemplateModelsController=function(n){function i(){this.select=e(this.select,this),this.setupAutocomplete=e(this.setupAutocomplete,this),this.fetchModels=e(this.fetchModels,this),this.search=e(this.search,this),i.__super__.constructor.apply(this,arguments),this.input.preChange()}return t(i,n),i.prototype.elements={"input[data-search-models]":"input","[data-models-list]":"modelsList"},i.prototype.events={"preChange input[data-search-models]":"search"},i.prototype.search=function(){return this.input.val().length?this.fetchModels().done(function(e){return function(t){var n;return e.setupAutocomplete(function(){var e,i,r;for(r=[],e=0,i=t.length;i>e;e++)n=t[e],r.push(App.Model.find(n.id));return r}())}}(this)):!1},i.prototype.fetchModels=function(){return App.Model.ajaxFetch({data:$.param({search_term:this.input.val(),borrowable:!0,per_page:5})})},i.prototype.setupAutocomplete=function(e){return this.input.autocomplete({source:function(t){return function(t,n){return n(e)}}(this),focus:function(e){return function(){return!1}}(this),select:this.select}).data("uiAutocomplete")._renderItem=function(e){return function(e,t){return $(App.Render("manage/views/templates/models/autocomplete_element",t)).data("value",t).appendTo(e)}}(this),this.input.autocomplete("search")},i.prototype.select=function(e,t){return App.Availability.ajaxFetch({url:App.Availability.url()+"/in_stock",data:$.param({model_ids:t.item.id})}).done(function(e){return function(n){return _.any(e.modelsList.find("input[name*='model_id']"),function(e){return Number($(e).val())===Number(t.item.id)})?void 0:e.modelsList.prepend(App.Render("manage/views/templates/models/model_allocation_entry",App.Model.find(t.item.id),{currentInventoryPool:App.InventoryPool.current}))}}(this))},i}(Spine.Controller)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;window.App.TemplateNewController=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n}(App.TemplateController)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.TopBarController=function(n){function i(){return this.checkStartScreenState=e(this.checkStartScreenState,this),this.changeStartScreen=e(this.changeStartScreen,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.events={"change #start_screen_checkbox":"changeStartScreen"},i.prototype.elements={"#start_screen_checkbox":"startScreenCheckbox"},i.prototype.changeStartScreen=function(){var e;return e=window.location.pathname+window.location.search+window.location.hash,this.startScreenCheckbox.is(":checked")?App.User.current.setStartScreen(e):App.User.current.setStartScreen(null)},i.prototype.checkStartScreenState=function(){var e;return e=window.location.pathname+window.location.search+window.location.hash,App.User.current.start_screen===e?this.startScreenCheckbox.prop("checked",!0):this.startScreenCheckbox.prop("checked",!1)},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.ChangeUserGroupsController=function(n){function i(){this.select=e(this.select,this),this.setupAutocomplete=e(this.setupAutocomplete,this),this.searchGroups=e(this.searchGroups,this),this.search=e(this.search,this),i.__super__.constructor.apply(this,arguments),this.input.preChange()}return t(i,n),i.prototype.elements={"input[name='name']":"input","[data-group-list]":"groupList"},i.prototype.events={"focus input[name='name']":"search","preChange input[name='name']":"search","click [data-remove-group]":"removeGroup"},i.prototype.search=function(){return this.searchGroups().done(function(e){return function(t){var n;return e.setupAutocomplete(function(){var e,i,r;for(r=[],e=0,i=t.length;i>e;e++)n=t[e],r.push(App.Group.find(n.id));return r}())}}(this))},i.prototype.searchGroups=function(){return App.Group.ajaxFetch({data:$.param({search_term:this.input.val()})})},i.prototype.setupAutocomplete=function(e){return this.input.autocomplete({source:function(t){return function(t,n){return n(e)}}(this),focus:function(e){return function(){return!1}}(this),select:this.select,minLength:0}).data("uiAutocomplete")._renderItem=function(e){return function(e,t){return $(App.Render("manage/views/groups/autocomplete_element",t)).data("value",t).appendTo(e)}}(this),this.input.autocomplete("search")},i.prototype.select=function(e,t){return this.groupList.append(App.Render("manage/views/groups/group_entry",t.item))},i.prototype.removeGroup=function(e){return e.preventDefault(),$(e.currentTarget).closest(".line").remove()},i}(Spine.Controller)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;window.App.DelegationController=function(t){function n(){n.__super__.constructor.apply(this,arguments),new App.ManageUsersViaAutocompleteController({el:this.el.find("#users"),removeHandler:this.removeUserHandler,paramName:"user[users][][id]",fetchUsersParams:{type:"user"}})}return e(n,t),n.removeHandler=function(e){return e.preventDefault(),$(e.currentTarget).closest(".line").remove()},n.prototype.removeUserHandler=n.removeHandler,n}(Spine.Controller)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;window.App.DelegationEditController=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.include(App.Modules.InlineEntryHandlers),n.prototype.removeUserHandler=n.prototype.strikeRemoveUserHandler,n}(App.DelegationController)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.UserCellTooltipController=function(n){function i(){return this.onEnter=e(this.onEnter,this),i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.events={"mouseenter [data-type='user-cell']":"onEnter"},i.prototype.onEnter=function(e){var t;return t=$(e.currentTarget),new App.Tooltip({el:t.closest("[data-type='user-cell']"),content:App.Render("manage/views/users/tooltip",App.User.findOrBuild(t.data()))})},i}(Spine.Controller)}.call(this),function(){var e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},t={}.hasOwnProperty;window.App.UserController=function(t){function n(){n.__super__.constructor.apply(this,arguments),new App.ChangeUserGroupsController({el:this.el.find("#change-groups")}),new App.UserSuspendedUntilController({el:this.el})}return e(n,t),n}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;window.App.UserSuspendedUntilController=function(n){function i(){this.hideSuspendedReason=e(this.hideSuspendedReason,this),this.showSuspendedReason=e(this.showSuspendedReason,this),this.toggleSuspendedReason=e(this.toggleSuspendedReason,this),i.__super__.constructor.apply(this,arguments),this.input.datepicker()}return t(i,n),i.prototype.elements={"input[data-suspended-until-input]":"input","#suspended-reason":"suspendedReason"},i.prototype.events={"change input[data-suspended-until-input]":"toggleSuspendedReason"},i.prototype.toggleSuspendedReason=function(){return _.isEmpty(this.input.val())?this.hideSuspendedReason():this.showSuspendedReason()},i.prototype.showSuspendedReason=function(){return this.suspendedReason.removeClass("hidden")},i.prototype.hideSuspendedReason=function(){return this.suspendedReason.addClass("hidden")},i}(Spine.Controller)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function i(){this.constructor=e}for(var r in t)n.call(t,r)&&(e[r]=t[r]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e},n={}.hasOwnProperty;
window.App.UsersIndexController=function(n){function i(t){this.render=e(this.render,this),this.fetchAccessRights=e(this.fetchAccessRights,this),this.fetchUsers=e(this.fetchUsers,this),this.fetch=e(this.fetch,this),this.reset=e(this.reset,this),i.__super__.constructor.apply(this,arguments),this.users={},new App.UserCellTooltipController({el:this.list}),this.pagination=new App.ListPaginationController({el:this.list,fetch:this.fetch}),this.search=new App.ListSearchController({el:this.el.find("#list-search"),reset:this.reset}),this.filter=new App.ListFiltersController({el:this.el.find("#list-filters"),reset:this.reset}),this.reset()}return t(i,n),i.prototype.elements={"#user-list":"list"},i.prototype.reset=function(){return this.users={},this.list.html(App.Render("manage/views/lists/loading")),this.fetch(1,this.list)},i.prototype.fetch=function(e,t){return this.fetchUsers(e).done(function(n){return function(){return n.fetchAccessRights(e).done(function(){return n.render(t,n.users[e],e)})}}(this))},i.prototype.fetchUsers=function(e){return App.User.ajaxFetch({data:$.param($.extend(this.filter.getData(),{page:e,search_term:this.search.term(),role:this.role,all:_.isEmpty(this.role)?!0:void 0}))}).done(function(t){return function(n,i,r){var o,s;return t.pagination.set(JSON.parse(r.getResponseHeader("X-Pagination"))),s=function(){var e,t,i;for(i=[],e=0,t=n.length;t>e;e++)o=n[e],i.push(App.User.find(o.id));return i}(),t.users[e]=s,App.User.fetchDelegators(s)}}(this))},i.prototype.fetchAccessRights=function(e){var t;return t=_.map(this.users[e],function(e){return e.id}),t.length?App.AccessRight.ajaxFetch({data:$.param({user_ids:t})}):{done:function(e){return e()}}},i.prototype.render=function(e,t,n){return e.html(App.Render("manage/views/users/line",t,{currentInventoryPool:App.InventoryPool.current})),1===n?this.pagination.renderPlaceholders():void 0},i}(Spine.Controller)}.call(this),function(e){e.views.templates("manage/views/availabilities/loaded","<div class='emboss padding-inset-s'>\n<p class='paragraph-s'>\n<i class='fa fa-check margin-right-m'></i>\n{{jed \"Availability loaded\"/}}\n</p>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/availabilities/loading","<div class='emboss blue padding-inset-s'>\n<p class='paragraph-s'>\n<img class='margin-right-s max-width-micro' src='/assets/loading-5ed385f71ca1eb04ca01faecb9f7973d.gif'>\n<strong>{{jed \"Loading availability\"/}}</strong>\n</p>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/booking_calendar/calendar_dialog","<div class='modal fade ui-modal medium' role='dialog' tabindex='-1'>\n<div class='modal-header row'>\n<div class='col3of5'>\n<h2 class='headline-l'>{{jed \"Edit reservation\"/}}</h2>\n<h3 class='headline-m'>\n{{>user.firstname}}\n{{>user.lastname}}\n</h3>\n</div>\n<div class='col2of5 text-align-right'>\n<div class='modal-close'>{{jed \"Cancel\"/}}</div>\n<button class='button green' disabled='disabled' id='submit-booking-calendar'>{{jed \"Save\"/}}</button>\n</div>\n</div>\n<div id='booking-calendar-errors'></div>\n<div class='modal-body'>\n<form class='padding-inset-m'>\n<div class='hidden' id='booking-calendar-controls'>\n<div class='col5of8 float-right'>\n<div class='row grey padding-bottom-xxs'>\n<div class='col1of2'>\n<div class='col1of2 padding-right-xs text-align-left'>\n<div class='row {{if ~startDateDisabled}} hidden{{/if}}'>\n<span>{{jed \"Startdate\"/}}</span>\n<a class='grey fa fa-eye position-absolute-right padding-right-xxs' id='jump-to-start-date'></a>\n</div>\n</div>\n<div class='col1of2 padding-right-xs text-align-left'>\n<div class='row'>\n<span>{{jed \"Enddate\"/}}</span>\n<a class='grey fa fa-eye position-absolute-right padding-right-xxs' id='jump-to-end-date'></a>\n</div>\n</div>\n</div>\n<div class='col1of2'>\n<div class='col2of8 text-align-left'>{{jed \"Quantity\"/}}</div>\n<div class='col6of8 padding-left-xs text-align-left'>{{jed \"Availability\"/}}</div>\n</div>\n</div>\n<div class='row'>\n<div class='col1of2'>\n<div class='col1of2 padding-right-xs'>\n<div class='row {{if ~startDateDisabled}} hidden{{/if}}'>\n<input autocomplete='off' id='booking-calendar-start-date' type='text'>\n</div>\n</div>\n<div class='col1of2 padding-right-xs'>\n<input autocomplete='off' id='booking-calendar-end-date' type='text'>\n</div>\n</div>\n<div class='col1of2'>\n<div class='col2of8'>\n{{if ~quantityDisabled}}\n<input autocomplete='off' class='text-align-center' disabled='disabled' id='booking-calendar-quantity' type='text' value='1'>\n{{else}}\n<input autocomplete='off' class='text-align-center' id='booking-calendar-quantity' type='text' value='1'>\n{{/if}}\n</div>\n<div class='col6of8 padding-left-xs'>\n<select class='width-full' id='booking-calendar-partitions'></select>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class='booking-calendar padding-top-xs' id='booking-calendar'></div>\n<img class='loading margin-horziontal-auto margin-vertical-xl' src='/assets/loading-5ed385f71ca1eb04ca01faecb9f7973d.gif'>\n</form>\n<div id='booking-calendar-lines'>\n<div class='list-of-lines separated-top'></div>\n</div>\n</div>\n<div class='modal-footer'></div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/booking_calendar/line","<div class='line row'>\n{{if model().availability}}\n<div class='line-info{{if model().availability().withoutLines([#view.data]).maxAvailableForGroups(~start_date, ~end_date, ~groupIds) < (~quantity||quantity)}} red{{/if}}'></div>\n{{/if}}\n<div class='col1of10 line-col text-align-center'>\n<span>\n{{if ~quantity}}\n{{>~quantity}}\n{{else subreservations}}\n{{sum subreservations \"quantity\"/}}\n{{else}}\n{{>quantity}}\n{{/if}}\n</span>\n{{if model().availability}}\n<span class='grey-text'>\n/\n{{if subreservations}}\n{{>model().availability().withoutLines(subreservations).maxAvailableForGroups(~start_date, ~end_date, ~groupIds)}}\n{{else}}\n{{>model().availability().withoutLines([#view.data]).maxAvailableForGroups(~start_date, ~end_date, ~groupIds)}}\n{{/if}}\n</span>\n{{/if}}\n</div>\n<div class='col5of10 line-col text-align-left'>\n<strong>{{>model().name()}}</strong>\n</div>\n<div class='col4of10 line-col'>\n{{if model().availability}}\n{{for model().availability().withoutLines([#view.data]).unavailableRanges((~quantity||quantity), ~groupIds, ~start_date, ~end_date)}}\n<strong class='darkred-text'>{{date startDate/}}-{{date endDate/}}</strong>\n{{/for}}\n{{/if}}\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/booking_calendar/partitions","<option data-value='[{{>user}}]'>{{jed \"Borrower\"/}}</option>\n{{if userGroups.length}}\n<optgroup label='{{jed 'Groups of this customer'/}}'>\n{{for userGroups}}\n<option data-value='[{{>id}}]'>{{>name}}</option>\n{{/for}}\n</optgroup>\n{{/if}}\n{{if otherGroups.length}}\n<optgroup label='{{jed 'Other groups'/}}'>\n{{for otherGroups}}\n<option data-value='[{{>id}}]'>{{>name}}</option>\n{{/for}}\n</optgroup>\n{{/if}}\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/categories/category_link_inline_entry","<div class='row line font-size-xs focus-hover-thin' data-new data-type='inline-entry'>\n<input name='category[links][{{>~uid}}][parent_id]' type='hidden' value='{{>id}}'>\n<div class='line-col col3of10 text-align-left'>\n{{>name}}\n</div>\n<div class='line-col col1of10 text-align-center' title='{{jed 'Subordinate to %s' name/}}'>\n<i class='fa fa-sitemap'></i>\n</div>\n<div class='line-col col3of10 text-align-left'>\n<input autocomplete='off' class='small width-full' name='category[links][{{>~uid}}][label]' placeholder='{{jed 'Label'/}}' type='text' value='{{>~label}}'>\n</div>\n<div class='line-col col3of10 text-align-right'>\n<button class='button small inset' data-remove>\n{{jed 'Remove'/}}\n</button>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/categories/filter_list_current","<a class='emboss links black row focus-hover-thin font-size-m padding-horizontal-s padding-vertical-xs round-border-on-hover' data-id='{{>id}}' data-type='category-current'>\n<i class='arrow left'></i>\n{{>name}}\n</a>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/categories/filter_list_entry","<a class='links black row focus-hover-thin font-size-m padding-horizontal-s padding-vertical-xs round-border-on-hover' data-id='{{>id}}' data-type='category-filter'>\n{{>name}}\n</a>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/categories/filter_list_root","<a class='emboss links black row focus-hover-thin font-size-m padding-horizontal-s padding-vertical-xs round-border-on-hover' data-id='{{>id}}' data-type='category-root'>\n<strong>{{>name}}</strong>\n</a>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/categories/filter_list_search","<a class='emboss links black row focus-hover-thin font-size-m padding-horizontal-s padding-vertical-xs round-border-on-hover' data-id='{{>id}}' data-type='category-search'>\n<strong>\n<i class='fa fa-search icon-xxs vertical-align-top'></i>\n{{>search_term}}\n</strong>\n</a>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/categories/line","<div class='row line' data-id='{{>id}}' data-parent>\n<div class='col1of9 line-col'>\n{{if children().length}}\n<button class='button inset small min-width-xs' data-type='expander'>\n<i class='arrow right'></i>\n<span>\n{{>children().length}}\n</span>\n</button>\n{{/if}}\n</div>\n<div class='col3of9 line-col text-align-left'>\n<strong>\n{{>name}}\n</strong>\n</div>\n<div class='col2of9 line-col'>\n{{if !is_used()}}\n<strong class='darkred-text'>\n{{jed \"not used\"/}}\n</strong>\n{{/if}}\n</div>\n<div class='col3of9 line-col line-actions'>\n{{if is_used()}}\n<a class='button white' href='{{>url('edit')}}'>\n{{jed \"Edit\"/}}\n</a>\n{{else}}\n<div class='multibutton'>\n<a class='button white' href='{{>url('edit')}}'>\n{{jed \"Edit\"/}}\n</a>\n<div class='dropdown-holder inline-block'>\n<div class='button white dropdown-toggle'>\n<div class='arrow down'></div>\n</div>\n<ul class='dropdown right'>\n<li>\n<a class='dropdown-item red' data-method='delete' href='{{>url()}}'>\n<i class='fa fa-trash'></i>\n{{jed \"Delete\"/}}\n</a>\n</li>\n</ul>\n</div>\n</div>\n{{/if}}\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/contracts/approval_failed_modal","<div class='modal medium hide fade ui-modal padding-inset-m padding-horizontal-l' role='dialog' tabindex='-1'>\n<form>\n<div class='row padding-vertical-m'>\n<div class='col1of2'>\n<h3 class='headline-l'>{{jed \"Approval failed\"/}}</h3>\n<h3 class='headline-s light'>\n{{>user().firstname}}\n{{>user().lastname}}\n</h3>\n</div>\n<div class='col1of2'>\n<div class='float-right'>\n<a aria-hidden='true' class='modal-close weak' data-dismiss='modal' title='{{jed \"close dialog\"/}}' type='button'>\n{{jed \"Cancel\"/}}\n</a>\n{{if ~accessRight.atLeastRole(~currentUserRole, \"lending_manager\") }}\n<div class='multibutton'>\n<a class='button white text-ellipsis' href='/manage/{{current_inventory_pool_id/}}/contracts/{{>id}}/edit'>\n{{jed \"Edit Order\"/}}\n</a>\n<div class='dropdown-holder inline-block'>\n<div class='button white dropdown-toggle'>\n<div class='arrow down'></div>\n</div>\n<ul class='dropdown right'>\n<li>\n<a class='dropdown-item' data-approve-anyway>\n<i class='fa fa-thumbs-up'></i>\n{{jed \"Approve anyway\"/}}\n</a>\n</li>\n</ul>\n</div>\n</div>\n{{else}}\n<a class='button white text-ellipsis' href='/manage/{{current_inventory_pool_id/}}/contracts/{{>id}}/edit'>\n{{jed \"Edit Order\"/}}\n</a>\n{{/if}}\n</div>\n</div>\n</div>\n<div class='row margin-top-m'>\n<div class='separated-bottom padding-bottom-m margin-bottom-m'>\n<div class='row margin-bottom-s emboss red padding-inset-s'>\n<p class='paragraph-s'>\n<strong>{{>error}}</strong>\n</p>\n</div>\n</div>\n<div class='modal-body'>\n{{for groupedLinesByDateRange(true)}}\n<div class='padding-bottom-m margin-bottom-m no-last-child-margin'>\n<div class='row margin-bottom-s'>\n<div class='col1of2'>\n<p>\n{{date start_date/}}\n-\n{{date end_date/}}\n</p>\n</div>\n<div class='col1of2 text-align-right'>\n<strong>{{diffDatesInDays start_date end_date/}}</strong>\n</div>\n</div>\n{{for reservations}}\n<div class='row'>\n<div class='col1of8 text-align-center'>\n<div class='paragraph-s'>\n{{if subreservations}}\n{{sum subreservations \"quantity\"/}}\n{{else}}\n{{> quantity}}\n{{/if}}\n</div>\n</div>\n<div class='col7of8'>\n<div class='paragraph-s'>\n<strong>{{>model().name()}}</strong>\n</div>\n</div>\n</div>\n{{/for}}\n</div>\n{{/for}}\n</div>\n</div>\n<div class='row separated-top padding-top-m'>\n<div class='col1of1 padding-bottom-s'>\n<p>{{jed \"Write a comment... (your comment will be part of the confirmation e-mail)\"/}}</p>\n</div>\n<textarea autofocus='autofocus' class='col1of1 height-s' id='comment' name='comment'>{{>~comment}}</textarea>\n</div>\n</form>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/contracts/approve_with_comment_modal","<div class='modal medium hide fade ui-modal padding-inset-m padding-horizontal-l' role='dialog' tabindex='-1'>\n<div class='row padding-vertical-m'>\n<div class='col1of2'>\n<h3 class='headline-l'>{{jed \"Approve order\"/}}</h3>\n<h3 class='headline-s light'>\n{{>user().firstname}}\n{{>user().lastname}}\n</h3>\n</div>\n<div class='col1of2'>\n<div class='float-right'>\n<a aria-hidden='true' class='modal-close weak' data-dismiss='modal' title='{{jed \"close dialog\"/}}' type='button'>\n{{jed \"Cancel\"/}}\n</a>\n<button class='button green text-ellipsis' data-id='{{>id}}' data-order-approve>\n<i class='fa fa-thumbs-up'></i>\n{{jed \"Approve\"/}}\n</button>\n</div>\n</div>\n</div>\n<div class='row margin-top-m'>\n<div class='modal-body'>\n{{for groupedLinesByDateRange(true)}}\n<div class='padding-bottom-m margin-bottom-m no-last-child-margin'>\n<div class='row margin-bottom-s'>\n<div class='col1of2'>\n<p>\n{{date start_date/}}\n-\n{{date end_date/}}\n</p>\n</div>\n<div class='col1of2 text-align-right'>\n<strong>{{diffDatesInDays start_date end_date/}}</strong>\n</div>\n</div>\n{{for reservations}}\n<div class='row'>\n<div class='col1of8 text-align-center'>\n<div class='paragraph-s'>\n{{if subreservations}}\n{{sum subreservations \"quantity\"/}}\n{{else}}\n{{> quantity}}\n{{/if}}\n</div>\n</div>\n<div class='col7of8'>\n<div class='paragraph-s'>\n<strong>{{>model().name()}}</strong>\n</div>\n</div>\n</div>\n{{/for}}\n</div>\n{{/for}}\n</div>\n</div>\n<div class='row separated-top padding-top-m'>\n<div class='col1of1 padding-bottom-s'>\n<p>{{jed \"Write a comment... (your comment will be part of the confirmation e-mail)\"/}}</p>\n</div>\n<textarea autofocus='autofocus' class='col1of1 height-s' id='comment' name='comment'></textarea>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/contracts/approved_button","<div class='padding-inset-s inline-block' title='{{jed 'Order approved'/}}'>\n<i class='fa fa-thumbs-up'></i>\n</div>\n<a class='button white' href='{{>url('hand_over')}}'>\n<i class='fa fa-mail-forward'></i>\n{{jed 'Hand Over'/}}\n</a>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/contracts/edit/contact_person","<div class='row padding-vertical-m' id='contact-person'>\n<div class='row emboss padding-inset-m'>\n<div class='col4of9 text-align-center' id='swapped-person'>\n<input autocomplete='off' class='width-m' id='user-id' placeholder='{{jed 'Contact person'/}} {{jed 'Name / ID'/}}' type='text'>\n<div id='selected-user'></div>\n</div>\n<div class='col1of9 text-align-center'>\n<i class='fa fa-exchange icon-xxl'></i>\n</div>\n<div class='col4of9 text-align-center'>\n{{if delegatedUser()}}\n<p class='paragraph-s padding-top-xxs margin-top-xxs'>\n<strong>\n{{>delegatedUser().firstname}}\n{{>delegatedUser().lastname}}\n</strong>\n</p>\n{{/if}}\n</div>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/contracts/edit/purpose_modal","<div class='modal medium hide fade ui-modal padding-inset-m padding-horizontal-l' role='dialog' tabindex='-1'>\n<form>\n<div class='row padding-vertical-m'>\n<div class='col1of2'>\n<h3 class='headline-l'>{{jed \"Edit Purpose\"/}}</h3>\n</div>\n<div class='col1of2'>\n<div class='float-right'>\n<a aria-hidden='true' class='modal-close weak' data-dismiss='modal' title='{{jed \"close dialog\"/}}' type='button'>\n{{jed \"Cancel\"/}}\n</a>\n<button class='button white text-ellipsis' type='submit'>\n{{jed \"Save\"/}}\n</button>\n</div>\n</div>\n</div>\n<div class='padding-vertical-m hidden' id='errors'>\n<div class='row emboss red text-align-center font-size-m padding-inset-s'>\n<strong></strong>\n</div>\n</div>\n<div class='row padding-top-m'>\n<textarea autofocus='autofocus' class='col1of1 height-s' name='purpose'>{{>description}}</textarea>\n</div>\n</form>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/contracts/edit/swap_user_modal","<div class='modal medium hide fade ui-modal padding-inset-m padding-horizontal-l' role='dialog' tabindex='-1'>\n<form>\n<div class='row padding-vertical-m'>\n<div class='col1of2'>\n<h3 class='headline-l'>{{jed \"Change orderer\"/}}</h3>\n</div>\n<div class='col1of2'>\n<div class='float-right'>\n<a aria-hidden='true' class='modal-close weak' data-dismiss='modal' title='{{jed \"close dialog\"/}}' type='button'>\n{{jed \"Cancel\"/}}\n</a>\n<button class='button white text-ellipsis' type='submit'>\n{{jed \"Change orderer\"/}}\n</button>\n</div>\n</div>\n</div>\n<div class='padding-vertical-m hidden' id='errors'>\n<div class='row emboss red text-align-center font-size-m padding-inset-s'>\n<strong></strong>\n</div>\n</div>\n<div class='row padding-vertical-m' id='user'>\n<div class='row emboss padding-inset-m'>\n<div class='col4of9 text-align-center' id='swapped-person'>\n<input autocomplete='off' autofocus='autofocus' class='width-m' data-barcode-scanner-target data-prevent-barcode-scanner-submit id='user-id' placeholder='{{jed 'Name / ID'/}}' type='text'>\n<div id='selected-user'></div>\n</div>\n<div class='col1of9 text-align-center'>\n<i class='fa fa-exchange icon-xxl'></i>\n</div>\n<div class='col4of9 text-align-center'>\n<p class='paragraph-s padding-top-xxs margin-top-xxs'>\n<strong>\n{{>user().firstname}}\n{{>user().lastname}}\n</strong>\n</p>\n</div>\n</div>\n</div>\n</form>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/contracts/edit/swapped_user","<div class='emboss white padding-inset-xxs'>\n<div class='row'>\n<p class='paragraph-s'>\n<strong>\n{{>firstname}}\n{{>lastname}}\n</strong>\n</p>\n<div class='position-absolute-topright padding-inset-xxs'>\n<a class='grey padding-inset-xxs' id='remove-user'>\n<i class='fa fa-times-circle icon-m'></i>\n</a>\n</div>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/contracts/line","<div class='line row focus-hover-thin' data-id='{{>id}}' data-type='contract'>\n{{include tmpl=\"manage/views/contracts/line_\"+status /}}\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/contracts/line_approved","{{partial 'manage/views/users/cell' user() '{\"grid\":\"col1of8\"}'/}}\n<div class='col1of8 line-col'>{{diffToday created_at/}}</div>\n<div class='col1of8 line-col text-align-center' data-type='lines-cell'>{{include tmpl='manage/views/reservations/cell'/}}</div>\n<div class='col1of8 line-col'>\n{{>getMaxRange()}}\n{{jed getMaxRange() \"day\" \"days\"/}}\n</div>\n<div class='col2of8 line-col text-align-left'>\n<strong>{{jed \"Approved\"/}}</strong>\n</div>\n<div class='col2of8 line-col line-actions'>\n<a class='button white text-ellipsis' href='{{>user().url('hand_over')}}'>\n{{if ~accessRight.atLeastRole(~currentUserRole, \"lending_manager\") }}\n<i class='fa fa-mail-forward'></i>\n{{jed \"Hand Over\"/}}\n{{else}}\n{{jed \"Edit\"/}}\n{{/if}}\n</a>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/contracts/line_closed","{{partial 'manage/views/users/cell' user() '{\"grid\":\"col1of8\"}'/}}\n<div class='col1of8 line-col'>{{diffToday created_at/}}</div>\n<div class='col1of8 line-col text-align-center' data-type='lines-cell'>{{include tmpl='manage/views/reservations/cell'/}}</div>\n<div class='col1of8 line-col'>\n{{>getMaxRange()}}\n{{jed getMaxRange() \"day\" \"days\"/}}\n</div>\n<div class='col2of8 line-col text-align-left'>\n<strong>{{jed \"Closed\"/}}</strong>\n{{jed \"Contract\"/}}\n{{>compact_id}}\n</div>\n<div class='col2of8 line-col line-actions'>\n<div class='multibutton'>\n<a class='button white text-ellipsis' href='{{>url()}}' target='_blank'>\n<i class='fa fa-file'></i>\n{{jed \"Contract\"/}}\n</a>\n<div class='dropdown-holder inline-block'>\n<div class='button white dropdown-toggle'>\n<div class='arrow down'></div>\n</div>\n<ul class='dropdown right'>\n<li>\n<a class='dropdown-item' href='{{>url('value_list')}}' target='_blank'>\n<i class='fa fa-list-ol'></i>\n{{jed \"Value List\"/}}\n</a>\n</li>\n<li>\n<a class='dropdown-item' href='{{>url('picking_list')}}' target='_blank'>\n<i class='fa fa-list-ol'></i>\n{{jed \"Picking List\"/}}\n</a>\n</li>\n</ul>\n</div>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/contracts/line_rejected","{{partial 'manage/views/users/cell' user() '{\"grid\":\"col1of8\"}'/}}\n<div class='col1of8 line-col'>{{diffToday created_at/}}</div>\n<div class='col1of8 line-col text-align-center' data-type='lines-cell'>{{include tmpl='manage/views/reservations/cell'/}}</div>\n<div class='col1of8 line-col'>\n{{>getMaxRange()}}\n{{jed getMaxRange() \"day\" \"days\"/}}\n</div>\n<div class='col2of8 line-col text-align-left'>\n<strong>{{jed \"Rejected\"/}}</strong>\n</div>\n<div class='col2of8 line-col line-actions'></div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/contracts/line_signed","{{partial 'manage/views/users/cell' user() '{\"grid\":\"col1of8\"}'/}}\n<div class='col1of8 line-col'>{{diffToday created_at/}}</div>\n<div class='col1of8 line-col text-align-center' data-type='lines-cell'>{{include tmpl='manage/views/reservations/cell'/}}</div>\n<div class='col1of8 line-col'>\n{{>getMaxRange()}}\n{{jed getMaxRange() \"day\" \"days\"/}}\n</div>\n<div class='col2of8 line-col text-align-left'>\n<strong>{{jed \"Signed\"/}}</strong>\n{{jed \"Contract\"/}}\n{{>compact_id}}\n</div>\n<div class='col2of8 line-col line-actions'>\n<div class='multibutton'>\n{{if ~accessRight.atLeastRole(~currentUserRole, \"lending_manager\") }}\n<a class='button white text-ellipsis' href='{{>user().url('take_back')}}'>\n<i class='fa fa-mail-reply'></i>\n{{jed \"Take Back\"/}}\n</a>\n<div class='dropdown-holder inline-block'>\n<div class='button white dropdown-toggle'>\n<div class='arrow down'></div>\n</div>\n<ul class='dropdown right'>\n<li>\n<a class='dropdown-item' href='{{>url()}}' target='_blank'>\n<i class='fa fa-file-alt'></i>\n{{jed \"Contract\"/}}\n</a>\n</li>\n<li>\n<a class='dropdown-item' href='{{>url('value_list')}}' target='_blank'>\n<i class='fa fa-list-ol'></i>\n{{jed \"Value List\"/}}\n</a>\n</li>\n<li>\n<a class='dropdown-item' href='{{>url('picking_list')}}' target='_blank'>\n<i class='fa fa-list-ol'></i>\n{{jed \"Picking List\"/}}\n</a>\n</li>\n</ul>\n</div>\n{{else}}\n<a class='button white text-ellipsis' href='{{>url()}}' target='_blank'>\n<i class='fa fa-file-alt'></i>\n{{jed \"Contract\"/}}\n</a>\n<div class='dropdown-holder inline-block'>\n<div class='button white dropdown-toggle'>\n<div class='arrow down'></div>\n</div>\n<ul class='dropdown right'>\n<li>\n<a class='dropdown-item' href='{{>url('value_list')}}' target='_blank'>\n<i class='fa fa-list-ol'></i>\n{{jed \"Value List\"/}}\n</a>\n</li>\n<li>\n<a class='dropdown-item' href='{{>url('picking_list')}}' target='_blank'>\n<i class='fa fa-list-ol'></i>\n{{jed \"Picking List\"/}}\n</a>\n</li>\n</ul>\n</div>\n{{/if}}\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/contracts/line_submitted","{{partial 'manage/views/users/cell' user() '{\"grid\":\"col1of8\"}'/}}\n<div class='col1of8 line-col'>{{diffToday created_at/}}</div>\n<div class='col1of8 line-col text-align-center' data-type='lines-cell'>{{include tmpl='manage/views/reservations/cell'/}}</div>\n<div class='col1of8 line-col'>\n{{>getMaxRange()}}\n{{jed getMaxRange() \"day\" \"days\"/}}\n</div>\n<div class='col2of8 line-col text-align-left'>{{include tmpl='manage/views/purposes/cell'/}}</div>\n<div class='col2of8 line-col line-actions'>\n<div class='multibutton'>\n<a class='button white text-ellipsis' data-order-approve>\n<i class='fa fa-thumbs-up'></i>\n{{if to_be_verified()}}\n{{jed \"Verify\"/}} + {{jed \"Approve\"/}}\n{{else}}\n{{jed \"Approve\"/}}\n{{/if}}\n</a>\n<div class='dropdown-holder inline-block'>\n<div class='button white dropdown-toggle'>\n<div class='arrow down'></div>\n</div>\n<ul class='dropdown right'>\n<li>\n<a class='dropdown-item' href='{{>editPath()}}'>\n<i class='fa fa-edit'></i>\n{{jed \"Edit\"/}}\n</a>\n</li>\n<li>\n<a class='dropdown-item red' data-order-reject>\n<i class='fa fa-thumbs-down'></i>\n{{jed \"Reject\"/}}\n</a>\n</li>\n</ul>\n</div>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/contracts/reject_modal","<div class='modal medium hide fade ui-modal padding-inset-m padding-horizontal-l' role='dialog' tabindex='-1'>\n<form action='/manage/{{current_inventory_pool_id/}}/contracts/{{>id}}/reject' method='post'>\n{{csrf_token/}}\n<div class='row padding-vertical-m'>\n<div class='col1of2'>\n<h3 class='headline-l'>{{jed \"Reject order\"/}}</h3>\n<h3 class='headline-s light'>\n{{>user().firstname}}\n{{>user().lastname}}\n</h3>\n</div>\n<div class='col1of2'>\n<div class='float-right'>\n<a aria-hidden='true' class='modal-close weak' data-dismiss='modal' title='{{jed \"close dialog\"/}}' type='button'>\n{{jed \"Cancel\"/}}\n</a>\n<button class='button red' type='submit'>\n<i class='fa fa-thumbs-down'></i>\n{{jed 'Reject'/}}\n</button>\n</div>\n</div>\n</div>\n<div class='row margin-top-m'>\n<div class='separated-bottom padding-bottom-m margin-bottom-m'>\n<div class='row margin-bottom-s emboss padding-inset-s'>\n<p class='paragraph-s'>{{>concatenatedPurposes()}}</p>\n</div>\n</div>\n<div class='modal-body'>\n{{for groupedLinesByDateRange(true)}}\n<div class='padding-bottom-m margin-bottom-m no-last-child-margin'>\n<div class='row margin-bottom-s'>\n<div class='col1of2'>\n<p>\n{{date start_date/}}\n-\n{{date end_date/}}\n</p>\n</div>\n<div class='col1of2 text-align-right'>\n<strong>{{diffDatesInDays start_date end_date/}}</strong>\n</div>\n</div>\n{{for reservations}}\n<div class='row'>\n<div class='col1of8 text-align-center'>\n<div class='paragraph-s'>\n{{if subreservations}}\n{{sum subreservations \"quantity\"/}}\n{{else}}\n{{> quantity}}\n{{/if}}\n</div>\n</div>\n<div class='col7of8'>\n<div class='paragraph-s'>\n<strong>{{>model().name()}}</strong>\n</div>\n</div>\n</div>\n{{/for}}\n</div>\n{{/for}}\n</div>\n</div>\n<div class='row separated-top padding-top-m'>\n<div class='col1of1 padding-bottom-s'>\n<p>{{jed \"Write a comment. The comment will be part of the rejection e-mail.\"/}}</p>\n</div>\n<textarea autofocus='autofocus' class='col1of1 height-s' id='rejection-comment' name='comment'></textarea>\n</div>\n</form>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/contracts/rejected_button","{{jed \"Rejected\"/}}\n<i class='fa fa-thumbs-down'></i>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/groups/autocomplete_element","<li class='separated-bottom exclude-last-child'>\n<a>\n<div class='row'>\n{{>name}}\n</div>\n</a>\n</li>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/groups/group_entry","<div class='row line font-size-xs'>\n<input name='user[groups][][id]' type='hidden' value='{{>id}}'>\n<div class='line-col col1of2 text-align-left'>\n{{>name}}\n</div>\n<div class='line-col col1of2 text-align-right'>\n<button class='button inset small' data-remove-group>{{jed \"Remove\"/}}</button>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/groups/partitions/autocomplete_element","<li class='separated-bottom exclude-last-child'>\n<a>\n<div class='row'>\n{{>name()}}\n</div>\n</a>\n</li>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/groups/partitions/model_allocation_entry","<div class='row line font-size-xs'>\n<input name='group[partitions_attributes][][id]' type='hidden'>\n<input name='group[partitions_attributes][][model_id]' type='hidden' value='{{>id}}'>\n<input name='group[partitions_attributes][][inventory_pool_id]' type='hidden' value='{{>~currentInventoryPool.id}}'>\n<div class='line-col col3of6 text-align-left' data-model-name>\n{{>name()}}\n</div>\n<div class='line-col col2of6'>\n<div class='line-col col1of2' data-quantities>\n<input class='width-full small text-align-center' min='1' name='group[partitions_attributes][][quantity]' type='text' value='1'>\n</div>\n<div class='line-col col1of2 padding-left-xs text-align-left' data-quantities>\n/ {{>availability().total_rentable}}\n</div>\n</div>\n<div class='line-col col1of6 text-align-right'>\n<button class='button inset small' data-remove-group>{{jed \"Remove\"/}}</button>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/hand_overs/deleted","<strong>\n{{jed \"Deleted\"/}}\n<i class='fa fa-trash'></i>\n</strong>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/hand_overs/line","<div class='line row focus-hover-thin' data-id='{{>id}}' data-type='hand_over'>\n{{if isOverdue()}}\n<div class='line-info red'></div>\n{{/if}}\n{{partial 'manage/views/users/cell' user() '{\"grid\":\"col1of5\"}'/}}\n<div class='col1of5 line-col'>\n{{if isOverdue()}}\n<strong>{{diffToday date/}}</strong>\n{{else}}\n{{diffToday date/}}\n{{/if}}\n</div>\n<div class='col1of5 line-col text-align-center' data-type='lines-cell'>{{include tmpl='manage/views/reservations/cell'/}}</div>\n<div class='col1of5 line-col text-align-center'>\n{{>getMaxRange()}}\n{{jed getMaxRange() \"day\" \"days\"/}}\n</div>\n<div class='col1of5 line-col line-actions'>\n<div class='multibutton'>\n<a class='button white text-ellipsis' href='/manage/{{current_inventory_pool_id/}}/users/{{>user().id}}/hand_over'>\n<i class='fa fa-mail-forward'></i>\n{{jed \"Hand Over\"/}}\n</a>\n<div class='dropdown-holder inline-block'>\n<div class='button white dropdown-toggle'>\n<div class='arrow down'></div>\n</div>\n<ul class='dropdown right'>\n<li>\n<a class='dropdown-item red' data-hand-over-delete>\n<i class='fa fa-trash'></i>\n{{jed \"Delete\"/}}\n</a>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/inline_entries/removed_on_save_info","<div class='line-col' title='{{jed 'Removed on save'/}}'>\n<i class='fa fa-trash'></i>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/inventory/helper/error","<div class='row emboss red text-align-center font-size-m padding-inset-s'>\n<strong>{{>text}}</strong>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews
}),function(e){e.views.templates("manage/views/inventory/helper/item_autocomplete_element","<li class='separated-bottom exclude-last-child'>\n<a>\n<div class='row text-ellipsis'>\n<div class='col1of3'>\n<strong>{{>inventory_code}}</strong>\n</div>\n<div class='col2of3 text-ellipsis' title='{{>current_location}}'>\n{{>current_location}}\n</div>\n</div>\n</a>\n</li>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/inventory/helper/success","<div class='row emboss green text-align-center font-size-m padding-inset-s'>\n<strong>{{>text}}</strong>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/inventory/item_line","<div class='line row focus-hover-thin' data-id='{{>id}}' data-type='item'>\n<div class='col1of5 line-col'>\n{{if model().is_package}}\n<div class='row'>\n<div class='col1of2'></div>\n<div class='col1of2'>\n<button class='button inset small width-full' data-type='inventory-expander'>\n{{if children().count()>0}}\n<i class='arrow right'></i>\n{{/if}}\n<span>{{>children().count()}}</span>\n</button>\n</div>\n</div>\n{{/if}}\n</div>\n<div class='col2of5 line-col text-align-left'>\n<div class='row'>{{>inventory_code}}</div>\n{{if parent_id}}\n<strong class='grey-text'>{{>model().name()}}</strong>\n<div class='row grey-text text-ellipsis width-full' title='{{jed \"is part of a package\"/}}'>\n{{jed \"is part of a package\"/}}\n</div>\n{{else}}\n<div class='row grey-text'>\n{{if ~additionalDataFetched}}\n{{>current_location}}\n{{else}}\n{{partial \"views/loading\" {\"size\":\"micro\"}/}}\n{{/if}}\n</div>\n{{/if}}\n</div>\n<div class='col1of5 line-col text-align-center'>\n<strong class='darkred-text'>{{>getProblems()}}</strong>\n</div>\n<div class='col1of5 line-col line-actions padding-right-xs'>\n{{if ~accessRight.atLeastRole(~currentUserRole, \"lending_manager\") }}\n<div class='multibutton width-full text-align-right'>\n<a class='button white text-ellipsis col4of5 negative-margin-right-xxs' href='{{>url('edit')}}' title='{{jed 'Edit Item'/}}'>\n{{jed \"Edit Item\"/}}\n</a>\n<div class='dropdown-holder inline-block col1of5'>\n<div class='button white dropdown-toggle width-full no-padding text-align-center'>\n<div class='arrow down'></div>\n</div>\n<ul class='dropdown right'>\n<li>\n<a class='dropdown-item' href='{{>url('copy')}}'>\n<i class='fa fa-copy'></i>\n{{jed \"Copy Item\"/}}\n</a>\n</li>\n</ul>\n</div>\n</div>\n{{/if}}\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/inventory/license_line","<div class='line row focus-hover-thin' data-id='{{>id}}' data-type='license'>\n<div class='col1of5 line-col'></div>\n<div class='col2of5 line-col text-align-left'>\n<div class='row'>{{>inventory_code}}</div>\n<div class='row grey-text'>\n{{if ~additionalDataFetched}}\n{{>current_location}}\n{{else}}\n<span>\n{{partial \"views/loading\" {\"size\":\"micro\"}/}}\n</span>\n{{/if}}\n{{>licenseInformation()}}\n</div>\n</div>\n<div class='col1of5 line-col'></div>\n<div class='col1of5 line-col line-actions padding-right-xs'>\n{{if ~accessRight.atLeastRole(~currentUserRole, \"lending_manager\") }}\n<div class='multibutton width-full text-align-right'>\n<a class='button white text-ellipsis col4of5 negative-margin-right-xxs' href='{{>url('edit')}}' title='{{jed 'Edit License'/}}'>\n{{jed \"Edit License\"/}}\n</a>\n<div class='dropdown-holder inline-block col1of5'>\n<div class='button white dropdown-toggle width-full no-padding text-align-center'>\n<div class='arrow down'></div>\n</div>\n<ul class='dropdown right'>\n<li>\n<a class='dropdown-item' href='{{>url('copy')}}'>\n<i class='fa fa-copy'></i>\n{{jed \"Copy License\"/}}\n</a>\n</li>\n</ul>\n</div>\n</div>\n{{/if}}\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/inventory/line",'{{include tmpl="manage/views/inventory/"+constructor.className.toLowerCase()+"_line" /}}\n')}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/inventory/model_line","<div class='line row focus-hover-thin' data-id='{{>id}}' data-is_package='{{>is_package}}' data-type='model'>\n<div class='col1of5 line-col'>\n<div class='row'>\n<div class='col1of2'>\n<button class='button inset small width-full' data-type='inventory-expander' title='{{if is_package}}{{jed 'Packages'/}}{{else}}{{jed 'Items'/}}{{/if}}'>\n{{if items().count()>0}}\n<i class='arrow right'></i>\n{{/if}}\n<span>{{>items().count()}}</span>\n</button>\n</div>\n<div class='col1of2 text-align-center height-xxs'>\n<div class='table'>\n<div class='table-row'>\n<div class='table-cell vertical-align-middle'>\n<img class='max-width-xxs max-height-xxs' src='/models/{{>id}}/image_thumb'>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class='col2of5 line-col text-align-left'>\n{{if is_package}}\n<div class='grey-text'>{{jed 'Package'/}}</div>\n{{/if}}\n<strong>\n{{> name()}}\n</strong>\n</div>\n<div class='col1of5 line-col text-align-center'>\n<span title='{{jed 'in stock'/}}'>{{> availability().in_stock}}</span>\n/\n<span title='{{jed 'rentable'/}}'>{{> availability().total_rentable}}</span>\n</div>\n<div class='col1of5 line-col line-actions padding-right-xs'>\n{{if ~accessRight.atLeastRole(~currentUserRole, \"lending_manager\") }}\n<div class='multibutton width-full text-align-right'>\n<a class='button white text-ellipsis col4of5 negative-margin-right-xxs' href='{{>url('edit')}}' title='{{jed 'Edit Model'/}}'>\n{{jed \"Edit Model\"/}}\n</a>\n<div class='dropdown-holder inline-block col1of5'>\n<div class='button white dropdown-toggle width-full no-padding text-align-center'>\n<div class='arrow down'></div>\n</div>\n<ul class='dropdown right'>\n<li>\n<a class='dropdown-item' data-model-id='{{>id}}' data-open-time-line>\n<i class='fa fa-align-left'></i>\n{{jed \"Timeline\"/}}\n</a>\n</li>\n{{if items().count() == 0}}\n<li>\n<a class='dropdown-item red' data-method='delete' href='{{>url()}}'>\n<i class='fa fa-trash'></i>\n{{jed \"Delete\"/}}\n</a>\n</li>\n{{/if}}\n</ul>\n</div>\n</div>\n{{else}}\n<a class='button white text-ellipsis' data-model-id='{{>id}}' data-open-time-line>\n<i class='fa fa-align-left'></i>\n{{jed \"Timeline\"/}}\n</a>\n{{/if}}\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/inventory/option_line","<div class='line row focus-hover-thin' data-id='{{>id}}' data-type='option'>\n<div class='col1of5 line-col text-align-center'>{{>inventory_code}}</div>\n<div class='col2of5 line-col text-align-left'>\n<strong>{{> name()}}</strong>\n</div>\n<div class='col1of5 line-col text-align-center'>\n{{money price/}}\n</div>\n<div class='col1of5 line-col line-actions padding-right-xs'>\n{{if ~accessRight.atLeastRole(~currentUserRole, \"lending_manager\") }}\n<a class='button white text-ellipsis' href='{{>url('edit')}}'>\n{{jed \"Edit Option\"/}}\n</a>\n{{/if}}\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/inventory/software_line","<div class='line row focus-hover-thin' data-id='{{>id}}' data-is_package='{{>is_package}}' data-type='software'>\n<div class='col1of5 line-col'>\n<div class='row'>\n<div class='col1of2'>\n<button class='button inset small width-full' data-type='inventory-expander' title='{{if is_package}}{{jed 'Packages'/}}{{else}}{{jed 'Items'/}}{{/if}}'>\n{{if licenses().count()>0}}\n<i class='arrow right'></i>\n{{/if}}\n<span>{{>licenses().count()}}</span>\n</button>\n</div>\n<div class='col1of2 text-align-center height-xxs'>\n<div class='table'>\n<div class='table-row'>\n<div class='table-cell vertical-align-middle'>\n<img class='max-width-xxs max-height-xxs' src='/models/{{>id}}/image_thumb'>\n</div>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class='col2of5 line-col text-align-left'>\n{{if is_package}}\n<div class='grey-text'>{{jed 'Package'/}}</div>\n{{/if}}\n<strong>\n{{> name()}}\n</strong>\n</div>\n<div class='col1of5 line-col text-align-center'>\n<span title='{{jed 'in stock'/}}'>{{> availability().in_stock}}</span>\n/\n<span title='{{jed 'rentable'/}}'>{{> availability().total_rentable}}</span>\n</div>\n<div class='col1of5 line-col line-actions padding-right-xs'>\n{{if ~accessRight.atLeastRole(~currentUserRole, \"lending_manager\") }}\n<div class='multibutton width-full text-align-right'>\n<a class='button white text-ellipsis col4of5 negative-margin-right-xxs' href='{{>url('edit')}}' title='{{jed 'Edit Software'/}}'>\n{{jed \"Edit Software\"/}}\n</a>\n<div class='dropdown-holder inline-block col1of5'>\n<div class='button white dropdown-toggle width-full no-padding text-align-center'>\n<div class='arrow down'></div>\n</div>\n<ul class='dropdown right'>\n<li>\n<a class='dropdown-item' data-model-id='{{>id}}' data-open-time-line>\n<i class='fa fa-align-left'></i>\n{{jed \"Timeline\"/}}\n</a>\n</li>\n{{if licenses().count() == 0}}\n<li>\n<a class='dropdown-item red' data-method='delete' href='{{>url()}}'>\n<i class='fa fa-trash'></i>\n{{jed \"Delete\"/}}\n</a>\n</li>\n{{/if}}\n</ul>\n</div>\n</div>\n{{else}}\n<a class='button white text-ellipsis' data-model-id='{{>id}}' data-open-time-line>\n<i class='fa fa-align-left'></i>\n{{jed \"Timeline\"/}}\n</a>\n{{/if}}\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/inventory_pools/admin/holiday_entry","<div class='row line font-size-xs' data-index='{{>i}}'>\n<input name='inventory_pool[holidays_attributes][{{>i}}][name]' type='hidden' value='{{>name}}'>\n<input name='inventory_pool[holidays_attributes][{{>i}}][start_date]' type='hidden' value='{{>start_date}}'>\n<input name='inventory_pool[holidays_attributes][{{>i}}][end_date]' type='hidden' value='{{>end_date}}'>\n<div class='line-col col1of4 text-align-left'>\n<strong>{{>name}}</strong>\n</div>\n<div class='line-col col2of4 text-align-left'>\n{{>start_date}} - {{>end_date}}\n</div>\n<div class='line-col col1of4'>\n<button class='button inset small' data-remove-holiday>{{jed \"Delete\"/}}</button>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/inventory_pools/daily/workload","<div class='row margin-top-l padding-bottom-m'>\n<div class='text-align-right margin-right-m'>\n<span class='badge medium padding-inset-xs text-shadow' style='background-color: #999999'>{{jed \"Take Backs\"/}}</span>\n<span class='badge medium padding-inset-xs text-shadow' style='background-color: #cccccc'>{{jed \"Hand Overs\"/}}</span>\n</div>\n</div>\n<div class='bar-chart'></div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/inventory_pools/latest_reminder/tooltip","<div class='row width-l'>\n<div class='paragraph-s'>\n<strong>{{dateAndTime created_at/}}</strong>\n{{>title}}\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/autocomplete_element","<li class='separated-bottom exclude-last-child width-xxl'>\n<a class='row{{if hasProblems()}} light-red{{/if}}' title='{{>inventory_code}}{{if location}} {{>location}}{{/if}}'>\n<div class='col1of4 text-ellipsis'>\n<strong>{{>inventory_code}}</strong>\n</div>\n<div class='col3of4 text-ellipsis'>\n{{>location}}\n</div>\n{{if serial_number}}\n<div class='col3of4'>\n<strong>{{>serial_number}}</strong>\n</div>\n{{/if}}\n</a>\n</li>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/field","<div id='{{>~field.id}}'>\n<div class='{{if ~fieldColor}}{{>~fieldColor}} {{/if}}{{if ~field.hidden}}hidden {{/if}}field row emboss padding-inset-xs margin-vertical-xxs margin-right-xs' data-editable='{{>~field.isEditable(~itemData)}}' data-id='{{>~field.id}}' data-required='{{>~field.required}}' data-type='field'>\n<div class='row'>\n<div class='col1of2 padding-vertical-xs' data-type='key'>\n{{if !~field.visibility_dependency_field_id && (~removeable || (~hideable && !~field.required) )}}\n<a class='font-size-m link grey padding-inset-xs' data-placement='top' data-toggle='tooltip' data-type='remove-field' title='{{jed 'Hide this field from all item forms'/}}'>\n<i class='fa fa-times-circle'></i>\n</a>\n{{/if}}\n<strong class='font-size-m inline-block'>\n{{>~field.getLabel()}}\n{{if ~field.required}}*{{/if}}\n</strong>\n</div>\n<div class='col1of2' data-type='value'>\n{{if (~writeable && !~itemData) || (~writeable && ~field.isEditable(~itemData))}}\n{{include tmpl=\"manage/views/items/fields/writeable/\"+~field.type/}}\n{{else}}\n<div class='padding-vertical-xs font-size-m' data-value='{{>~field.getValue(~itemData, ~field.attribute)}}'>\n{{include tmpl=\"manage/views/items/fields/readonly/\"+~field.type/}}\n</div>\n{{/if}}\n</div>\n</div>\n{{if ~field.id == 'inventory_code' && ~itemData && !~itemData.created_at}}\n<div class='row text-align-right' id='switch'>\n<button class='button small green' data-inventory_code='{{>~itemData.inventory_code}}'>\n{{jed 'last used +1'/}}\n</button>\n<button class='button small white' data-inventory_code='{{>~itemData.lowest_proposed_inventory_code}}'>\n{{jed 'fill up gaps'/}}\n</button>\n<button class='button small white' data-inventory_code='{{>~itemData.highest_proposed_inventory_code}}'>\n{{jed 'assign highest available'/}}\n</button>\n</div>\n{{/if}}\n{{if ~field.id == 'attachments'}}\n<div class='list-of-lines even padding-bottom-xxs'>\n{{if ~writeable && ~field.isEditable(~itemData)}}\n{{partial 'manage/views/items/fields/writeable/partials/uploaded_attachment' ~itemData.attachments/}}\n{{else}}\n{{partial 'manage/views/items/fields/readonly/partials/uploaded_attachment' ~itemData.attachments/}}\n{{/if}}\n</div>\n{{/if}}\n</div>\n</div>\n<script>\n  (function() {\n    $(document).ready(function() {\n      if (!window.defined_once) {\n        $('[data-toggle=\"tooltip\"]').tooltip();\n        $('body').on('click', '#switch button[data-inventory_code]', function() {\n          $('input[name=\"item[inventory_code]\"]').val($(this).data('inventory_code'));\n          $('#switch button[data-inventory_code]').removeClass('green').addClass('white');\n          $(this).removeClass('white').addClass('green');\n          return false;\n        });\n        return window.defined_once = true;\n      }\n    });\n  \n  }).call(this);\n</script>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/fields/readonly/attachment","")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/fields/readonly/autocomplete-search","{{if ~field.getValue(~itemData, ~field.attribute)}}\n<span>{{>~field.getItemValueLabel(~field.item_value_label, ~itemData)}}</span>\n{{/if}}\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/fields/readonly/autocomplete","{{if ~field.getValue(~itemData, ~field.attribute)}}\n<span>{{>~field.getValueLabel(~field.values, ~field.getValue(~itemData, ~field.attribute))}}</span>\n{{/if}}\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/fields/readonly/date","{{if ~field.getValue(~itemData, ~field.attribute)}}\n<span>{{date ~field.getValue(~itemData, ~field.attribute)/}}</span>\n{{/if}}\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/fields/readonly/partials/uploaded_attachment","<div class='row line font-size-xs focus-hover-thin' data-type='inline-entry'>\n<div class='line-col col7of10 text-align-left'>\n<a class='blue' href='{{>public_filename}}' target='_blank'>\n{{>filename}}\n</a>\n</div>\n<div class='line-col col3of10 text-align-right'></div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/fields/readonly/radio","{{for ~field.values}}\n{{if ~field.getValue(~itemData, ~field.attribute) == value}}\n<span>{{jed label/}}</span>\n{{/if}}\n{{/for}}\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/fields/readonly/select","{{for ~field.values}}\n{{if ~field.getValue(~itemData, ~field.attribute) == value}}\n<span>{{jed label/}}</span>\n{{/if}}\n{{/for}}\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/fields/readonly/text","{{if ~field.getValue(~itemData, ~field.attribute)}}\n<span>{{>~field.getValue(~itemData, ~field.attribute)}}</span>\n{{/if}}\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/fields/readonly/textarea","{{if ~field.getValue(~itemData, ~field.attribute)}}\n<span>{{>~field.getValue(~itemData, ~field.attribute)}}</span>\n{{/if}}\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/fields/writeable/attachment","<button class='button inset width-full' data-type='select'>\n{{jed \"Select File\"/}}\n</button>\n<input autocomplete='false' class='invisible height-full width-full position-absolute-topleft' type='file'>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/fields/writeable/autocomplete-search","<label class='row'>\n{{if ~field.getValue(~itemData, ~field.attribute, true)}}\n<input name='{{>~field.getFormName()}}' type='hidden' value='{{>~field.getValue(~itemData, ~field.attribute, true)}}'>\n<input autocomplete='off' class='has-addon width-full' data-autocomplete_blur_on_select='true' data-autocomplete_display_attribute='{{>~field.display_attr}}' data-autocomplete_display_attribute_ext='{{>~field.display_attr_ext}}' data-autocomplete_element_tmpl='views/autocomplete/element' data-autocomplete_search_attr='{{>~field.search_attr}}' data-autocomplete_value_attribute='{{>~field.value_attr}}' data-autocomplete_value_target='{{>~field.getFormName()}}' data-type='autocomplete' data-url='{{>~field.search_path}}' placeholder='{{>~field.getLabel()}}' title='{{>~field.getLabel()}}' type='text' value='{{>~field.getItemValueLabel(~field.item_value_label, ~itemData)}}'>\n{{else}}\n<input name='{{>~field.getFormName()}}' type='hidden'>\n<input autocomplete='off' class='has-addon width-full' data-autocomplete_blur_on_select='true' data-autocomplete_display_attribute='{{>~field.display_attr}}' data-autocomplete_display_attribute_ext='{{>~field.display_attr_ext}}' data-autocomplete_element_tmpl='views/autocomplete/element' data-autocomplete_search_attr='{{>~field.search_attr}}' data-autocomplete_value_attribute='{{>~field.value_attr}}' data-autocomplete_value_target='{{>~field.getFormName()}}' data-type='autocomplete' data-url='{{>~field.search_path}}' placeholder='{{>~field.getLabel()}}' title='{{>~field.getLabel()}}' type='text'>\n{{/if}}\n<div class='addon transparent'>\n<i class='arrow down'></i>\n</div>\n</label>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/fields/writeable/autocomplete","<label class='row'>\n{{if ~field.extensible}}\n<input data-type='extended-value' name='{{>~field.getExtendedKeyFormName()}}' type='hidden' value='{{>~field.getValue(~itemData, ~field.extended_key, true)}}'>\n{{/if}}\n{{if ~field.getValue(~itemData, ~field.attribute, true)}}\n<input name='{{>~field.getFormName()}}' type='hidden' value='{{>~field.getValue(~itemData, ~field.attribute, true)}}'>\n<input autocomplete='off' class='has-addon width-full' data-autocomplete_blur_on_select='true' data-autocomplete_data='{{stringify ~field.values/}}' data-autocomplete_display_attribute='label' data-autocomplete_element_tmpl='views/autocomplete/element' data-autocomplete_extended_key_target='{{>~field.getExtendedKeyFormName()}}' data-autocomplete_extensible='{{>~field.extensible}}' data-autocomplete_search_on_focus='true' data-autocomplete_value_target='{{>~field.getFormName()}}' data-type='autocomplete' placeholder='{{>~field.getLabel()}}' title='{{>~field.getLabel()}}' type='text' value='{{>~field.getValueLabel(~field.values, ~field.getValue(~itemData, ~field.attribute, true))}}'>\n{{else}}\n<input name='{{>~field.getFormName()}}' type='hidden'>\n<input autocomplete='off' class='has-addon width-full' data-autocomplete_blur_on_select='true' data-autocomplete_data='{{stringify ~field.values/}}' data-autocomplete_display_attribute='label' data-autocomplete_element_tmpl='views/autocomplete/element' data-autocomplete_extended_key_target='{{>~field.getExtendedKeyFormName()}}' data-autocomplete_extensible='{{>~field.extensible}}' data-autocomplete_search_on_focus='true' data-autocomplete_value_target='{{>~field.getFormName()}}' data-type='autocomplete' placeholder='{{>~field.getLabel()}}' title='{{>~field.getLabel()}}' type='text'>\n{{/if}}\n<div class='addon transparent'>\n<i class='arrow down'></i>\n</div>\n</label>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/fields/writeable/checkbox","<div class='padding-inset-xxs'>\n{{:~setvar(\"values\", ~field.getValue(~itemData, ~field.attribute, true))}}\n{{for ~field.values}}\n<label class='padding-inset-xxs'>\n{{if ~getvar(\"values\") != null && ~getvar(\"values\").indexOf(value) >= 0}}\n<input checked name='{{>~field.getFormName(~field.attribute, ~field.form_name, 'asArray')}}' type='checkbox' value='{{>value}}'>\n{{else}}\n<input name='{{>~field.getFormName(~field.attribute, ~field.form_name, 'asArray')}}' type='checkbox' value='{{>value}}'>\n{{/if}}\n<span class='font-size-m'>{{jed label/}}</span>\n</label>\n{{/for}}\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/fields/writeable/composite","<div class='row'>\n<div class='col7of8 padding-vertical-xs' id='remaining-total-quantity'></div>\n<div class='col1of8'>\n<button class='button inset float-right' id='add-inline-entry'>\n<i class='fa fa-plus'></i>\n</button>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/fields/writeable/composite_partials/license_quantity_allocation","<div class='row line font-size-xs focus-hover-thin' data-type='inline-entry'>\n<div class='line-col col1of10 text-align-center'>Quantity:</div>\n<div class='line-col col2of10'>\n<input class='width-full small text-align-center' data-quantity-allocation='true' name='{{>field.getFormName()}}[][quantity]' type='text' value='{{if allocation}}{{>allocation.quantity}}{{/if}}'>\n</div>\n<div class='line-col col1of10 text-align-center'>Location:</div>\n<div class='line-col col5of10'>\n<input class='width-full small text-align-center' data-room-allocation='true' name='{{>field.getFormName()}}[][room]' type='text' value='{{if allocation}}{{>allocation.room}}{{/if}}'>\n</div>\n<div class='line-col col1of10'>\n<button class='button inset small' data-remove>Remove</button>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/fields/writeable/date","<input name='{{>~field.getFormName()}}' type='hidden' value='{{>~field.getValue(~itemData, ~field.attribute, true)}}'>\n{{if ~field.getValue(~itemData, ~field.attribute, true)}}\n<input autocomplete='off' class='width-full' data-type='datepicker' type='text' value='{{date ~field.getValue(~itemData, ~field.attribute, true)/}}'>\n{{else}}\n<input autocomplete='off' class='width-full' data-type='datepicker' type='text'>\n{{/if}}\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/fields/writeable/partials/attachment_inline_entry","<div class='row line font-size-xs focus-hover-thin' data-new data-type='inline-entry'>\n<div class='line-col text-align-center' title='{{jed 'File has to be uploaded on save'/}}'>\n<i class='fa fa-cloud-upload'></i>\n</div>\n<div class='line-col col7of10 text-align-left'>\n{{>name}}\n</div>\n<div class='line-col col3of10 text-align-right'>\n<button class='button small inset' data-remove type='button'>\n{{jed \"Remove\"/}}\n</button>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/fields/writeable/partials/uploaded_attachment","<div class='row line font-size-xs focus-hover-thin' data-type='inline-entry'>\n<input name='item[attachments_attributes][{{>id}}][id]' type='hidden' value='{{>id}}'>\n<input name='item[attachments_attributes][{{>id}}][_destroy]' type='hidden'>\n<div class='line-col col7of10 text-align-left'>\n<a class='blue' href='{{>public_filename}}' target='_blank'>\n{{>filename}}\n</a>\n</div>\n<div class='line-col col3of10 text-align-right'>\n<button class='button small inset' data-remove type='button'>\n{{jed \"Remove\"/}}\n</button>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/fields/writeable/radio","<div class='padding-inset-xxs'>\n{{for ~field.values}}\n<label class='padding-inset-xxs'>\n{{if ~field.getValue(~itemData, ~field.attribute, true) == value}}\n<input checked name='{{>~field.getFormName()}}' type='radio' value='{{>value}}'>\n{{else}}\n<input name='{{>~field.getFormName()}}' type='radio' value='{{>value}}'>\n{{/if}}\n<span class='font-size-m'>{{jed label/}}</span>\n</label>\n{{/for}}\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/fields/writeable/select","<select class='width-full' name='{{>~field.getFormName()}}'>\n{{for ~field.values}}\n{{if ~field.getValue(~itemData, ~field.attribute, true) == value}}\n<option selected value='{{>value}}'>\n{{jed label/}}\n</option>\n{{else}}\n<option value='{{>value}}'>\n{{jed label/}}\n</option>\n{{/if}}\n{{/for}}\n</select>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/fields/writeable/text","{{if ~field.getValue(~itemData, ~field.attribute, true)}}\n<input autocomplete='off' class='width-full' name='{{>~field.getFormName()}}' type='text' value='{{>~field.getValue(~itemData, ~field.attribute, true)}}'>\n{{else}}\n<input autocomplete='off' class='width-full' name='{{>~field.getFormName()}}' type='text'>\n{{/if}}\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/fields/writeable/textarea","<textarea autocomplete='off' class='width-full' name='{{>~field.getFormName()}}' rows='5' value=''>{{>~field.getValue(~itemData, ~field.attribute, true)}}</textarea>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/form","<div class='col1of2 padding-right-xs' id='item-form-left-side'></div>\n<div class='col1of2' id='item-form-right-side'></div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/group_of_fields","<section class='padding-bottom-l'>\n{{if name}}\n<h2 class='headline-m padding-bottom-m'>\n{{jed name/}}\n</h2>\n{{/if}}\n<div class='row group-of-fields'></div>\n</section>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/inspect_dialog","<div class='modal medium hide fade ui-modal padding-inset-m padding-horizontal-l' role='dialog' tabindex='-1'>\n<form>\n<div class='row padding-vertical-m'>\n<div class='col1of2'>\n<h3 class='headline-l'>\n{{jed \"Inspect Item\"/}}\n{{>inventory_code}}\n</h3>\n<h4 class='headline-m light'>{{>model().name()}}</h4>\n</div>\n<div class='col1of2'>\n<div class='float-right'>\n<a aria-hidden='true' class='modal-close weak' data-dismiss='modal' title='{{jed \"close dialog\"/}}' type='button'>\n{{jed \"Cancel\"/}}\n</a>\n<button class='button green' type='submit'>\n{{jed \"Save\"/}}\n</button>\n</div>\n</div>\n<div class='row padding-vertical-m'>\n<div class='row padding-top-m'>\n<label class='col1of3 padding-right-s'>\n<div class='row'>{{jed 'Status'/}}</div>\n<div class='row'>\n<select class='width-full' name='is_broken'>\n{{if is_broken}}\n<option value='false'>{{jed 'Functional'/}}</option>\n<option selected value='true'>{{jed 'Defective'/}}</option>\n{{else}}\n<option selected value='false'>{{jed 'Functional'/}}</option>\n<option value='true'>{{jed 'Defective'/}}</option>\n{{/if}}\n</select>\n</div>\n</label>\n<label class='col1of3 padding-right-s'>\n<div class='row'>{{jed 'Completeness'/}}</div>\n<div class='row'>\n<select class='width-full' name='is_incomplete'>\n{{if is_incomplete}}\n<option value='false'>{{jed 'Complete'/}}</option>\n<option selected value='true'>{{jed 'Incomplete'/}}</option>\n{{else}}\n<option selected value='false'>{{jed 'Complete'/}}</option>\n<option value='true'>{{jed 'Incomplete'/}}</option>\n{{/if}}\n</select>\n</div>\n</label>\n<div class='col1of3 padding-right-s'>\n<div class='row'>{{jed 'Borrowable'/}}</div>\n<div class='row'>\n<select class='width-full' name='is_borrowable'>\n{{if is_borrowable}}\n<option selected value='true'>{{jed 'Borrowable'/}}</option>\n<option value='false'>{{jed 'Unborrowable'/}}</option>\n{{else}}\n<option value='true'>{{jed 'Borrowable'/}}</option>\n<option selected value='false'>{{jed 'Unborrowable'/}}</option>\n{{/if}}\n</select>\n</div>\n</div>\n</div>\n<div class='row padding-top-m'>\n<label class='col1of1 padding-right-s'>\n<div class='row'>{{jed 'Status note'/}}</div>\n<div class='row'>\n<textarea class='width-full' name='status_note'>{{> status_note}}</textarea>\n</div>\n</label>\n</div>\n</div>\n</div>\n</form>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/items/line","<div class='line row focus-hover-thin{{if !~currentInventoryPool.isOwnerOrResponsibleFor(#view.data)}} grayed-out{{/if}}' data-id='{{>id}}' data-type='item'>\n<div class='col1of8 line-col'>\n<strong>{{>inventory_code}}</strong>\n</div>\n<div class='col3of8 line-col text-align-left'>\n{{>model().name()}}\n{{if ~currentInventoryPool.isOwnerOrResponsibleFor(#view.data) }}\n<strong class='block darkred-text'>{{>getProblems()}}</strong>\n{{/if}}\n</div>\n<div class='col2of8 line-col text-align-left padding-right-s'>\n{{>current_location}}\n</div>\n<div class='col2of8 line-col line-actions padding-right-xs'>\n{{if ~currentInventoryPool.isOwnerOrResponsibleFor(#view.data) && ~accessRight.atLeastRole(~currentUserRole, \"lending_manager\") }}\n<div class='multibutton'>\n<a class='button white' href='{{>url('edit')}}' title='{{jed 'Edit Item'/}}'>\n{{jed \"Edit Item\"/}}\n</a>\n<div class='dropdown-holder inline-block'>\n<div class='button white dropdown-toggle'>\n<div class='arrow down'></div>\n</div>\n<ul class='dropdown right'>\n<li>\n<a class='dropdown-item' href='{{>url('copy')}}'>\n<i class='fa fa-copy'></i>\n{{jed \"Copy Item\"/}}\n</a>\n</li>\n</ul>\n</div>\n</div>\n{{/if}}\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/licenses/line","<div class='line row focus-hover-thin{{if !~currentInventoryPool.isOwnerOrResponsibleFor(#view.data)}} grayed-out{{/if}}' data-id='{{>id}}' data-type='license'>\n<div class='col1of8 line-col'>\n<strong>{{>inventory_code}}</strong>\n</div>\n<div class='col3of8 line-col text-align-left'>\n{{>model().name()}}\n{{if ~currentInventoryPool.isOwnerOrResponsibleFor(#view.data) }}\n<strong class='block darkred-text'>{{>getProblems()}}</strong>\n{{/if}}\n</div>\n<div class='col2of8 line-col text-align-left padding-right-s'>\n{{>current_location}}\n</div>\n<div class='col2of8 line-col line-actions padding-right-xs'>\n{{if ~currentInventoryPool.isOwnerOrResponsibleFor(#view.data) && ~accessRight.atLeastRole(~currentUserRole, \"lending_manager\") }}\n<div class='multibutton'>\n<a class='button white' href='{{>url('edit')}}' title='{{jed 'Edit License'/}}'>\n{{jed \"Edit License\"/}}\n</a>\n<div class='dropdown-holder inline-block'>\n<div class='button white dropdown-toggle'>\n<div class='arrow down'></div>\n</div>\n<ul class='dropdown right'>\n<li>\n<a class='dropdown-item' href='{{>url('copy')}}'>\n<i class='fa fa-copy'></i>\n{{jed \"Copy License\"/}}\n</a>\n</li>\n</ul>\n</div>\n</div>\n{{/if}}\n</div>\n</div>\n");
}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/lists/loading","<div class='height-s'></div>\n<img class='margin-horziontal-auto margin-top-xxl margin-bottom-xxl' src='/assets/loading-5ed385f71ca1eb04ca01faecb9f7973d.gif'>\n<div class='height-s'></div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/lists/no_results","<div class='height-s'></div>\n<h3 class='headline-s light padding-inset-xl text-align-center'>\n{{jed \"No entries found\"/}}\n</h3>\n<div class='height-s'></div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/lists/page","<span class='page' data-page='{{> ~page}}'>\n{{for ~entries}}\n<div class='line'></div>\n{{/for}}\n</span>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/models/explorative_add_line","<div class='line row focus-hover-thin{{if availability().maxAvailableForGroups(~startDate, ~endDate, ~groupIds) <= 0}} grayed-out{{/if}}' data-id='{{>id}}' data-type='model'>\n<div class='col1of10 line-col no-padding text-align-center'>\n<div class='table'>\n<div class='table-row'>\n<div class='table-cell vertical-align-middle'>\n<img class='max-width-xxs max-height-xxs' src='/models/{{>id}}/image_thumb'>\n</div>\n</div>\n</div>\n</div>\n<div class='col5of10 line-col text-align-left'>\n{{if is_package}}\n<div class='grey-text'>{{jed 'Package'/}}</div>\n{{/if}}\n<strong>\n{{> name()}}\n</strong>\n</div>\n<div class='col2of10 line-col no-padding text-align-center'>\n<span title='{{jed 'Available for borrower'/}}'>{{>availability().maxAvailableForGroups(~startDate, ~endDate, ~groupIds)}}</span>\n<span title='{{jed 'Available in total'/}}'>({{>availability().maxAvailableInTotal(~startDate, ~endDate)}})</span>\n/\n<span title='{{jed 'Borrowable items'/}}'>{{>availability().total_rentable}}</span>\n</div>\n<div class='col2of10 line-col line-actions padding-right-s text-align-center'>\n<a class='button white' data-type='select'>\n{{jed \"Select\"/}}\n</a>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/models/form/accessory_inline_entry","<div class='row line font-size-xs focus-hover-thin' data-new data-type='inline-entry'>\n<input name='model[accessories_attributes][{{>~uid}}][inventory_pool_toggle]' type='hidden' value='0,{{current_inventory_pool_id/}}'>\n<label class='line-col col1of10 text-align-center no-padding'>\n<input autocomplete='off' checked name='model[accessories_attributes][{{>~uid}}][inventory_pool_toggle]' type='checkbox' value='1,{{current_inventory_pool_id/}}'>\n</label>\n<div class='line-col col6of10 text-align-left'>\n{{>name}}\n<input name='model[accessories_attributes][{{>~uid}}][name]' type='hidden' value='{{>name}}'>\n</div>\n<div class='line-col col3of10 text-align-right'>\n<button class='button small inset' data-remove>Remove</button>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/models/form/allocation_inline_entry","<div class='row line font-size-xs focus-hover-thin' data-new data-type='inline-entry'>\n<input name='model[partitions_attributes][{{>~uid}}][inventory_pool_id]' type='hidden' value='{{current_inventory_pool_id/}}'>\n<input name='model[partitions_attributes][{{>~uid}}][group_id]' type='hidden' value='{{>id}}'>\n<div class='line-col col3of5 text-align-left' data-name='{{>name}}'>\n{{>name}}\n</div>\n<div class='line-col col1of5 text-align-center'>\n<input autocomplete='off' class='width-xs small text-align-center' name='model[partitions_attributes][{{>~uid}}][quantity]' type='text' value='1'>\n</div>\n<div class='line-col col1of5 text-align-right'>\n<button class='button small inset' data-remove>Remove</button>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/models/form/attachment_inline_entry","<div class='row line font-size-xs focus-hover-thin' data-new data-type='inline-entry'>\n<div class='line-col text-align-center' title='{{jed 'File has to be uploaded on save'/}}'>\n<i class='fa fa-cloud-upload'></i>\n</div>\n<div class='line-col col7of10 text-align-left'>\n{{>name}}\n</div>\n<div class='line-col col3of10 text-align-right'>\n<button class='button small inset' data-remove type='button'>Remove</button>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/models/form/category_inline_entry","<div class='row line font-size-xs focus-hover-thin' data-new data-type='inline-entry'>\n<input data-disable-on-remove name='model[category_ids][]' type='hidden' value='{{>id}}'>\n<div class='line-col col2of3 text-align-left'>\n{{>name}}\n</div>\n<div class='line-col col1of3 text-align-right'>\n<button class='button small inset' data-remove>Remove</button>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/models/form/compatible_inline_entry","<div class='row line font-size-xs focus-hover-thin' data-new data-type='inline-entry'>\n<input data-disable-on-remove name='model[compatible_ids][]' type='hidden' value='{{>id}}'>\n<div class='line-col col2of3 text-align-left'>\n{{>name()}}\n</div>\n<div class='line-col col1of3 text-align-right'>\n<button class='button small inset' data-remove type='button'>Remove</button>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/models/form/package_inline_entry","<div class='row line font-size-xs focus-hover-thin' data-new data-type='inline-entry'>\n{{for data}}\n<input name='model[packages][{{>~uid}}]{{>name}}' type='hidden' value='{{>value}}'>\n{{/for}}\n{{for children}}\n<input name='model[packages][{{>~uid}}][children][id][]' type='hidden' value='{{>id}}'>\n{{/for}}\n<div class='line-col col1of4 text-align-left'>\n{{jed 'Prepackaged'/}}\n</div>\n<div class='line-col col1of4 text-align-left'>\n<span class='grey-text'>{{jed 'not yet saved'/}}</span>\n</div>\n<div class='line-col col1of2 text-align-right'>\n<button class='button small inset' data-remove title='Remove' type='button'>\n<i class='fa fa-trash'></i>\n</button>\n<button class='button small inset' data-edit-package type='button'>Edit</button>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/models/form/package_inline_entry/updated_package_form_data","{{for data}}\n<input name='model[packages][{{>~uid}}]{{>name}}' type='hidden' value='{{>value}}'>\n{{/for}}\n{{for children}}\n<input name='model[packages][{{>~uid}}][children][id][]' type='hidden' value='{{>id}}'>\n{{/for}}\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/models/form/property_inline_entry","<div class='row line font-size-xs focus-hover-thin' data-type='inline-entry' date-new>\n<div class='line-col col1of10 text-align-left no-padding text-align-center cursor-move' data-type='sort-handle'>\n<i class='fa fa-resize-vertical'></i>\n</div>\n<div class='line-col col4of10 no-padding'>\n<input class='small width-full' name='model[properties_attributes][][key]' type='text'>\n</div>\n<div class='line-col col4of10'>\n<input class='small width-full' name='model[properties_attributes][][value]' type='text'>\n</div>\n<div class='line-col col1of10 text-align-right'>\n<button class='button small inset' data-remove title='Remove'>\n<i class='fa fa-trash'></i>\n</button>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/models/line","<div class='line row focus-hover-thin' data-id='{{>id}}' data-is_package='{{>is_package}}' data-type='model'>\n<div class='col1of10 line-col text-align-center no-padding'>\n<div class='table'>\n<div class='table-row'>\n<div class='table-cell vertical-align-middle'>\n<img class='max-width-xxs max-height-xxs' src='/models/{{>id}}/image_thumb'>\n</div>\n</div>\n</div>\n</div>\n<div class='col4of10 line-col text-align-left'>\n{{if is_package}}\n<div class='grey-text'>{{jed 'Package'/}}</div>\n{{/if}}\n<strong>\n{{> name()}}\n</strong>\n</div>\n<div class='col3of10 line-col text-align-center'>\n<span title='{{jed 'in stock'/}}'>{{> availability().in_stock}}</span>\n/\n<span title='{{jed 'rentable'/}}'>{{> availability().total_rentable}}</span>\n</div>\n<div class='col2of8 line-col line-actions padding-right-xs'>\n<div class='multibutton width-full text-align-right'>\n<a class='button white text-ellipsis col4of5 negative-margin-right-xxs' href='{{>url('edit')}}' title='{{jed 'Edit Model'/}}'>\n{{jed \"Edit Model\"/}}\n</a>\n<div class='dropdown-holder inline-block col1of5'>\n<div class='button white dropdown-toggle width-full no-padding text-align-center'>\n<div class='arrow down'></div>\n</div>\n<ul class='dropdown right'>\n<li>\n<a class='dropdown-item' data-model-id='{{>id}}' data-open-time-line>\n<i class='fa fa-align-left'></i>\n{{jed \"Timeline\"/}}\n</a>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/models/packages/item","<div class='row emboss padding-bottom-xxs margin-bottom-xxs' data-id='{{>id}}' data-new data-type='inline-entry'>\n<div class='row padding-inset-xxs'>\n<div class='col1of4 padding-left-s padding-top-xs'>\n<strong class='font-size-m inline-block'>\n{{>inventory_code}}\n</strong>\n</div>\n<div class='col2of4 padding-top-xs'>\n{{>model().name()}}\n</div>\n<div class='col1of4 text-align-right'>\n<button class='button small inset' data-remove type='button'>Remove</button>\n</div>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/models/packages/item_autocomplete_element","<li class='separated-bottom exclude-last-child'>\n<a>\n<div class='row text-ellipsis'>\n<div class='col1of3'>\n<strong>{{>inventory_code}}</strong>\n</div>\n<div class='col2of3'>\n{{>model().name()}}\n</div>\n</div>\n</a>\n</li>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/models/packages/missing_data_error","<div class='padding-horizontal-m padding-bottom-m'>\n<div class='row emboss red text-align-center font-size-m padding-inset-s'>\n<strong>{{jed 'Please provide all required fields'/}}</strong>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/models/packages/no_items_error","<div class='padding-horizontal-m padding-bottom-m'>\n<div class='row emboss red text-align-center font-size-m padding-inset-s'>\n<strong>{{jed 'You can not create a package without any item'/}}</strong>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/models/packages/package_dialog","<div class='modal medium hide fade ui-modal padding-vertical-m' role='dialog' tabindex='-1'>\n<div class='row padding-vertical-m padding-horizontal-l'>\n<div class='col1of2'>\n<h3 class='headline-l'>{{jed \"Package\"/}}</h3>\n</div>\n<div class='col1of2'>\n<div class='float-right'>\n<a aria-hidden='true' class='modal-close weak' data-dismiss='modal' title='{{jed \"close dialog\"/}}' type='button'>\n{{jed \"Cancel\"/}}\n</a>\n<button class='button green' id='save-package' type='button'>\n{{jed \"Save Package\"/}}\n</button>\n</div>\n</div>\n</div>\n<div class='hidden' id='notifications'></div>\n<div class='modal-body row padding-horizontal-l'>\n<div class='margin-bottom-m'>\n<h2 class='headline-m padding-bottom-m'>{{jed 'Items'/}}</h2>\n<div class='row emboss margin-vertical-xxs margin-right-xs'>\n<div class='row padding-inset-xs'>\n<div class='col1of2 padding-vertical-xs'>\n<strong class='font-size-m inline-block'>{{jed 'Add item'/}}</strong>\n</div>\n<div class='col1of2'>\n<div class='row'>\n<input autocomplete='off' class='width-full has-addon' data-barcode-scanner-target id='search-item' type='text'>\n<div class='addon transparent'>\n<span class='arrow down'></span>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class='row' id='items'></div>\n</div>\n<form class='padding-top-s' id='item-form'>\n<div id='flexible-fields'>\n<div class='height-s'></div>\n<img class='margin-horziontal-auto margin-top-xxl margin-bottom-xxl' src='/assets/loading-5ed385f71ca1eb04ca01faecb9f7973d.gif'>\n<div class='height-s'></div>\n</div>\n</form>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/models/timeline_modal","<div class='modal large hide fade ui-modal padding-inset-m padding-horizontal-l' role='dialog' tabindex='-1'>\n<div class='row padding-vertical-m'>\n<div class='col1of2'>\n<h3 class='headline-l'>{{jed \"Availability Timeline\"/}}</h3>\n<h3 class='headline-s light'>{{>name()}}</h3>\n</div>\n<div class='col1of2'>\n<div class='float-right'>\n<a aria-hidden='true' class='modal-close weak' data-dismiss='modal' title='{{jed \"close dialog\"/}}' type='button'>\n{{jed \"Cancel\"/}}\n</a>\n<button aria-hidden='true' class='button modal-close text-ellipsis weak white' data-dismiss='modal' title='{{jed \"close dialog\"/}}' type='button'>\n{{jed \"Close\"/}}\n</button>\n</div>\n</div>\n</div>\n<div class='row margin-top-m'>\n<div class='modal-body no-padding'>\n<div class='row'>\n<div class='position-absolute-topright width-full text-align-center'>\n<div id='loading'>\n<div class='height-m'></div>\n{{partial \"views/loading\"/}}\n</div>\n</div>\n<iframe height='500px' id='timeline' src='/manage/{{current_inventory_pool_id/}}/models/{{>id}}/timeline' width='100%'></iframe>\n</div>\n<div class='row text-align-right'>\n<a class='button white modal-close' href='/manage/{{current_inventory_pool_id/}}/models/{{>id}}/timeline' target='_blank'>\n<i class='fa fa-resize-full'></i>\n</a>\n</div>\n</div>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/models/tooltip","<div class='row width-xxl font-size-m'>\n{{if image_url}}\n<p>\n<img class='max-size-xxs margin-horziontal-auto' src='{{>image_url/}}'>\n</p>\n{{/if}}\n<div class='row'>\n<div class='col1of3 text-align-right padding-right-s'>\n{{jed \"Product\"/}}:\n</div>\n<div class='col2of3'>\n<strong>{{>product}}</strong>\n</div>\n</div>\n<div class='row'>\n<div class='col1of3 text-align-right padding-right-s'>\n{{jed \"Version\"/}}:\n</div>\n<div class='col2of3'>\n<strong>{{>version}}</strong>\n</div>\n</div>\n<div class='row'>\n<div class='col1of3 text-align-right padding-right-s'>\n{{jed \"Manufacturer\"/}}:\n</div>\n<div class='col2of3'>\n<strong>{{>manufacturer}}</strong>\n</div>\n</div>\n<div class='row'>\n<div class='col1of3 text-align-right padding-right-s'>\n{{jed \"Description\"/}}:\n</div>\n<div class='col2of3'>\n<strong>{{>description}}</strong>\n</div>\n</div>\n<div class='row'>\n<div class='col1of3 text-align-right padding-right-s'>\n{{jed \"Internal Description\"/}}:\n</div>\n<div class='col2of3'>\n<strong>{{>internal_description}}</strong>\n</div>\n</div>\n<div class='row'>\n<div class='col1of3 text-align-right padding-right-s'>\n{{jed \"Technical Details\"/}}:\n</div>\n<div class='col2of3'>\n<strong>{{>technical_detail}}</strong>\n</div>\n</div>\n<div class='row'>\n<div class='col1of3 text-align-right padding-right-s'>\n{{jed \"Important notes for hand over\"/}}:\n</div>\n<div class='col2of3'>\n<strong>{{>hand_over_note}}</strong>\n</div>\n</div>\n<div class='row'>\n<div class='col1of3 text-align-right padding-right-s'>\n{{jed \"Accessories\"/}}:\n</div>\n<div class='col2of3'>\n<strong>{{>accessory_names}}</strong>\n</div>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/options/line","<div class='line row focus-hover-thin' data-id='{{>id}}' data-type='option'>\n<div class='col1of5 line-col text-align-center'>{{>inventory_code}}</div>\n<div class='col2of5 line-col text-align-left'>\n<strong>{{> name()}}</strong>\n</div>\n<div class='col1of5 line-col text-align-center'>\n{{money price/}}\n</div>\n<div class='col1of5 line-col line-actions padding-right-xs'>\n<a class='button white text-ellipsis' href='{{>url('edit')}}'>\n{{jed \"Edit Option\"/}}\n</a>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/purposes/cell","{{if concatenatedPurposes().length > 60}}\n<span class='tooltip' data-tooltip-template='manage/views/purposes/tooltip' title='{{>concatenatedPurposes()}}'>\n{{truncate concatenatedPurposes() 60 \"...\"/}}\n</span>\n{{else}}\n{{> concatenatedPurposes()}}\n{{/if}}\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/purposes/tooltip","<div class='width-xl padding-inset-s'>\n<p class='paragraph-s'>{{>content}}</p>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/reservations/add/adding","<div class='emboss blue padding-inset-s'>\n<p class='paragraph-s'>\n<img class='margin-right-s max-width-micro' src='/assets/loading-5ed385f71ca1eb04ca01faecb9f7973d.gif'>\n<strong>\n{{jed \"Adding item\"/}}\n</strong>\n</p>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/reservations/add/autocomplete_element","<li class='separated-bottom exclude-last-child'>\n<a class='row{{if available}}{{else}} light-red{{/if}}' title='{{>name}}'>\n<div class='row'>\n<div class='col3of4' title='{{>name}}'>\n<strong class='wrap'>\n{{>name}}\n</strong>\n</div>\n<div class='col1of4 text-align-right'>\n<div class='row'>\n{{if availability}}\n{{>availability}}\n{{/if}}\n</div>\n<div class='row'>\n<span class='grey-text'>{{>type}}</span>\n</div>\n</div>\n</div>\n</a>\n</li>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/reservations/assign/autocomplete_element","<li class='separated-bottom exclude-last-child width-xl'>\n<a>\n<div class='row'>\n<div class='col1of3'>\n<strong>\n{{>inventoryCode}}\n</strong>\n</div>\n<div class='col2of3 text-ellipsis' title='{{>name}}'>\n<span class='grey-text'>{{>name}}</span>\n</div>\n</div>\n</a>\n</li>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/reservations/cell",'{{>quantity()}}\n{{jed quantity() "Item" "Items"/}}\n')}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/reservations/explorative_add_dialog","<div class='modal fade ui-modal medium' role='dialog' tabindex='-1'>\n<div class='modal-header row padding-bottom-s'>\n<div class='col4of5'>\n<h2 class='headline-l'>{{jed 'Models'/}} {{jed 'by browsing categories'/}}</h2>\n<h3 class='headline-m light'>({{date startDate/}} - {{date endDate/}})</h3>\n</div>\n<div class='col1of5 text-align-right'>\n<div class='modal-close'>{{jed \"Cancel\"/}}</div>\n</div>\n</div>\n<div class='modal-body separated-top'>\n<div class='table'>\n<div class='table-row'>\n<div class='col1of4 table-cell separated-right padding-inset-m' id='categories'>\n<div class='row padding-inset-s'>\n<input autocomplete='off' class='small' id='category-search' placeholder='{{jed 'Search category'/}}' type='text'>\n</div>\n<div id='category-root'></div>\n<div id='category-current'></div>\n<div class='row padding-bottom-s' id='category-list'>\n<div class='height-xs'></div>\n<img class='margin-horziontal-auto margin-top-xxl margin-bottom-xxl' src='/assets/loading-5ed385f71ca1eb04ca01faecb9f7973d.gif'>\n</div>\n</div>\n<div class='table-cell col3of4 list-of-lines even min-height-l' id='models'>\n<div class='height-s'></div>\n<img class='margin-horziontal-auto margin-top-xxl margin-bottom-xxl' src='/assets/loading-5ed385f71ca1eb04ca01faecb9f7973d.gif'>\n<div class='height-s'></div>\n</div>\n</div>\n</div>\n</div>\n<div class='modal-footer'></div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/reservations/grouped_lines","<div class='emboss deep padding-bottom-s margin-bottom-m' data-selected-lines-container>\n<div class='row'>\n<div class='col1of2 padding-vertical-s'>\n<label class='padding-inset-s inline'>\n<input autocomplete='off' data-select-lines type='checkbox'>\n</label>\n<p class='paragraph-s inline'>\n{{day start_date/}}\n{{date start_date/}}\n-\n{{day end_date/}}\n{{date end_date/}}\n</p>\n</div>\n<div class='col1of2 padding-inset-s text-align-right'>\n<p class='paragraph-s inline'>\n{{diffDatesInDays start_date end_date/}}\n</p>\n</div>\n</div>\n<div class='row'>\n{{partial ~linePartial reservations #view.ctx/}}\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/reservations/grouped_lines_with_action_date",'<h3 class=\'headline-s padding-inset-s\'>\n{{if ~moment(date).endOf("day").diff(~moment().endOf("day"), "days") == 0}}\n<strong>{{jed "Today"/}}</strong>\n{{else}}\n{{day date/}}\n{{date date/}}\n{{/if}}\n</h3>\n{{partial "manage/views/reservations/grouped_lines" groups #view.ctx/}}\n')}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/reservations/hand_over_line","{{if model_id}}\n{{partial 'manage/views/reservations/hand_over_line/item_line' #view.data #view.ctx/}}\n{{else option_id}}\n{{partial 'manage/views/reservations/hand_over_line/option_line' #view.data #view.ctx/}}\n{{/if}}\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/reservations/hand_over_line/assigned_item","<input autocomplete='off' class='small width-full has-addon text-align-center' data-assign-item disabled id='assigned-item-{{>id}}' type='text' value='{{>item().inventory_code}}'>\n<label class='addon small transparent no-padding' data-remove-assignment for='assigned-item-{{>id}}'>\n<span class='link grey padding-inset-xs vertical-align-middle'>\n<i class='fa fa-times-circle'></i>\n</span>\n</label>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/reservations/hand_over_line/item_line","<div class='line light row focus-hover-thin' data-id='{{>id}}' data-line-type='item_line'>\n<div class='{{if ~renderAvailability && anyProblems()}}line-info red{{/if}}'></div>\n<div class='line-col padding-left-xs'>\n<div class='row'>\n<div class='col1of4'>\n<label class='padding-inset-s'>\n<input autocomplete='off' data-select-line type='checkbox'>\n</label>\n</div>\n</div>\n</div>\n<div class='col2of10 line-col text-align-center'>\n<div class='row'>\n{{if item()}}\n{{partial 'manage/views/reservations/hand_over_line/assigned_item' #view.data/}}\n{{else}}\n{{partial 'manage/views/reservations/hand_over_line/unassigned_item' #view.data/}}\n{{/if}}\n</div>\n</div>\n<div class='col4of10 line-col text-align-left'>\n<strong data-id='{{>model().id}}' data-type='model-cell'>\n{{>model().name()}}\n</strong>\n{{if item() && item().children().all().length}}\n<ul style='font-size: 0.8em; list-style-type: disc; margin-left: 1.5em;'>\n{{for item().children().all()}}\n<li>\n{{>to_s}}\n</li>\n{{/for}}\n</ul>\n{{/if}}\n{{if model().accessory_names && model().accessory_names.length}}\n<br>\n<span>{{>model().accessory_names}}</span>\n{{/if}}\n{{if model().hand_over_note}}\n<br>\n<span class='grey-text'>{{>model().hand_over_note}}</span>\n{{/if}}\n</div>\n<div class='col1of10 line-col text-align-center'>\n{{if purpose_id}}\n<div class='tooltip' data-tooltip-template='manage/views/purposes/tooltip' title='{{>purpose().description}}'>\n<i class='fa fa-comment grey'></i>\n</div>\n{{/if}}\n</div>\n<div class='col1of10 line-col text-align-center'>\n{{if ~renderAvailability && anyProblems()}}\n<div class='emboss red padding-inset-xxs-alt text-align-center tooltip' data-tooltip-data='{{JSON getProblems()/}}' data-tooltip-template='manage/views/reservations/problems_tooltip'>\n<strong>{{>getProblems().length}}</strong>\n</div>\n{{/if}}\n</div>\n<div class='col2of10 line-col line-actions padding-left-xxs padding-right-s'>\n<div class='multibutton'>\n<button class='button white text-ellipsis' data-edit-lines data-ids='{{JSON [id]/}}'>{{jed \"Change entry\"/}}</button>\n<div class='dropdown-holder inline-block'>\n<div class='button white dropdown-toggle'>\n<div class='arrow down'></div>\n</div>\n<ul class='dropdown right'>\n<li>\n<a class='dropdown-item' data-model-id='{{>model().id}}' data-open-time-line>\n<i class='fa fa-align-left'></i>\n{{jed \"Timeline\"/}}\n</a>\n</li>\n<li>\n<a class='dropdown-item' data-swap-model>\n<i class='fa fa-exchange'></i>\n{{jed \"Swap Model\"/}}\n</a>\n</li>\n<li>\n<a class='dropdown-item red' data-destroy-line>\n<i class='fa fa-trash'></i>\n{{jed \"Delete\"/}}\n</a>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/reservations/hand_over_line/option_line","<div class='line light row focus-hover-thin' data-id='{{>id}}' data-line-type='option_line'>\n<div class='line-info{{if ~renderAvailability && anyProblems()}} red{{/if}}'></div>\n<div class='line-col padding-left-xs'>\n<div class='row'>\n<div class='col1of4'>\n<label class='padding-inset-s'>\n<input autocomplete='off' data-select-line type='checkbox'>\n</label>\n</div>\n</div>\n</div>\n<div class='col1of10 line-col'>\n<input class='small width-full text-align-center' data-line-quantity type='text' value='{{>quantity}}'>\n</div>\n<div class='col1of10 line-col text-align-center'>\n<span class='grey-text'>{{>option().inventory_code}}</span>\n</div>\n<div class='col4of10 line-col text-align-left'>\n<strong>{{>option().name()}}</strong>\n</div>\n<div class='col1of10 line-col text-align-center'>\n{{if purpose_id}}\n<div class='tooltip' data-tooltip-template='manage/views/purposes/tooltip' title='{{>purpose().description}}'>\n<i class='fa fa-comment grey'></i>\n</div>\n{{/if}}\n</div>\n<div class='col1of10 line-col text-align-center'>\n{{if ~renderAvailability && anyProblems()}}\n<div class='emboss red padding-inset-xxs-alt text-align-center tooltip' data-tooltip-data='{{JSON getProblems()/}}' data-tooltip-template='manage/views/reservations/problems_tooltip'>\n<strong>{{>getProblems().length}}</strong>\n</div>\n{{else ~renderAvailability && !anyProblems()}}\n<div class='padding-inset-xxs-alt text-align-center'>\n<i class='fa fa-check'></i>\n</div>\n{{/if}}\n</div>\n<div class='col2of10 line-col line-actions padding-left-xxs padding-right-s'>\n<div class='multibutton'>\n<button class='button white text-ellipsis' data-edit-lines data-ids='{{JSON [id]/}}'>{{jed 'Change entry'/}}</button>\n<div class='dropdown-holder inline-block'>\n<div class='button white dropdown-toggle'>\n<div class='arrow down'></div>\n</div>\n<ul class='dropdown right'>\n<li>\n<a class='dropdown-item' data-model-id='{{>model().id}}' data-open-time-line>\n<i class='fa fa-align-left'></i>\n{{jed \"Timeline\"/}}\n</a>\n</li>\n<li>\n<a class='dropdown-item red' data-destroy-line>\n<i class='fa fa-trash'></i>\n{{jed \"Delete\"/}}\n</a>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/reservations/hand_over_line/unassigned_item","<form data-assign-item-form>\n<input autocomplete='off' class='small width-full has-addon text-align-center' data-assign-item id='assigned-item-{{>id}}' type='text'>\n<label class='addon small transparent padding-right-s' for='assigned-item-{{>id}}'>\n<div class='arrow down'></div>\n</label>\n</form>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/reservations/order_line","<div class='order-line line light row focus-hover-thin' data-ids='{{JSON ids/}}'>\n<div class='line-info{{if ~renderAvailability && anyProblems()}} red{{/if}}'></div>\n<div class='line-col padding-left-xs'>\n<div class='row'>\n<div class='col1of4'>\n<label class='padding-inset-s'>\n<input autocomplete='off' data-select-line type='checkbox'>\n</label>\n</div>\n</div>\n</div>\n<div class='col1of10 line-col text-align-center'>\n<span>\n{{if subreservations}}\n{{sum subreservations \"quantity\"/}}\n{{else}}\n{{>quantity}}\n{{/if}}\n</span>\n{{if ~renderAvailability}}\n<span class='grey-text'>\n/\n{{if subreservations}}\n{{>model().availability().withoutLines(subreservations).maxAvailableForGroups(start_date, end_date, user().groupIds)}}\n{{else}}\n{{>model().availability().withoutLines([#view.data]).maxAvailableForGroups(start_date, end_date, user().groupIds)}}\n{{/if}}\n</span>\n{{/if}}\n</div>\n<div class='col6of10 line-col text-align-left'>\n<strong data-id='{{>model().id}}' data-type='model-cell'>\n{{>model().name()}}\n</strong>\n</div>\n<div class='col1of10 line-col text-align-left padding-horizontal-m'>\n{{if ~renderAvailability && anyProblems()}}\n<div class='emboss red padding-inset-xxs-alt text-align-center tooltip' data-tooltip-data='{{JSON getProblems()/}}' data-tooltip-template='manage/views/reservations/problems_tooltip'>\n<strong>{{>getProblems().length}}</strong>\n</div>\n{{/if}}\n</div>\n<div class='col2of10 line-col line-actions'>\n<div class='multibutton'>\n<button class='button white text-ellipsis' data-edit-lines data-ids='{{JSON ids/}}'>\n{{jed \"Change entry\"/}}\n</button>\n<div class='dropdown-holder inline-block'>\n<div class='button white dropdown-toggle'>\n<div class='arrow down'></div>\n</div>\n<ul class='dropdown right'>\n<li>\n<a class='dropdown-item' data-model-id='{{>model_id}}' data-open-time-line>\n<i class='fa fa-align-left'></i>\n{{jed \"Timeline\"/}}\n</a>\n</li>\n<li>\n<a class='dropdown-item' data-swap-model>\n<i class='fa fa-exchange'></i>\n{{jed \"Swap Model\"/}}\n</a>\n</li>\n<li>\n<a class='dropdown-item red' data-destroy-lines data-ids='{{JSON ids/}}'>\n<i class='fa fa-trash'></i>\n{{jed \"Delete\"/}}\n</a>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/reservations/problems_tooltip","<div class='width-m'>\n{{for content}}\n<div class='padding-vertical-xxs'>\n<div class='padding-inset-s emboss'>\n<strong class='font-size-m'>{{>message}}</strong>\n</div>\n</div>\n{{/for}}\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/reservations/removing","<div class='emboss blue padding-inset-s'>\n<p class='paragraph-s'>\n<img class='margin-right-s max-width-micro' src='/assets/loading-5ed385f71ca1eb04ca01faecb9f7973d.gif'>\n<strong>\n{{jed \"Removing items\"/}}\n</strong>\n</p>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/reservations/take_back_line","{{if model_id}}\n{{partial 'manage/views/reservations/take_back_line/item_line' #view.data #view.ctx/}}\n{{else option_id}}\n{{partial 'manage/views/reservations/take_back_line/option_line' #view.data #view.ctx/}}\n{{/if}}\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/reservations/take_back_line/item_line","<div class='line light row focus-hover-thin' data-id='{{>id}}' data-line-type='item_line'>\n<div class='line-info{{if ~renderAvailability && anyProblems()}} red{{/if}}'></div>\n<div class='line-col padding-left-xs'>\n<div class='row'>\n<div class='col1of4'>\n<label class='padding-inset-s'>\n<input autocomplete='off' data-select-line type='checkbox'>\n</label>\n</div>\n</div>\n</div>\n<div class='col2of10 line-col text-align-center'>\n<div class='row'>{{>item().inventory_code}}</div>\n</div>\n<div class='col4of10 line-col text-align-left'>\n<strong data-id='{{>model().id}}' data-type='model-cell'>\n{{>model().name()}}\n</strong>\n{{if model().accessory_names && model().accessory_names.length}}\n<br>\n<span>{{>model().accessory_names}}</span>\n{{/if}}\n</div>\n<div class='col1of10 line-col text-align-center'>\n{{if purpose_id}}\n<div class='tooltip' data-tooltip-template='manage/views/purposes/tooltip' title='{{>purpose().description}}'>\n<i class='fa fa-comment grey'></i>\n</div>\n{{/if}}\n</div>\n<div class='col1of10 line-col text-align-center'>\n{{if ~renderAvailability && anyProblems()}}\n<div class='emboss red padding-inset-xxs-alt text-align-center tooltip' data-tooltip-data='{{JSON getProblems()/}}' data-tooltip-template='manage/views/reservations/problems_tooltip'>\n<strong>{{>getProblems().length}}</strong>\n</div>\n{{else ~renderAvailability && !anyProblems() && item()}}\n<div class='padding-inset-xxs-alt text-align-center'>\n<i class='fa fa-check'></i>\n</div>\n{{/if}}\n</div>\n<div class='col2of10 line-col line-actions padding-left-xxs padding-right-s'>\n<div class='multibutton'>\n<button class='button white text-ellipsis' data-edit-lines data-ids='{{JSON [id]/}}'>{{jed \"Change entry\"/}}</button>\n<div class='dropdown-holder inline-block'>\n<div class='button white dropdown-toggle'>\n<div class='arrow down'></div>\n</div>\n<ul class='dropdown right'>\n<li>\n<a class='dropdown-item' href='{{>contract().url()}}' target='_blank'>\n<i class='fa fa-file-alt'></i>\n{{jed \"Contract\"/}}\n{{>contract().compact_id}}\n</a>\n</li>\n<li>\n<a class='dropdown-item' data-model-id='{{>model().id}}' data-open-time-line>\n<i class='fa fa-align-left'></i>\n{{jed \"Timeline\"/}}\n</a>\n</li>\n<li>\n<a class='dropdown-item' data-inspect-item data-item-id='{{>item_id}}'>\n<i class='fa fa-search'></i>\n{{jed \"Inspect\"/}}\n</a>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n");
}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/reservations/take_back_line/option_line","<div class='line light row focus-hover-thin' data-id='{{>id}}' data-line-type='option_line'>\n<div class='line-info{{if ~renderAvailability && anyProblems()}} red{{/if}}'></div>\n<div class='line-col padding-left-xs'>\n<div class='row'>\n<div class='col1of4'>\n<label class='padding-inset-s'>\n<input autocomplete='off' data-select-line type='checkbox'>\n</label>\n</div>\n</div>\n</div>\n<div class='col1of10 line-col'>\n<div class='row table'>\n<div class='table-row'>\n<div class='col2of3 table-cell vertical-align-middle line-height-xxl'>\n<input autocomplete='off' class='small width-full text-align-center' data-quantity-returned inputmode='numeric' type='text'>\n</div>\n<div class='col1of3 table-cell vertical-align-middle line-height-xxl'>\n<span>/{{>quantity}}</span>\n</div>\n</div>\n</div>\n</div>\n<div class='col1of10 line-col text-align-center'>\n<span class='grey-text'>{{>option().inventory_code}}</span>\n</div>\n<div class='col4of10 line-col text-align-left'>\n<strong>{{>option().name()}}</strong>\n</div>\n<div class='col1of10 line-col text-align-center'>\n{{if purpose_id}}\n<div class='tooltip' data-tooltip-template='manage/views/purposes/tooltip' title='{{>purpose().description}}'>\n<i class='fa fa-comment grey'></i>\n</div>\n{{/if}}\n</div>\n<div class='col1of10 line-col text-align-center'>\n{{if ~renderAvailability && anyProblems()}}\n<div class='emboss red padding-inset-xxs-alt text-align-center tooltip' data-tooltip-data='{{JSON getProblems()/}}' data-tooltip-template='manage/views/reservations/problems_tooltip'>\n<strong>{{>getProblems().length}}</strong>\n</div>\n{{else ~renderAvailability && !anyProblems()}}\n<div class='padding-inset-xxs-alt text-align-center'>\n<i class='fa fa-check'></i>\n</div>\n{{/if}}\n</div>\n<div class='col2of10 line-col line-actions padding-left-xxs padding-right-s'>\n<div class='multibutton'>\n<button class='button white text-ellipsis' data-edit-lines data-ids='{{JSON [id]/}}'>{{jed \"Change entry\"/}}</button>\n<div class='dropdown-holder inline-block'>\n<div class='button white dropdown-toggle'>\n<div class='arrow down'></div>\n</div>\n<ul class='dropdown right'>\n<li>\n<a class='dropdown-item' href='{{>contract().url()}}' target='_blank'>\n<i class='fa fa-file-alt'></i>\n{{jed \"Contract\"/}}\n{{>contract().compact_id}}\n</a>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/reservations/tooltip","<div class='min-width-l'>\n{{for groupedLinesByDateRange(true)}}\n<div class='exclude-last-child padding-bottom-m margin-bottom-m no-last-child-margin'>\n<div class='row margin-bottom-s'>\n<div class='col1of2'>\n<span>\n{{date start_date/}}\n-\n{{date end_date/}}\n</span>\n</div>\n<div class='col1of2 text-align-right'>\n<strong>{{diffDatesInDays start_date end_date/}}</strong>\n</div>\n</div>\n{{for reservations}}\n<div class='row padding-top-xs'>\n<div class='col1of8 text-align-center'>\n<div class='paragraph-s line-height-s'>\n{{if ~quantity}}\n{{>~quantity}}\n{{else subreservations}}\n{{sum subreservations \"quantity\"/}}\n{{else}}\n{{>quantity}}\n{{/if}}\n</div>\n</div>\n<div class='col7of8'>\n<div class='paragraph-s line-height-s text-ellipsis width-full padding-right-s'>\n<strong>{{>model().name()}}</strong>\n</div>\n</div>\n</div>\n{{/for}}\n</div>\n{{/for}}\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/software/line","<div class='line row focus-hover-thin' data-id='{{>id}}' data-is_package='{{>is_package}}' data-type='model'>\n<div class='col1of10 line-col text-align-center no-padding'>\n<div class='table'>\n<div class='table-row'>\n<div class='table-cell vertical-align-middle'>\n<img class='max-width-xxs max-height-xxs' src='/models/{{>id}}/image_thumb'>\n</div>\n</div>\n</div>\n</div>\n<div class='col4of10 line-col text-align-left'>\n{{if is_package}}\n<div class='grey-text'>{{jed 'Package'/}}</div>\n{{/if}}\n<strong>\n{{> name()}}\n</strong>\n</div>\n<div class='col3of10 line-col text-align-center'>\n<span title='{{jed 'in stock'/}}'>{{> availability().in_stock}}</span>\n/\n<span title='{{jed 'rentable'/}}'>{{> availability().total_rentable}}</span>\n</div>\n<div class='col2of8 line-col line-actions padding-right-xs'>\n<div class='multibutton width-full text-align-right'>\n<a class='button white text-ellipsis col4of5 negative-margin-right-xxs' href='{{>url('edit')}}' title='{{jed 'Edit Software'/}}'>\n{{jed \"Edit Software\"/}}\n</a>\n<div class='dropdown-holder inline-block col1of5'>\n<div class='button white dropdown-toggle width-full no-padding text-align-center'>\n<div class='arrow down'></div>\n</div>\n<ul class='dropdown right'>\n<li>\n<a class='dropdown-item' data-model-id='{{>id}}' data-open-time-line>\n<i class='fa fa-align-left'></i>\n{{jed \"Timeline\"/}}\n</a>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(){$.views.tags({current_inventory_pool_id:function(){return App.InventoryPool.current.id}})}.call(this),function(){$.views.tags({dailyPath:function(){return App.InventoryPool.current.url("daily")}})}.call(this),function(e){e.views.templates("manage/views/take_backs/line","<div class='line row focus-hover-thin' data-id='{{>id}}' data-type='take_back'>\n{{if isOverdue()}}\n<div class='line-info red'></div>\n{{/if}}\n{{partial 'manage/views/users/cell' user() '{\"grid\":\"col1of5\"}'/}}\n<div class='col1of5 line-col'>\n{{if isOverdue()}}\n<strong>{{diffToday date/}}</strong>\n{{else}}\n{{diffToday date/}}\n{{/if}}\n</div>\n<div class='col1of5 line-col text-align-center' data-type='lines-cell'>{{include tmpl='manage/views/reservations/cell'/}}</div>\n{{if isOverdue()}}\n<div class='col1of5 line-col latest-reminder-cell text-align-center' data-user-id='{{>user().id}}' data-visit-id='{{>id}}'>\n{{jed \"Latest reminder\"/}}\n<i class='fa fa-envelope-alt'></i>\n</div>\n{{else}}\n<div class='col1of5 line-col text-align-center'>\n{{>getMaxRange()}}\n{{jed getMaxRange() \"day\" \"days\"/}}\n</div>\n{{/if}}\n<div class='col1of5 line-col line-actions'>\n{{if isOverdue()}}\n<div class='multibutton'>\n<a class='button white text-ellipsis' href='/manage/{{>inventory_pool_id}}/users/{{>user().id}}/take_back'>\n<i class='fa fa-mail-reply'></i>\n{{jed \"Take Back\"/}}\n</a>\n<div class='dropdown-holder inline-block'>\n<div class='button white dropdown-toggle'>\n<div class='arrow down'></div>\n</div>\n<ul class='dropdown right'>\n<li>\n<a class='dropdown-item' data-send-takeback-reminder data-user-id='{{>user().id}}'>\n<i class='fa fa-envelope'></i>\n{{jed \"Send reminder\"/}}\n</a>\n</li>\n</ul>\n</div>\n</div>\n{{else}}\n<a class='button white text-ellipsis' href='/manage/{{>inventory_pool_id}}/users/{{>user().id}}/take_back'>\n<i class='fa fa-mail-reply'></i>\n{{jed \"Take Back\"/}}\n</a>\n{{/if}}\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/take_backs/reminder_send","<strong>{{jed \"Reminder sent\"/}}</strong>\n<i class='fa fa-envelope'></i>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/templates/models/autocomplete_element","<li class='separated-bottom exclude-last-child'>\n<a>\n<div class='row'>\n{{>name()}}\n</div>\n</a>\n</li>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/templates/models/model_allocation_entry","<div class='row line font-size-xs' data-new data-type='inline-entry'>\n<input name='template[model_links_attributes][][model_id]' type='hidden' value='{{>id}}'>\n<div class='line-col col2of6 no-padding'>\n<div class='line-col col1of2' data-quantities>\n<input autocomplete='off' class='width-full small text-align-center' max='{{>availability().total_rentable}}' min='1' name='template[model_links_attributes][][quantity]' type='text' value='1'>\n</div>\n<div class='line-col col1of2 padding-left-xs text-align-left' data-quantities>\n/ {{>availability().total_rentable}}\n</div>\n</div>\n<div class='line-col col3of6 text-align-left' data-model-name>\n{{>name()}}\n</div>\n<div class='line-col col1of6 text-align-right'>\n<button class='button inset small' data-remove>{{jed \"Remove\"/}}</button>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/templates/upload/image_inline_entry","<div class='row line font-size-xs focus-hover-thin' data-new data-type='inline-entry'>\n<div class='line-col text-align-center' title='{{jed 'File has to be uploaded on save'/}}'>\n<i class='fa fa-cloud-upload'></i>\n</div>\n<div class='line-col col1of10 text-align-center'>\n<img class='max-height-xxs max-width-xxs'>\n</div>\n<div class='line-col col6of10 text-align-left'>\n{{>name}}\n</div>\n<div class='line-col col3of10 text-align-right'>\n<button class='button small inset' data-remove type='button'>Remove</button>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/templates/upload/upload_errors_dialog","<div class='modal medium hide fade ui-modal padding-inset-m padding-horizontal-l' role='dialog' tabindex='-1'>\n<div class='row padding-vertical-m'>\n<div class='col2of3'>\n<h3 class='headline-l'>{{jed \"Upload problems\"/}}</h3>\n<h3 class='headline-s light'>\n{{>headlineMessage}}\n</h3>\n</div>\n<div class='col1of3'>\n<div class='float-right'>\n<a class='button white' href='{{>url}}'>\n{{>buttonLabel}}\n</a>\n</div>\n</div>\n</div>\n<div class='modal-body row margin-top-m'>\n<div class='emboss error padding-inset-s'>\n<p class='paragraph-s'>{{>errors}}</p>\n</div>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/templates/users/autocomplete_element","<li class='separated-bottom exclude-last-child'>\n<a>\n<div class='row'>\n{{>name()}}\n</div>\n</a>\n</li>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/templates/users/user_inline_entry","<div class='row line font-size-xs'>\n<input name='{{>~paramName}}' type='hidden' value='{{>id}}'>\n<div class='line-col col5of6 text-align-left' data-user-name>\n{{>name()}}\n</div>\n<div class='line-col col1of6 text-align-right'>\n<button class='button inset small' data-remove-user>{{jed \"Remove\"/}}</button>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/users/autocomplete_element","<li class='separated-bottom exclude-last-child'>\n<a class='row' title='{{>firstname}} {{>lastname}}'>\n<div class='row text-ellipsis'>\n<strong>\n{{>firstname}}\n{{>lastname}}\n</strong>\n</div>\n<div class='row text-ellipsis'>\n{{>address}}{{>city}}\n</div>\n</a>\n</li>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/users/cell","<div class='line-col {{>~grid}}'>\n<strong data-address='{{>address}}' data-badge_id='{{>badge_id}}' data-city='{{>city}}' data-email='{{>email}}' data-firstname='{{>firstname}}' data-id='{{>id}}' data-image_url='{{>image_url}}' data-lastname='{{>lastname}}' data-phone='{{>phone}}' data-type='user-cell' data-zip='{{>zip}}'>\n{{>firstname}} {{>lastname}}\n{{if isSuspended()}}\n<span class='darkred-text'>{{jed \"Suspended\"/}}!</span>\n{{/if}}\n</strong>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/users/hand_over/no_handover_found","<div class='emboss padding-inset-s'>\n<p class='paragraph-s'>\n<strong>\n{{jed \"No hand overs found\"/}}\n</strong>\n</p>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/users/hand_over_dialog","<div class='modal fade ui-modal medium' role='dialog' tabindex='-1'>\n<div class='modal-header row'>\n<div class='col3of5'>\n<h2 class='headline-l'>{{jed itemsCount \"Hand over of %s item\" \"Hand over of %s items\" itemsCount/}}</h2>\n<h3 class='headline-m light'>\n{{>user.firstname}} {{>user.lastname}}\n</h3>\n</div>\n<div class='col2of5 text-align-right'>\n<div class='modal-close'>{{jed \"Cancel\"/}}</div>\n<button class='button green' data-hand-over>\n<i class='fa fa-mail-forward'></i>\n{{jed \"Hand Over\"/}}\n</button>\n</div>\n</div>\n<div class='row margin-top-s padding-horizontal-l'>\n<div class='separated-bottom padding-bottom-m margin-bottom-m'>\n<p class='emboss red padding-inset-s hidden paragraph-s margin-bottom-s' id='error'>\n<strong></strong>\n</p>\n{{if user.isDelegation()}}\n<div class='row margin-bottom-l'>\n<div class='col1of3' id='contact-person'>\n<input autocomplete='off' autofocus='autofocus' class='width-full' data-barcode-scanner-target data-prevent-barcode-scanner-submit id='user-id' placeholder='{{jed 'Contact person'/}} {{jed 'Name / ID'/}}' type='text'>\n<div id='selected-user'></div>\n</div>\n</div>\n{{/if}}\n{{if purpose}}\n<div class='row margin-bottom-s emboss padding-inset-s'>\n<div class='col3of4'>\n<p class='paragraph-s'>{{>purpose}}</p>\n</div>\n<div class='col1of4 text-align-right'>\n{{if ~showAddPurpose}}\n<button class='button inset' id='add-purpose'>{{jed 'Add Purpose'/}}</button>\n{{/if}}\n</div>\n</div>\n{{/if}}\n<div class='{{if purpose}}hidden{{/if}}' id='purpose-input'>\n<div class='row padding-bottom-s'>\n<p>{{jed \"Please provide a purpose...\"/}}</p>\n</div>\n<textarea class='row height-xs' id='purpose' name='purpose'></textarea>\n</div>\n</div>\n<div class='modal-body'>\n{{for groupedLines}}\n<div class='padding-bottom-m margin-bottom-m no-last-child-margin'>\n<div class='row margin-bottom-s'>\n<div class='col1of2'>\n<p>\n{{date start_date/}}\n-\n{{date end_date/}}\n</p>\n</div>\n<div class='col1of2 text-align-right'>\n<strong>{{diffDatesInDays start_date end_date/}}</strong>\n</div>\n</div>\n{{for reservations}}\n<div class='row'>\n<div class='col1of8 text-align-center'>\n<div class='paragraph-s'>\n{{if subreservations}}\n{{sum subreservations \"quantity\"/}}\n{{else}}\n{{> quantity}}\n{{/if}}\n</div>\n</div>\n<div class='col7of8'>\n<div class='paragraph-s'>\n<strong>{{>model().name()}}</strong>\n</div>\n</div>\n</div>\n{{/for}}\n</div>\n{{/for}}\n</div>\n<div class='row separated-top padding-top-m padding-bottom-m'>\n<div class='col1of1 padding-bottom-s'>\n<p>{{jed \"Write a note... the note will be part of the contract\"/}}</p>\n</div>\n<textarea class='col1of1 height-xs' id='note' name='note'>{{>~currentInventoryPool.default_contract_note}}</textarea>\n</div>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/users/hand_over_documents_dialog","<div class='modal fade ui-modal medium min-height-m' role='dialog' tabindex='-1'>\n<div class='modal-header row'>\n<div class='col3of5'>\n<h2 class='headline-l'>{{jed \"Hand over completed\"/}}</h2>\n<h3 class='headline-m light'>\n{{jed itemsCount \"%s item\" \"%s items\" itemsCount/}}\n{{jed \"to %s\" contract.user().name()/}}\n</h3>\n</div>\n<div class='col2of5 text-align-right'>\n<div class='multibutton'>\n<a class='button white text-ellipsis' href='{{dailyPath/}}'>{{jed \"Finish this hand over\"/}}</a>\n<div class='dropdown-holder inline-block'>\n<div class='button white dropdown-toggle'>\n<div class='arrow down'></div>\n</div>\n<ul class='dropdown right'>\n<li>\n<a class='dropdown-item' href=''>\n<i class='fa fa-undo'></i>\n{{jed \"Back to this user\"/}}\n</a>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n<div class='modal-body'>\n<div class='padding-inset-l margin-top-s'>\n<div class='row emboss padding-inset-s margin-bottom-s'>\n<div class='col1of3'></div>\n<div class='col1of3'>\n<a class='button white width-full' href='{{>contract.url()}}' target='_blank'>\n<i class='fa fa-file-alt'></i>\n{{jed \"Contract\"/}}\n</a>\n</div>\n<div class='col1of3'></div>\n</div>\n<div class='row emboss padding-inset-s margin-bottom-s'>\n<div class='col1of3'></div>\n<div class='col1of3'>\n<a class='button white width-full' href='{{>contract.url('value_list')}}' target='_blank'>\n<i class='fa fa-list-ol'></i>\n{{jed \"Value List\"/}}\n</a>\n</div>\n<div class='col1of3'></div>\n</div>\n</div>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/users/line","<div class='row line'>\n<div class='col1of5 line-col'>\n<strong data-address='{{>address}}' data-badge_id='{{>badge_id}}' data-city='{{>city}}' data-email='{{>email}}' data-firstname='{{>firstname}}' data-id='{{>id}}' data-image_url='{{>image_url}}' data-lastname='{{>lastname}}' data-phone='{{>phone}}' data-type='user-cell' data-zip='{{>zip}}'>\n{{>name()}}\n</strong>\n</div>\n<div class='col1of5 line-col text-align-left'>\n{{>phone}}\n</div>\n<div class='col1of5 line-col text-align-left'>\n{{>roleName()}}\n</div>\n<div class='col1of5 line-col text-align-left darkred-text'>\n{{if suspended()}}\n{{jed \"Suspended until\"/}} {{date suspendedUntil()/}}\n{{/if}}\n</div>\n<div class='col1of5 line-col line-actions'>\n<div class='multibutton'>\n{{if ~currentInventoryPool && accessRight()}}\n<a class='button white' href='{{>url('hand_over')}}'>\n<i class='fa fa-mail-forward'></i>\n{{jed \"Hand Over\"/}}\n</a>\n<div class='dropdown-holder inline-block'>\n<div class='button white dropdown-toggle'>\n<div class='arrow down'></div>\n</div>\n<ul class='dropdown right'>\n<li>\n<a class='dropdown-item' href='{{>url('edit')}}'>\n<i class='fa fa-edit'></i>\n{{jed \"Edit\"/}}\n</a>\n</li>\n<li>\n<a class='dropdown-item' href='mailto:{{>email}}'>\n<i class='fa fa-envelope'></i>\n{{jed \"E-Mail\"/}}\n</a>\n</li>\n</ul>\n</div>\n{{else}}\n<a class='button white' href='{{>url('edit')}}'>\n{{jed \"Edit\"/}}\n</a>\n<div class='dropdown-holder inline-block'>\n<div class='button white dropdown-toggle'>\n<div class='arrow down'></div>\n</div>\n<ul class='dropdown right'>\n<li>\n<a class='dropdown-item' href='mailto:{{>email}}'>\n<i class='fa fa-envelope'></i>\n{{jed \"E-Mail\"/}}\n</a>\n</li>\n{{if !~currentInventoryPool}}\n<li>\n<a class='dropdown-item red' data-method='delete' href='{{>url()}}'>\n<i class='fa fa-trash'></i>\n{{jed \"Delete\"/}}\n</a>\n</li>\n{{/if}}\n</ul>\n</div>\n{{/if}}\n</div>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/users/search_result_line","<div class='row line'>\n<div class='col2of8 line-col'>\n<strong data-address='{{>address}}' data-badge_id='{{>badge_id}}' data-city='{{>city}}' data-email='{{>email}}' data-firstname='{{>firstname}}' data-id='{{>id}}' data-image_url='{{>image_url}}' data-lastname='{{>lastname}}' data-phone='{{>phone}}' data-type='user-cell' data-zip='{{>zip}}'>\n{{>name()}}\n{{if isSuspended()}}\n<span class='darkred-text'>{{jed \"Suspended\"/}}!</span>\n{{/if}}\n</strong>\n</div>\n<div class='col2of8 line-col text-align-left'>\n{{>city}}\n</div>\n<div class='col1of8 line-col text-align-left'>\n{{if phone}}\n<div class='row grey-text'>{{jed 'Phone'/}}</div>\n{{>phone}}\n{{/if}}\n</div>\n<div class='col1of8 line-col text-align-left'>\n{{if badge_id}}\n<div class='row grey-text'>{{jed 'Badge'/}}</div>\n{{>badge_id}}\n{{/if}}\n</div>\n<div class='col2of8 line-col line-actions'>\n<div class='multibutton'>\n<a class='button white' href='{{>url('hand_over')}}'>\n<i class='fa fa-mail-forward'></i>\n{{jed \"Hand Over\"/}}\n</a>\n<div class='dropdown-holder inline-block'>\n<div class='button white dropdown-toggle'>\n<div class='arrow down'></div>\n</div>\n<ul class='dropdown right'>\n<li>\n<a class='dropdown-item' href='{{>url('edit')}}'>\n<i class='fa fa-edit'></i>\n{{jed \"Edit\"/}}\n</a>\n</li>\n<li>\n<a class='dropdown-item' href='mailto:{{>email}}'>\n<i class='fa fa-envelope'></i>\n{{jed \"E-Mail\"/}}\n</a>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/users/take_back_dialog","<div class='modal fade ui-modal medium' role='dialog' tabindex='-1'>\n<div class='modal-header row'>\n<div class='col3of5'>\n<h2 class='headline-l'>{{jed itemsCount \"Take back of %s item\" \"Take back of %s items\" itemsCount/}}</h2>\n<h3 class='headline-m light'>\n{{>user.firstname}} {{>user.lastname}}\n</h3>\n</div>\n<div class='col2of5 text-align-right'>\n<div class='modal-close'>{{jed \"Cancel\"/}}</div>\n<button class='button green' data-take-back>\n<i class='fa fa-mail-reply'></i>\n{{jed \"Take Back\"/}}\n</button>\n</div>\n</div>\n<div class='row margin-top-s padding-horizontal-l'>\n<div class='modal-body'>\n{{for groupedLines}}\n<div class='padding-bottom-m margin-bottom-m no-last-child-margin'>\n<div class='row margin-bottom-s'>\n<div class='col1of2'>\n<p>\n{{date start_date/}}\n-\n{{date end_date/}}\n</p>\n</div>\n<div class='col1of2 text-align-right'>\n<strong>{{diffDatesInDays start_date end_date/}}</strong>\n</div>\n</div>\n{{for reservations}}\n<div class='row'>\n<div class='col1of8 text-align-center'>\n<div class='paragraph-s'>\n{{if ~returnedQuantity[id]}}\n{{> ~returnedQuantity[id]}}/{{>quantity}}\n{{else}}\n{{if subreservations}}\n{{sum subreservations \"quantity\"/}}\n{{else}}\n{{> quantity}}\n{{/if}}\n{{/if}}\n</div>\n</div>\n<div class='col7of8'>\n<div class='paragraph-s'>\n<strong>{{>model().name()}}</strong>\n</div>\n</div>\n</div>\n{{/for}}\n</div>\n{{/for}}\n</div>\n</div>\n<div class='modal-footer'></div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/users/take_back_documents_dialog","<div class='modal fade ui-modal medium min-height-m' role='dialog' tabindex='-1'>\n<div class='modal-header row'>\n<div class='col3of5'>\n<h2 class='headline-l'>{{jed \"Take back completed\"/}}</h2>\n<h3 class='headline-m light'>\n{{jed itemsCount \"%s item\" \"%s items\" itemsCount/}}\n{{jed \"from %s\" user.name()/}}\n</h3>\n</div>\n<div class='col2of5 text-align-right'>\n<div class='multibutton'>\n<a class='button white text-ellipsis' href='{{dailyPath/}}'>{{jed \"Finish this take back\"/}}</a>\n<div class='dropdown-holder inline-block'>\n<div class='button white dropdown-toggle'>\n<div class='arrow down'></div>\n</div>\n<ul class='dropdown right'>\n<li>\n<a class='dropdown-item' href=''>\n<i class='fa fa-undo'></i>\n{{jed \"Back to this user\"/}}\n</a>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n<div class='modal-body'>\n<div class='padding-inset-l margin-top-s'>\n{{for contracts}}\n<div class='row emboss padding-inset-s margin-bottom-s'>\n<div class='col1of6'></div>\n<div class='col2of6 padding-inset-s'>\n<a class='button white width-full' href='{{>url()}}' target='_blank'>\n<i class='fa fa-file-alt'></i>\n{{jed \"Contract\"/}}\n{{>compact_id}}\n</a>\n</div>\n<div class='col2of6 padding-inset-s'>\n<a class='button white width-full' href='{{>url('value_list')}}' target='_blank'>\n<i class='fa fa-list-ol'></i>\n{{jed \"Value List\"/}}\n</a>\n</div>\n<div class='col1of6'></div>\n</div>\n{{/for}}\n</div>\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/users/tooltip","<div class='row width-xl min-height-s padding-right-s padding-left-s'>\n<div class='col3of4'>\n<div class='row'>\n<h3 class='headline-l'>{{>firstname}} {{>lastname}}</h3>\n<h3 class='headline-s light'>{{>email}}</h3>\n</div>\n{{if delegator_user()}}\n<div class='row margin-top-m'>\n<p class='paragraph-s line-height-s'>{{jed \"Responsible\"/}}: {{>delegator_user().name()}}</p>\n</div>\n{{/if}}\n{{if address}}\n<div class='row margin-top-m'>\n<p class='paragraph-xs line-height-s'>{{jed \"Address\"/}}</p>\n<p class='paragraph-s line-height-s'>{{>address}}{{>zip}} {{>city}}</p>\n</div>\n{{/if}}\n{{if phone}}\n<div class='row margin-top-m'>\n<p class='paragraph-xs line-height-s'>{{jed \"Phone\"/}}</p>\n<p class='paragraph-s line-height-s'>{{>phone}}</p>\n</div>\n{{/if}}\n{{if badge_id}}\n<div class='row margin-top-m'>\n<p class='paragraph-xs line-height-s'>{{jed \"Badge\"/}}</p>\n<p class='paragraph-s line-height-s'>{{>badge_id}}</p>\n</div>\n{{/if}}\n</div>\n<div class='col1of4'>\n{{if image_url}}\n<img class='max-size-xxs margin-horziontal-auto' src='{{>image_url/}}'>\n{{/if}}\n</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(e){e.views.templates("manage/views/visits/line",'{{include tmpl="manage/views/"+action+"s/line" /}}\n')}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews});