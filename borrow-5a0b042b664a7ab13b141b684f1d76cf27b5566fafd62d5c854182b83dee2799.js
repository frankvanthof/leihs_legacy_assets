(function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.App.BorrowBookingCalendar=function(i){function n(){return this.isClosedDay=t(this.isClosedDay,this),this.getInventoryPool=t(this.getInventoryPool,this),this.setupInventoryPoolSelector=t(this.setupInventoryPoolSelector,this),this.getHolidays=t(this.getHolidays,this),this.setQuantityText=t(this.setQuantityText,this),this.setDayElement=t(this.setDayElement,this),this.getGroupIds=t(this.getGroupIds,this),this.getAvailability=t(this.getAvailability,this),n.__super__.constructor.apply(this,arguments)}return e(n,i),n.prototype.setup=function(t){return this.ipSelector_el=null!=t.ipSelectorEl?t.ipSelectorEl:this.el.find("select#inventory_pool_id"),this.setupInventoryPoolSelector()},n.prototype.getAvailability=function(){return this.ipSelector_el.find("option:selected").data("availability")},n.prototype.getGroupIds=function(){return this.groupIds},n.prototype.setDayElement=function(t,e,i){var n,r,s;return s=parseInt(this.quantity_el.val()),r=this.getAvailability().maxAvailableForGroups(t,t,this.getGroupIds()),n=r>=s,this.isClosedDay(t)||i.length||this.setQuantityText(e,r),this.setAvailability(e,n),this.setSelected(e,t)},n.prototype.setQuantityText=function(t,e){return t.find(".fc-day-content > div").text(e)},n.prototype.getHolidays=function(){return this.ipSelector_el.find("option:selected").data("holidays")},n.prototype.setupInventoryPoolSelector=function(){return this.ipSelector_el.find("option:first").select(),this.ipSelector_el.bind("change",function(t){return function(){var e;return e=t.ipSelector_el.find("option:selected").data("availability"),t.setMaxQuantity(e.total_borrowable),t.render()}}(this)),this.ipSelector_el.change()},n.prototype.getInventoryPool=function(){return App.InventoryPool.find(this.ipSelector_el.find("option:selected").data("id"))},n.prototype.isClosedDay=function(t){var e;return e=this.getInventoryPool(),n.__super__.isClosedDay.apply(this,arguments)||!e.isVisitPossible(moment(t))||!e.hasEnoughReservationAdvanceDays(t)},n}(App.BookingCalendar)}).call(this),function(){window.App.Availability.url="/borrow/availability"}.call(this),function(){window.App.Category.url=function(t){return function(){return"/borrow/categories"}}(this)}.call(this),function(){window.App.CustomerOrder={}}.call(this),function(){window.App.Group.url=function(t){return function(){return"/borrow/groups"}}(this)}.call(this),function(){window.App.Holiday.url=function(t){return function(){return"/borrow/holidays"}}(this)}.call(this),function(){window.App.InventoryPool.url=function(t){return function(){return"/borrow/inventory_pools"}}(this)}.call(this),function(){window.App.Model.url=function(t){return function(){return"/borrow/models"}}(this),window.App.Model.hasMany("availabilities","App.Availability","model_id"),window.App.Model.prototype.availableQuantityForInventoryPools=function(t){return this.plainAvailabilities().all().length?_.reduce(this.plainAvailabilities().all(),function(e,i){return _.include(t,i.inventory_pool_id)?e+i.quantity:0},0):void 0}}.call(this),function(){window.App.PlainAvailability.url=function(t){return function(){return"/borrow/models/availability"}}(this)}.call(this),function(){window.App.Reservation.scope=function(t){return function(){return"/borrow"}}(this),window.App.Reservation.changeTimeRange=function(t){return function(t,e,i,n){var r,s,o;for(e=moment(e).format("YYYY-MM-DD"),i=moment(i).format("YYYY-MM-DD"),r=0,s=t.length;s>r;r++)o=t[r],o.start_date=e,o.end_date=i,o.inventory_pool_id=n.id,App.Reservation.find(o.id).refresh(o);return $.post("/borrow/reservations/change_time_range",{line_ids:_.map(t,function(t){return t.id}),start_date:e,end_date:i,inventory_pool_id:n.id})}}(this),window.App.Reservation.prototype.available=function(t){var e,i,n,r;return null==t&&(t=!0),n=null!=this.subreservations?_.reduce(this.subreservations,function(t,e){return t+e.quantity},0):this.quantity,(e=this.model().availabilities().findByAttribute("inventory_pool_id",this.inventory_pool_id))?(t&&(r=null!=this.subreservations?this.subreservations:[this],e=e.withoutLines(r)),i=e.maxAvailableForGroups(this.start_date,this.end_date,App.User.current.groupIds),i>=n):!0}}.call(this),function(){window.App.Template.hasMany("reservations","App.TemplateLine","template_id"),window.App.Template.prototype.groupedLines=function(){var t,e,i,n,r,s;i=_.groupBy(App.Template.first().reservations().all(),function(t){var e;return e={start_date:t.start_date},null!=t.inventory_pool_id&&(e.inventory_pool=App.InventoryPool.find(t.inventory_pool_id).name),e.inventory_pool_id=t.inventory_pool_id,JSON.stringify(e)}),t=[];for(n in i)s=i[n],r=_.map(s,function(t){return t.start_date=JSON.parse(n).start_date,t}),e={start_date:JSON.parse(n).start_date,reservations:r},null!=JSON.parse(n).inventory_pool_id&&(e.inventory_pool=App.InventoryPool.find(JSON.parse(n).inventory_pool_id)),t.push(e);return _.sortBy(t,function(t){return t.start_date+" "+(null!=t.inventory_pool?t.inventory_pool.name:"")})}}.call(this),function(){var t=function(t,i){function n(){this.constructor=t}for(var r in i)e.call(i,r)&&(t[r]=i[r]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},e={}.hasOwnProperty;window.App.TemplateLine=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.configure("TemplateLine","model_link_id","template_id","model_id","quantity","start_date","end_date","inventory_pool_id","unborrowable","available"),i.belongsTo("template","App.Template","template_id"),i.belongsTo("model","App.Model","model_id"),i}(Spine.Model)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};window.App.TimeoutCountdown=function(){function e(e){this.updateTime=t(this.updateTime,this),this.timeoutMinutes=e,this.refreshTime()}return e.prototype.refreshTime=function(){return this.minutes=this.timeoutMinutes,this.seconds=0,this.storeCurrentTimeout()},e.prototype.refresh=function(){return this.refreshTime(),$.get("/borrow/refresh_timeout.html"),$(this).trigger("timeUpdated")},e.prototype.start=function(){return this.updateTime(),this.interval=setInterval(this.updateTime,1e3)},e.prototype.storeCurrentTimeout=function(t){return null==t&&(t=new Date),localStorage.currentTimeout=t},e.prototype.sync=function(){return this.currentTimeout=moment(localStorage.currentTimeout),this.minutes=this.timeoutMinutes-1-Math.floor(Math.floor(moment().diff(this.currentTimeout)/1e3)/60),this.seconds=59-Math.floor(Math.floor(moment().diff(this.currentTimeout)/1e3)%60)},e.prototype.timeout=function(){return null==this.timedout?$.get("/borrow/refresh_timeout.json").done(function(t){return function(e){return moment().diff(moment(e.date).add(t.timeoutMinutes,"minutes"))<=0?t.storeCurrentTimeout(moment(e.date).toDate()):(t.timedout=!0,clearInterval(t.interval),$(t).trigger("timeout"))}}(this)):void 0},e.prototype.toString=function(){var t,e;return t=1===String(this.minutes).length?"0"+this.minutes:String(this.minutes),e=1===String(this.seconds).length?"0"+this.seconds:String(this.seconds),t+":"+e},e.prototype.updateTime=function(){var t;return this.sync(),t=moment(this.currentTimeout).add(this.timeoutMinutes,"minutes").diff(moment(),"seconds"),0>=t&&this.timeout(),this.seconds<=0&&this.minutes>0?(this.seconds=59,this.minutes=this.minutes-1):t>0&&(this.seconds=this.seconds-1),$(this).trigger("timeUpdated")},e}()}.call(this),function(){window.App.Workday.url=function(t){return function(){return"/borrow/workdays"}}(this)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.App.BasketController=function(i){function n(){this.render=t(this.render,this),this.delegateEvents=t(this.delegateEvents,this),n.__super__.constructor.apply(this,arguments),this.timeoutCountdown=new App.TimeoutCountdownController({el:this.el.find("#timeout-countdown"),template:"borrow/views/order/basket/timeout_countdown",refreshTarget:this.el.find("#timeout-countdown-refresh")}),this.delegateEvents()}return e(n,i),n.prototype.elements={"#current-order-lines":"reservationsContainer","#order-overview-button":"orderOverviewButton"},n.prototype.delegateEvents=function(){return App.Reservation.on("refresh",this.render)},n.prototype.render=function(){var t,e,i,n,r;e=[],t=App.Reservation.all(),n=_.groupBy(t,"model_id");for(i in n)r=n[i],e.push({model:App.Model.find(i),quantity:_.reduce(r,function(t){return function(t,e){return t+e.quantity}}(this),0)});return e=_.sortBy(e,function(t){return t.model.name()}),this.reservationsContainer.html(App.Render("borrow/views/order/basket/line",e)),_.size(e)>0?this.orderOverviewButton.removeClass("hidden"):this.orderOverviewButton.addClass("hidden")},n}(Spine.Controller)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.App.BorrowBookingCalendarDialogController=function(i){function n(e){this.submit=t(this.submit,this),this.valid=t(this.valid,this),this.setupBookingCalendar=t(this.setupBookingCalendar,this),this.renderInventoryPools=t(this.renderInventoryPools,this),this.selectFirstInventoryPool=t(this.selectFirstInventoryPool,this),this.initalizeDialog=t(this.initalizeDialog,this),this.fetchAvailability=t(this.fetchAvailability,this),this.fetchData=t(this.fetchData,this),this.setupModal=t(this.setupModal,this),this.availabilities={},n.__super__.constructor.apply(this,arguments)}return e(n,i),n.prototype.setupModal=function(){return this.dialog=$(App.Render("borrow/views/booking_calendar/calendar_dialog",{model:App.Model.find(this.modelId),titel:this.titel,buttonText:this.buttonText})),n.__super__.setupModal.apply(this,arguments)},n.prototype.fetchData=function(){return App.InventoryPool.ajaxFetch().done(function(t){return function(){var e,i,n,r,s;for(t.fetchWorkdays().done(function(){return t.initalizeDialog()}),t.fetchHolidays().done(function(){return t.initalizeDialog()}),t.fetchGroups().done(function(){return t.initalizeDialog()}),r=App.InventoryPool.all(),s=[],e=0,n=r.length;n>e;e++)i=r[e],s.push(t.fetchAvailability(i.id).done(function(){return t.initalizeDialog()}));return s}}(this))},n.prototype.fetchAvailability=function(t){return App.Availability.ajaxFetch({data:$.param({model_id:this.modelId,inventory_pool_id:t})}).done(function(t){return function(e){return t.availabilities[e.inventory_pool_id]=App.Availability.find(e.id)}}(this))},n.prototype.initalizeDialog=function(){return this.workdays&&this.holidays&&this.groups&&_.size(this.availabilities)===App.InventoryPool.all().length?(this.renderInventoryPools(),this.selectFirstInventoryPool(),n.__super__.initalizeDialog.apply(this,arguments)):!1},n.prototype.selectFirstInventoryPool=function(){},n.prototype.renderInventoryPools=function(){var t,e,i,n,r,s,o;for(this.inventoryPoolSelect.html(""),s=_.sortBy(App.InventoryPool.all(),function(t){return t.name}),o=[],e=0,n=s.length;n>e;e++)i=s[e],t=this.getAvailability(i),t.total_borrowable>0?(r=$(App.Render("borrow/views/booking_calendar/inventory_pool_option",i,{availability:t})),r.data("availability",t),r.data("holidays",i.holidays().all()),r.data("closed_days",i.workday().closedDays()),o.push(this.inventoryPoolSelect.append(r))):o.push(void 0);return o},n.prototype.setupBookingCalendar=function(){return new App.BorrowBookingCalendar({calendarEl:this.dialog.find("#booking-calendar"),startDateEl:this.startDateEl,endDateEl:this.endDateEl,quantityEl:this.dialog.find("#booking-calendar-quantity"),ipSelectorEl:this.dialog.find("#booking-calendar-inventory-pool"),quantityMode:"numbers",groupIds:_.map(App.Group.all(),function(t){return t.id})})},n.prototype.valid=function(){var t,e;return e=this.getSelectedInventoryPool(),t=this.availabilities[e.id],this.withoutLines&&(t=t.withoutLines(this.reservations)),this.errors=[],t.maxAvailableForGroups(this.getStartDate(),this.getEndDate(),_.map(this.groups,function(t){return t.id}))<this.getQuantity()&&this.errors.push(_jed("Item is not available in that time range")),e.hasEnoughReservationAdvanceDays(this.getStartDate())?(e.isVisitPossible(this.getStartDate())||this.errors.push(_jed("Booking is no longer possible on this start date")),e.isVisitPossible(this.getEndDate())||this.errors.push(_jed("Booking is no longer possible on this end date"))):this.errors.push(_jed("No orders are possible on this start date")),e.isClosedOn(this.getStartDate())&&this.errors.push(_jed("Inventory pool is closed on start date")),e.isClosedOn(this.getEndDate())&&this.errors.push(_jed("Inventory pool is closed on end date")),!this.errors.length},n.prototype.submit=function(){return this.validationAlerts(),n.__super__.submit.apply(this,arguments)},n}(App.BookingCalendarDialogController)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.App.ModelsIndexController=function(i){function n(){this.extendParamsWithSearchTerm=t(this.extendParamsWithSearchTerm,this),this.loading=t(this.loading,this),this.render=t(this.render,this),this.fetchAvailability=t(this.fetchAvailability,this),this.fetchModels=t(this.fetchModels,this),this.resetAllFilter=t(this.resetAllFilter,this),this.isResetable=t(this.isResetable,this),this.resetAndFetchModels=t(this.resetAndFetchModels,this),this.periodChange=t(this.periodChange,this),this.createReservation=t(this.createReservation,this),this.delegateEvents=t(this.delegateEvents,this),n.__super__.constructor.apply(this,arguments),this.models=_.map(this.models,function(t){return function(t){return new App.Model(t)}}(this)),this.searchTerm=this.params.search_term,this.reset=new App.ModelsIndexResetController({el:this.el.find("#reset-all-filter"),reset:this.resetAllFilter,isResetable:this.isResetable}),this.ipSelector=new App.ModelsIndexIpSelectorController({el:this.el.find("#ip-selector"),onChange:function(t){return function(){return t.resetAndFetchModels()}}(this)}),this.sorting=new App.ModelsIndexSortingController({el:this.el.find("#model-sorting"),onChange:function(t){return function(){return t.resetAndFetchModels()}}(this)}),this.search=new App.ModelsIndexSearchController({el:this.el.find("#model-list-search"),onChange:function(t){return function(){return t.resetAndFetchModels()}}(this)}),this.period=new App.ModelsIndexPeriodController({el:this.el.find("#period"),onChange:function(t){return function(){return t.periodChange()}}(this)}),this.pagination=new App.ModelsIndexPaginationController({el:this.list,onChange:function(t){return function(e){return t.fetchModels(e)}}(this)}),this.tooltips=new App.ModelsIndexTooltipController({el:this.list}),this.delegateEvents(),this.sessionStorage=new App.SessionStorageController({el:this.el,ipSelector:this.ipSelector,sorting:this.sorting,search:this.search,period:this.period}),this.sessionStorage.isEmpty()||this.sessionStorage.restoreFilters({callback:this.resetAndFetchModels})}return e(n,i),n.prototype.elements={"#model-list":"list"},n.prototype.events={"click [data-create-order-line]":"createReservation"},n.prototype.delegateEvents=function(){return n.__super__.delegateEvents.apply(this,arguments),App.PlainAvailability.on("refresh",this.render),App.Model.on("ajaxSuccess",function(t){return function(e,i,n){return t.pagination.setData(JSON.parse(n.getResponseHeader("X-Pagination")))}}(this))},n.prototype.createReservation=function(t){return t.preventDefault(),new App.ReservationsCreateController({modelId:$(t.currentTarget).data("model-id"),titel:_jed("Add to order"),buttonText:_jed("Add")}),!1},n.prototype.periodChange=function(){return this.reset.validate(),this.tooltips.tooltips={},null!=this.period.getPeriod()?(this.sessionStorage.update(),this.loading(),this.fetchAvailability()):(App.PlainAvailability.deleteAll(),this.render())},n.prototype.resetAndFetchModels=function(t){var e;return e=(null!=t?t:{clearSessionStorage:!1}).clearSessionStorage,this.reset.validate(),this.loading(),e?this.sessionStorage.clear():this.sessionStorage.update(),this.models=[],this.pagination.page=1,this.tooltips.tooltips={},this.fetchModels()},n.prototype.isResetable=function(){return this.search.is_resetable()||this.sorting.is_resetable()||this.period.is_resetable()||this.ipSelector.is_resetable()},n.prototype.resetAllFilter=function(){return this.ipSelector.reset(),this.sorting.reset(),this.search.reset(),this.period.reset(),this.resetAndFetchModels({clearSessionStorage:!0})},n.prototype.fetchModels=function(t){var e;return $.extend(this.params,{inventory_pool_ids:this.ipSelector.activeInventoryPoolIds()}),$.extend(this.params,this.sorting.getCurrentSorting()),this.extendParamsWithSearchTerm(),e=_.clone(this.params),null!=t&&(e.page=t),App.Model.ajaxFetch({data:$.param(e)}).done(function(t){return function(e){var i;return t.models=t.models.concat(function(){var t,n,r;for(r=[],t=0,n=e.length;n>t;t++)i=e[t],r.push(App.Model.find(i.id));return r}()),null!=t.period.getPeriod()?t.fetchAvailability():t.render()}}(this))},n.prototype.fetchAvailability=function(){var t;return t=_.map(this.models,function(t){return function(t){return t.id}}(this)),this.currentStartDate=this.period.getPeriod().start_date,this.currentEndDate=this.period.getPeriod().end_date,App.PlainAvailability.fetch({data:$.param({start_date:this.period.getPeriod().start_date,end_date:this.period.getPeriod().end_date,model_ids:t,inventory_pool_ids:this.ipSelector.activeInventoryPoolIds()})})},n.prototype.render=function(){return this.list.html(App.Render("borrow/views/models/index/line",this.models,{inventory_pool_ids:this.ipSelector.activeInventoryPoolIds()})),this.pagination.render()},n.prototype.loading=function(){return this.list.html(App.Render("borrow/views/models/index/loading"))},n.prototype.extendParamsWithSearchTerm=function(){return null!=this.searchTerm?null!=this.search.getInputText().search_term?this.params.search_term=this.searchTerm+" "+this.search.getInputText().search_term:this.params.search_term=this.searchTerm:$.extend(this.params,this.search.getInputText())},n}(Spine.Controller)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.App.ModelsIndexIpSelectorController=function(i){function n(){this.is_resetable=t(this.is_resetable,this),this.reset=t(this.reset,this),this.render=t(this.render,this),this.activeInventoryPoolIds=t(this.activeInventoryPoolIds,this),this.change=t(this.change,this),this.changeInventoryPools=t(this.changeInventoryPools,this),this.selectMultipleInventoryPools=t(this.selectMultipleInventoryPools,this),this.selectInventoryPool=t(this.selectInventoryPool,this),n.__super__.constructor.apply(this,arguments),App.ModelsIndexIpSelectorController.activeInventoryPoolIds=_.map(this.el.find("input:checked"),function(t){return $(t).closest("[data-id]").data().id})}return e(n,i),n.activeInventoryPoolIds=[],n.prototype.events={"change input[type='checkbox']":"changeInventoryPools","click .dropdown-item":"selectInventoryPool"},n.prototype.elements={".button":"button"},n.prototype.selectInventoryPool=function(t){var e;return e=$(t.target),null!=e.data("all")?(this.el.find("input:checkbox").prop("checked",!0),this.changeInventoryPools()):e.hasClass("dropdown-item")?(this.el.find("input:checkbox").prop("checked",!1),e.find("input:checkbox").prop("checked",!0).change()):void 0},n.prototype.selectMultipleInventoryPools=function(t){return _.each(this.el.find("a[data-id]"),function(e){var i;return i=_.contains(t,$(e).data("id")),$(e).find("input:checkbox").prop("checked",i)})},n.prototype.changeInventoryPools=function(t){return this.el.find("input:checkbox:checked").length?this.change():$(t.currentTarget).prop("checked",!0)},n.prototype.change=function(){return App.ModelsIndexIpSelectorController.activeInventoryPoolIds=this.activeInventoryPoolIds(),this.render(),this.onChange()},n.prototype.activeInventoryPoolIds=function(){return _.map(this.el.find("input:checked"),function(t){return $(t).closest("[data-id]").data("id")})},n.prototype.render=function(){var t,e,i,n;return t=_.map(this.el.find("input:checked"),function(t){return $(t).closest("[data-id]").data()}),n=this.el.find("input").length,e=t.length,i=function(){switch(e){case 1:return _.first(t).name;case n:return _jed("All inventory pools");default:return e+" "+_jed(e,"Inventory pool","Inventory pools")}}(),this.button.html(App.Render("borrow/views/models/index/ip_selector",{text:i}))},n.prototype.reset=function(){return this.el.find("input:checkbox").prop("checked",!0),this.render()},n.prototype.is_resetable=function(){return this.activeInventoryPoolIds().length!==this.el.find("[data-id]").length},n}(Spine.Controller)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.App.ModelsIndexPaginationController=function(i){function n(){this.pageInview=t(this.pageInview,this),this.render=t(this.render,this),this.totalPages=t(this.totalPages,this),this.setData=t(this.setData,this),n.__super__.constructor.apply(this,arguments),this.setData(this.el.data("pagination")),this.page=this.el.data("pagination").page,this.render()}return e(n,i),n.prototype.events={"inview .page:not(.fetched)":"pageInview"},n.prototype.setData=function(t){return this.totalCount=t.total_count,this.perPage=t.per_page},n.prototype.totalPages=function(){return Math.ceil(this.totalCount/this.perPage)},n.prototype.render=function(){var t;return t=this.totalPages()-this.page,t>0?_.each(_.range(1,t+1),function(t){return function(e){var i;return e+=t.page,i=$(App.Render("borrow/views/models/index/page",e,{entries:_.range(t.perPage),page:e})),t.el.append(i)}}(this)):void 0},n.prototype.pageInview=function(t){var e;return e=$(t.currentTarget),e.addClass("fetched"),this.page=e.data("page"),this.onChange(this.page)},n}(Spine.Controller)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.App.ModelsIndexPeriodController=function(i){function n(){this.is_resetable=t(this.is_resetable,this),this.reset=t(this.reset,this),this.validate=t(this.validate,this),this.getPeriod=t(this.getPeriod,this),this.selectEndDate=t(this.selectEndDate,this),this.setupEndDate=t(this.setupEndDate,this),this.selectStartDate=t(this.selectStartDate,this),n.__super__.constructor.apply(this,arguments),this.setupStartDate(),this.setupEndDate()}return e(n,i),n.prototype.elements={"#start-date":"startDate","#end-date":"endDate"},n.prototype.events={"keydown #start-date":"validate","keydown #end-date":"validate","mousedown #start-date":"validate","mousedown #end-date":"validate","change #start-date":"validate","change #end-date":"validate","preChange #start-date":"selectStartDate","preChange #end-date":"selectEndDate"},n.prototype.setStartDate=function(t){return this.setDateFor(this.startDate,t)},n.prototype.setEndDate=function(t){return this.setDateFor(this.endDate,t)},n.prototype.setDateFor=function(t,e){return t.datepicker("setDate",e)},n.prototype.setupStartDate=function(){return this.startDate.datepicker({onSelect:this.selectStartDate,minDate:moment().toDate()}),this.startDate.preChange()},n.prototype.selectStartDate=function(){var t;return t=moment(this.startDate.val(),i18n.date.L),moment(t).isValid()?((null==this.endDate.val()||!this.endDate.val().length||t.diff(moment(this.endDate.val(),i18n.date.L),"days")>=0)&&this.endDate.val(t.add(1,"days").format(i18n.date.L)),this.endDate.datepicker("option","minDate",moment(t,i18n.date.L).toDate()),this.startDate.trigger("change"),this.onChange()):!1},n.prototype.setupEndDate=function(){return this.endDate.datepicker({onSelect:this.selectEndDate,minDate:moment().toDate()}),this.endDate.preChange()},n.prototype.selectEndDate=function(){var t;return t=moment(this.endDate.val(),i18n.date.L),moment(t).isValid()?(null!=this.startDate.val()&&this.startDate.val().length||this.startDate.val(t.subtract(1,"days").format(i18n.date.L)),this.endDate.trigger("change"),this.onChange()):!1},n.prototype.getPeriod=function(){return this.startDate.val().length&&this.endDate.val().length?{start_date:moment(this.startDate.val(),i18n.date.L).format("YYYY-MM-DD"),end_date:moment(this.endDate.val(),i18n.date.L).format("YYYY-MM-DD")}:void 0},n.prototype.validate=function(){return 0===this.startDate.val().length||0===this.endDate.val().length?this.onChange():void 0},n.prototype.reset=function(){return this.startDate.val(null),this.endDate.val(null),App.PlainAvailability.deleteAll()},n.prototype.is_resetable=function(){return null!=this.getPeriod()},n}(Spine.Controller)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.App.ModelsIndexResetController=function(i){function n(){this.showResetIcon=t(this.showResetIcon,this),this.hideResetIcon=t(this.hideResetIcon,this),this.validate=t(this.validate,this),this.resetAllFilter=t(this.resetAllFilter,this),n.__super__.constructor.apply(this,arguments),this.resetContainer=$("#reset-container")}return e(n,i),n.prototype.events={click:"resetAllFilter"},n.prototype.resetAllFilter=function(){return this.reset(),this.hideResetIcon()},n.prototype.validate=function(){return this.isResetable()?this.showResetIcon():this.hideResetIcon()},n.prototype.hideResetIcon=function(){return this.el.addClass("hidden"),this.resetContainer.removeClass("padding-left-m")},n.prototype.showResetIcon=function(){return this.el.removeClass("hidden"),this.resetContainer.addClass("padding-left-m")},n}(Spine.Controller)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.App.ModelsIndexSearchController=function(i){function n(){this.is_resetable=t(this.is_resetable,this),this.reset=t(this.reset,this),n.__super__.constructor.apply(this,arguments),this.inputField.preChange()}return e(n,i),n.prototype.events={"preChange input":"onChange"},n.prototype.elements={input:"inputField"},n.prototype.getInputText=function(){return this.inputField.val().length?{search_term:this.inputField.val()}:{search_term:null}},n.prototype.reset=function(){return this.inputField.val("")},n.prototype.is_resetable=function(){return null!=this.getInputText().search_term&&this.getInputText().search_term.length>0},n}(Spine.Controller)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.App.ModelsIndexSortingController=function(i){function n(){return this.is_resetable=t(this.is_resetable,this),this.reset=t(this.reset,this),this.getCurrentSorting=t(this.getCurrentSorting,this),this.render=t(this.render,this),this.change=t(this.change,this),n.__super__.constructor.apply(this,arguments)}return e(n,i),n.prototype.events={"click a[data-sort]":"change"},n.prototype.elements={".button":"button"},n.prototype.change=function(t){var e,i;return i=$(t.currentTarget),e=i.closest(".dropdown"),e.addClass("hidden"),_.delay(function(t){return function(){return e.removeClass("hidden")}}(this),200),this.sort=i.data("sort"),this.order=i.data("order"),this.render(),this.onChange()},n.prototype.render=function(t){return this.button.html(App.Render("borrow/views/models/index/sorting",{sort:this.sort,order:this.order}))},n.prototype.getCurrentSorting=function(){return{sort:this.sort,order:this.order}},n.prototype.reset=function(){return this.sort="name",this.order="asc",this.render()},n.prototype.is_resetable=function(){return null!=this.getCurrentSorting().sort&&"name"!==this.getCurrentSorting().sort||null!=this.getCurrentSorting().order&&"asc"!==this.getCurrentSorting().order},n}(Spine.Controller)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.App.ModelsIndexTooltipController=function(i){function n(){return this.leaveLine=t(this.leaveLine,this),this.stayOnLine=t(this.stayOnLine,this),this.enterLine=t(this.enterLine,this),this.fetchProperties=t(this.fetchProperties,this),this.createTooltip=t(this.createTooltip,this),n.__super__.constructor.apply(this,arguments)}return e(n,i),n.prototype.events={"mouseleave .line[data-id]":"leaveLine","mouseenter .line[data-id]":"enterLine"},n.prototype.tooltips={},n.prototype.createTooltip=function(t){return new App.Tooltip({el:t,trackTooltip:!0,delay:[200,100],trigger:"hover"})},n.prototype.fetchProperties=function(t,e){return App.Property.ajaxFetch({data:$.param({model_ids:[t]})}).done(function(i){return function(){var n,r,s;return App.Model.exists(t)?null!=i.tooltips[t]&&e.hasClass("tooltipstered")?!1:(s=i.createTooltip(e),i.tooltips[t]=s,i.currentTooltip=s,null!=s?(r=App.Model.find(t),r.propertiesToDisplay=_.first(r.properties().all(),5),r.amount_of_images=1,n=App.Render("borrow/views/models/index/tooltip",r),s.update(n),setTimeout(function(){return i.currentTooltip===s&&i.mouseOverTooltip?s.show():void 0},0)):void 0):!1}}(this))},n.prototype.enterLine=function(t){return this.mouseOverTooltip=!0,this.currentTargetId=$(t.currentTarget).data("id"),_.delay(function(e){return function(){return e.stayOnLine(t)}}(this),200)},n.prototype.stayOnLine=function(t){var e,i,n;return this.currentTargetId===$(t.currentTarget).data("id")&&this.mouseOverTooltip?($("*:focus").blur().datepicker("hide"),i=$(t.currentTarget),e=i.data("id"),App.Model.exists(e)?null!=this.tooltips[e]&&i.hasClass("tooltipstered")?(n=this.tooltips[e],this.currentTooltip=n):this.fetchProperties(e,i):void 0):!1},n.prototype.leaveLine=function(t){return this.mouseOverTooltip=!1},n}(Spine.Controller)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.App.ModelsShowController=function(i){function n(){this.createReservation=t(this.createReservation,this),n.__super__.constructor.apply(this,arguments),new App.ModelsShowPropertiesController({el:"#properties"}),new App.ModelsShowImagesController({el:"#images"})}return e(n,i),n.prototype.events={"click [data-create-order-line]":"createReservation"},n.prototype.createReservation=function(t){return t.preventDefault(),new App.ReservationsCreateController({modelId:$(t.currentTarget).data("model-id"),titel:_jed("Add to order"),buttonText:_jed("Add")}),!1},n}(Spine.Controller)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.App.ModelsShowImagesController=function(i){function n(){this.releaseCurrentImage=t(this.releaseCurrentImage,this),this.lockImage=t(this.lockImage,this),this.clickImage=t(this.clickImage,this),this.leaveImage=t(this.leaveImage,this),this.enterImage=t(this.enterImage,this),n.__super__.constructor.apply(this,arguments),this.lockImage(this.el.find("[data-image-url]:not(#main-image):first"));
}return e(n,i),n.prototype.elements={"#main-image":"mainImage"},n.prototype.events={"mouseenter [data-image-url]:not(#main-image)":"enterImage","mouseleave [data-image-url]:not(#main-image)":"leaveImage","click [data-image-url]:not(#main-image)":"clickImage"},n.prototype.enterImage=function(t){var e;return this.mouseover=!0,e=$(t.currentTarget),this.mainImage.attr("src",e.data("image-url"))},n.prototype.leaveImage=function(t){return this.mouseover=!1,_.delay(function(t){return function(){return t.mouseover===!1?null!=t.currentImage?t.mainImage.attr("src",t.currentImage.data("image-url")):t.mainImage.attr("src",t.mainImage.data("image-url")):void 0}}(this),100)},n.prototype.clickImage=function(t){return this.lockImage($(t.currentTarget))},n.prototype.lockImage=function(t){return this.releaseCurrentImage(),t.addClass("focus-thin"),this.currentImage=t},n.prototype.releaseCurrentImage=function(){return null==this.currentImage?!1:this.currentImage.removeClass("focus-thin")},n}(Spine.Controller)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.App.ModelsShowPropertiesController=function(i){function n(){this.hide=t(this.hide,this),this.show=t(this.show,this),this.toggle=t(this.toggle,this),this.setupShowMore=t(this.setupShowMore,this),n.__super__.constructor.apply(this,arguments),this.open=!1,this.setupShowMore()}return e(n,i),n.prototype.elements={".property":"properties"},n.prototype.events={"click #properties-toggle":"toggle"},n.prototype.setupShowMore=function(){var t;return this.properties.length>5?(t=$(App.Render("borrow/views/models/show/collapsed_properties")),this.collapsedProperties=t.find("#collapsed-properties"),this.showAllText=t.find("#show-all-properties-text"),this.showLessText=t.find("#show-less-properties-text"),this.toggleEl=t.find("#properties-toggle"),t.find(".collapsed-inner").html(this.properties.slice(5,this.properties.length)),this.el.append(t)):void 0},n.prototype.toggle=function(){return this.open?(this.open=!1,this.hide()):(this.open=!0,this.show())},n.prototype.show=function(){return this.collapsedProperties.removeClass("collapsed"),this.showAllText.addClass("hidden"),this.showLessText.removeClass("hidden"),this.collapsedProperties.addClass("separated-bottom")},n.prototype.hide=function(){return this.collapsedProperties.addClass("collapsed"),this.showAllText.removeClass("hidden"),this.showLessText.addClass("hidden"),this.collapsedProperties.removeClass("separated-bottom")},n}(Spine.Controller)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.App.SessionStorageController=function(i){function n(){this.getLocalizedDateFormat=t(this.getLocalizedDateFormat,this),this.formatDate=t(this.formatDate,this),this.update=t(this.update,this),this.clear=t(this.clear,this),this.restoreFilters=t(this.restoreFilters,this),this.isEmpty=t(this.isEmpty,this),n.__super__.constructor.apply(this,arguments),new App.SessionStorageUrlController({el:this.el.find("#breadcrumbs")}),new App.SessionStorageUrlController({el:this.el.find("#explorative-search")})}return e(n,i),n.prototype.isEmpty=function(){return 0===sessionStorage.length},n.prototype.restoreFilters=function(t){var e,i,n;return e=t.callback,sessionStorage.searchTerm&&this.search.inputField.val(sessionStorage.searchTerm),sessionStorage.inventoryPoolIds&&(i=JSON.parse(sessionStorage.inventoryPoolIds),i.length>0&&(this.ipSelector.selectMultipleInventoryPools(i),App.ModelsIndexIpSelectorController.activeInventoryPoolIds=i,this.ipSelector.render())),sessionStorage.sorting&&(n=JSON.parse(sessionStorage.sorting),_.isEmpty(n)||(this.sorting.sort=n.sort,this.sorting.order=n.order,this.sorting.render())),sessionStorage.startDate&&this.period.setStartDate(this.getLocalizedDateFormat(sessionStorage.startDate)),sessionStorage.endDate&&this.period.setEndDate(this.getLocalizedDateFormat(sessionStorage.endDate)),e()},n.prototype.clear=function(){return sessionStorage.clear(),App.SessionStorageUrlController.removeSessionStorageFromUrl()},n.prototype.update=function(){return sessionStorage.setItem("inventoryPoolIds",JSON.stringify(this.ipSelector.activeInventoryPoolIds())),sessionStorage.setItem("sorting",JSON.stringify(this.sorting.getCurrentSorting())),sessionStorage.setItem("searchTerm",this.search.inputField.val()),_.isEmpty(this.period.startDate.val())||sessionStorage.setItem("startDate",this.formatDate(this.period.startDate.val())),_.isEmpty(this.period.endDate.val())||sessionStorage.setItem("endDate",this.formatDate(this.period.endDate.val())),this.isEmpty()?void 0:App.SessionStorageUrlController.addSessionStorageToUrl()},n.prototype.formatDate=function(t){return _.isEmpty(t)?t:moment(t,i18n.date.L).format("DD.MM.YYYY")},n.prototype.getLocalizedDateFormat=function(t){return moment(t,"DD.MM.YYYY").format(i18n.date.L)},n}(Spine.Controller)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.App.SessionStorageUrlController=function(i){function n(){return this.getHref=t(this.getHref,this),this.setSessionStorageParam=t(this.setSessionStorageParam,this),n.__super__.constructor.apply(this,arguments)}return e(n,i),n.prototype.events={click:"setSessionStorageParam"},n.prototype.setSessionStorageParam=function(t){var e;if("start"!==t.target.id&&sessionStorage.length>0){if(t.preventDefault(),e=this.getHref($(t.target)),!e||!e.length)return;return window.location=e+"&session_storage=true"}},n.prototype.getHref=function(t){return"A"!==t.tagName?$(t).closest("[href]").attr("href"):$(t).attr("href")},n.addSessionStorageToUrl=function(){var t;return _.string.contains(window.location.href,"&session_storage=true")?void 0:(t=String(window.location.href)+"&session_storage=true",history.replaceState(null,document.title,t))},n.removeSessionStorageFromUrl=function(){var t;return t=String(window.location.href).replace("&session_storage=true",""),history.replaceState(null,document.title,t)},n}(Spine.Controller)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.App.ReservationsChangeController=function(i){function n(){return this.changeRange=t(this.changeRange,this),this.store=t(this.store,this),this.getAvailability=t(this.getAvailability,this),this.done=t(this.done,this),this.createReservation=t(this.createReservation,this),n.__super__.constructor.apply(this,arguments)}return e(n,i),n.prototype.createReservation=function(){var t;return t=new App.Reservation({model_id:this.modelId,start_date:this.getStartDate().format("YYYY-MM-DD"),end_date:this.getEndDate().format("YYYY-MM-DD"),inventory_pool_id:this.getSelectedInventoryPool().id,quantity:1}),App.Reservation.ajaxChange(t,"create",{})},n.prototype.done=function(t){return App.Reservation.trigger("refresh"),n.__super__.done.apply(this,arguments)},n.prototype.getAvailability=function(t){return this.availabilities[t.id].withoutLines(this.reservations)},n.prototype.selectFirstInventoryPool=function(){var t,e;return t=this.reservations[0].inventory_pool_id,e=this.inventoryPoolSelect.find("option[data-id='"+t+"']"),e.length?e.prop("selected",!0):void 0},n.prototype.store=function(){var t,e,i,n,r,s,o,a,l,u,c,h;if(e=this.getQuantity()-this.quantity,0>e){for(u=this.reservations.slice(0,+(Math.abs(e)-1)+1||9e9),t=_.after(u.length,this.changeRange),n=function(e){return App.Reservation.ajaxChange(e,"destroy",{}).done(function(i){return function(){return e.remove(),t()}}(this))},r=0,o=u.length;o>r;r++)a=u[r],n(a);return this.reservations=_.reject(this.reservations,function(t){return _.include(u,t)})}if(e>0){for(i=_.after(e,this.changeRange),c=[],h=s=1,l=e;l>=1?l>=s:s>=l;h=l>=1?++s:--s)c.push(this.createReservation().done(function(t){return function(e){return t.reservations.push(App.Reservation.find(e.id)),i()}}(this)));return c}return this.changeRange()},n.prototype.changeRange=function(){var t;return this.getStartDate().format("YYYY-MM-DD")!==this.startDate||this.getEndDate().format("YYYY-MM-DD")!==this.endDate?(t=App.Reservation.changeTimeRange(this.reservations,this.getStartDate(),this.getEndDate(),this.getSelectedInventoryPool()),t.done(this.done),t.fail(this.fail)):this.done()},n}(window.App.BorrowBookingCalendarDialogController)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.App.ReservationsCreateController=function(i){function n(){return this.store=t(this.store,this),this.setupDates=t(this.setupDates,this),this.getAvailability=t(this.getAvailability,this),n.__super__.constructor.apply(this,arguments)}return e(n,i),n.prototype.getAvailability=function(t){return this.availabilities[t.id]},n.prototype.setupQuantity=function(){return!0},n.prototype.selectFirstInventoryPool=function(){var t,e,i,n,r,s;for(i=App.ModelsIndexIpSelectorController.activeInventoryPoolIds,s=[],t=0,n=i.length;n>t;t++){if(e=i[t],r=this.inventoryPoolSelect.find("option[data-id='"+e+"']"),r.length){r.prop("selected",!0);break}s.push(void 0)}return s},n.prototype.setupDates=function(){return null!=sessionStorage.startDate?this.startDateEl.val(moment(sessionStorage.startDate,"DD.MM.YYYY").format("YYYY-MM-DD")):this.startDateEl.val(moment().format("YYYY-MM-DD")),null!=sessionStorage.endDate?this.endDateEl.val(moment(sessionStorage.endDate,"DD.MM.YYYY").format("YYYY-MM-DD")):this.endDateEl.val(moment().add(1,"days").format("YYYY-MM-DD"))},n.prototype.store=function(){var t,e,i,n,r,s;for(i=this.quantityEl.val(),t=_.after(i,this.done),r=[],s=e=1,n=i;n>=1?n>=e:e>=n;s=n>=1?++e:--e)r.push(this.createReservation().done(function(e){return function(e){var i;return i=App.Reservation.find(e.id),t()}}(this)));return r},n}(window.App.ReservationsChangeController)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.App.SearchTopbarController=function(i){function n(){this.submit=t(this.submit,this),this.autocomplete=t(this.autocomplete,this),this.fetchModels=t(this.fetchModels,this),this.keydown=t(this.keydown,this),this.close=t(this.close,this),this.open=t(this.open,this),this.finished=t(this.finished,this),this.loading=t(this.loading,this),this.search=t(this.search,this),n.__super__.constructor.apply(this,arguments),this.input.preChange()}return e(n,i),n.prototype.elements={"input#search_term":"input",i:"icon",".addon":"addon","#search-autocomplete":"autocompleteContainer",form:"form"},n.prototype.events={"preChange input":"search","blur input":"close","focus input":"open","submit form":"submit"},n.prototype.search=function(){return this.input.val().length?(this.loading(),this.fetchModels().done(function(t){return function(e){var i;return t.models=function(){var t,n,r;for(r=[],t=0,n=e.length;n>t;t++)i=e[t],r.push(App.Model.find(i.id));return r}(),t.finished(),t.autocomplete()}}(this))):!1},n.prototype.loading=function(){return this.icon.detach(),this.addon.html(App.Render("views/loading",{size:"micro"}))},n.prototype.finished=function(){return this.addon.html(this.icon)},n.prototype.open=function(){return this.autocompleteContainer.show(),this.search()},n.prototype.close=function(){return _.delay(function(t){return function(){return t.autocompleteContainer.hide()}}(this),200)},n.prototype.keydown=function(t){return 0===$("*:focus").length&&String.fromCharCode(t.which).length&&!_.include([224,16,17,18,32,13,37,38,39,40,8,9,20,91,93,27],t.which)&&t.metaKey===!1?this.input.val("")&&this.input.focus():void 0},n.prototype.fetchModels=function(){var t,e;return e={},e.search_term=this.input.val(),t=this.input.val(),e.per_page=6,App.Model.ajaxFetch({data:$.param(e)})},n.prototype.autocomplete=function(){return this.input.autocomplete({appendTo:this.autocompleteContainer,source:function(t){return function(e,i){var n;return n=_.map(t.models,function(t){return t.value=t.name(),t}),n.push({value:e,searchAll:!0}),i(n)}}(this),focus:function(t){return function(){return!1}}(this),select:function(t){return function(e,i){return null!=i.item.searchAll?(t.form.submit(),!1):(window.location="/borrow/models/"+i.item.id,!1)}}(this)}).data("uiAutocomplete")._renderItem=function(t){return function(t,e){var i;return null!=e.searchAll?i=$(App.Render("borrow/views/search/autocomplete/show_all")).data("value",e).appendTo(t):$(App.Render("borrow/views/search/autocomplete/model",e)).data("value",e).appendTo(t)}}(this),this.input.autocomplete("search")},n.prototype.submit=function(t){return this.input.val().length?void 0:(t.preventDefault(),!1)},n}(Spine.Controller)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.App.TemplateAvailabilityController=function(i){function n(){return this.render=t(this.render,this),this.destroyTemplateLine=t(this.destroyTemplateLine,this),this.changeTemplateLine=t(this.changeTemplateLine,this),n.__super__.constructor.apply(this,arguments)}return e(n,i),n.prototype.elements={"#template-lines":"templateLines"},n.prototype.events={"click [data-change-template-line]":"changeTemplateLine","click [data-destroy-template-line]":"destroyTemplateLine"},n.prototype.delegateEvents=function(){return n.__super__.delegateEvents.apply(this,arguments),App.TemplateLine.on("change",this.render)},n.prototype.changeTemplateLine=function(t){var e,i,n;return t.preventDefault(),i=$(t.currentTarget),e=i.closest(".line"),n=App.TemplateLine.findByAttribute("model_link_id",e.data("model_link_id")),new App.TemplateLineChangeController({modelId:i.data("model-id"),quantity:i.data("quantity"),startDate:i.data("start-date"),endDate:i.data("end-date"),titel:_jed("Change %s",_jed("Entry")),buttonText:_jed("Save change"),templateLine:n}),!1},n.prototype.destroyTemplateLine=function(t){var e,i,n;return t.preventDefault(),i=$(t.currentTarget),e=i.closest(".line"),n=App.TemplateLine.findByAttribute("model_link_id",e.data("model_link_id")),confirm(_jed("%s will be removed from the template and not been added to your order.",n.model().name()))&&(App.TemplateLine.destroy(n.id),0===this.templateLines.find(".line").length&&(document.location="/borrow/templates")),!1},n.prototype.render=function(){return this.templateLines.html(App.Render("borrow/views/templates/availability/grouped_lines",App.Template.first().groupedLines()))},n}(Spine.Controller)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.App.TemplateLineChangeController=function(i){function n(){return this.getAvailability=t(this.getAvailability,this),n.__super__.constructor.apply(this,arguments)}return e(n,i),n.prototype.getAvailability=function(t){return this.availabilities[t.id]},n.prototype.store=function(){return App.TemplateLine.update(this.templateLine.id,{quantity:this.getQuantity(),inventory_pool_id:this.getSelectedInventoryPool().id,available:!0,start_date:this.getStartDate().format("YYYY-MM-DD"),end_date:this.getEndDate().format("YYYY-MM-DD")}),this.done()},n}(window.App.BorrowBookingCalendarDialogController)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.App.TemplatesSelectDatesController=function(i){function n(){this.onChangeEndDate=t(this.onChangeEndDate,this),this.onChangeStartDate=t(this.onChangeStartDate,this),this.setupDates=t(this.setupDates,this),n.__super__.constructor.apply(this,arguments),this.setupDates()}return e(n,i),n.prototype.elements={"#start_date":"startDateEl","#end_date":"endDateEl","input[name='start_date']":"startDate","input[name='end_date']":"endDate"},n.prototype.events={"change #start_date":"onChangeStartDate","change #end_date":"onChangeEndDate"},n.prototype.setupDates=function(){return this.endDateEl.val(moment(this.endDate.val(),"YYYY-MM-DD").format(i18n.date.L)),this.endDateEl.datepicker().change(),this.startDateEl.val(moment(this.startDate.val(),"YYYY-MM-DD").format(i18n.date.L)),this.startDateEl.datepicker().change(),this.startDateEl.datepicker("option","minDate",moment().toDate())},n.prototype.onChangeStartDate=function(){return this.startDate.val(moment(this.startDateEl.val(),i18n.date.L).format("YYYY-MM-DD")),this.endDateEl.datepicker("option","minDate",moment(this.startDate.val()).toDate()),moment(this.endDate.val()).diff(moment(this.startDate.val()),"days")<0?this.endDate.val(this.startDate.val()):void 0},n.prototype.onChangeEndDate=function(){return this.endDate.val(moment(this.endDateEl.val(),i18n.date.L).format("YYYY-MM-DD"))},n}(Spine.Controller)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.App.TemplatesShowController=function(i){function n(){this.validateNumber=t(this.validateNumber,this),this.setupNumbers=t(this.setupNumbers,this),n.__super__.constructor.apply(this,arguments),this.setupNumbers()}return e(n,i),n.prototype.events={"change input[type='number']":"validateNumber","preChange input[type='number']":"validateNumber"},n.prototype.setupNumbers=function(){return this.el.find("input[type='number']").preChange()},n.prototype.validateNumber=function(t){var e;return e=$(t.currentTarget),parseInt(e.val())>parseInt(e.attr("max"))?e.val(e.attr("max")):parseInt(e.val())<parseInt(e.attr("min"))?e.val(e.attr("min")):e.val().match(/\D/)?e.val(e.attr("min")):void 0},n}(Spine.Controller)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.App.TimeoutCountdownController=function(i){function n(e){this.validateStart=t(this.validateStart,this),this.timeout=t(this.timeout,this),this.renderTime=t(this.renderTime,this),this.refreshTime=t(this.refreshTime,this),this.delegateEvents=t(this.delegateEvents,this),n.__super__.constructor.apply(this,arguments),this.countdown=new App.TimeoutCountdown(App.CustomerOrder.TIMEOUT_MINUTES),this.validateStart(),this.delegateEvents()}return e(n,i),n.prototype.elements={"#timeout-countdown-time":"countdownTimeEl"},n.prototype.delegateEvents=function(){return $(this.countdown).on("timeUpdated",function(t){return function(){return t.renderTime()}}(this)),$(this.countdown).on("timeout",function(t){return function(){return t.timeout()}}(this)),this.refreshTarget.on("click",function(t){return function(){return t.refreshTime()}}(this)),App.Reservation.on("refresh",function(t){return function(){return t.validateStart(),t.refreshTime()}}(this))},n.prototype.refreshTime=function(){return this.countdown.refresh()},n.prototype.renderTime=function(){return this.countdownTimeEl.html(this.countdown.toString())},n.prototype.timeout=function(){return document.location="/borrow/order/timed_out"},n.prototype.validateStart=function(){var t;return t=App.Reservation.all(),0!==t.length?(this.countdown.start(),this.renderTime(),this.el.removeClass("hidden")):void 0},n}(Spine.Controller)}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},i={}.hasOwnProperty;window.App.UnsubmittedCustomerOrderShowController=function(i){function n(){this.render=t(this.render,this),this.changeReservations=t(this.changeReservations,this),this.delegateEvents=t(this.delegateEvents,this),n.__super__.constructor.apply(this,arguments),App.CustomerOrder.timedOut||(this.timeoutCountdown=new App.TimeoutCountdownController({el:this.el.find("#timeout-countdown"),refreshTarget:this.el.find("#timeout-countdown")}))}return e(n,i),n.prototype.elements={"#current-order-lines":"reservationsContainer",".emboss.red":"conflictsWarning"},n.prototype.events={"click [data-change-order-lines]":"changeReservations"},n.prototype.delegateEvents=function(){return n.__super__.delegateEvents.apply(this,arguments),App.Reservation.bind("refresh",function(t){return function(e){return t.render()}}(this))},n.prototype.changeReservations=function(t){var e,i,n;return t.preventDefault(),n=$(t.currentTarget),i=_.map(n.data("ids"),function(t){return App.Reservation.find(t)}),e=_.reduce(i,function(t,e){return t+e.quantity},0),new App.ReservationsChangeController({modelId:n.data("model-id"),reservations:i,quantity:e,startDate:n.data("start-date"),endDate:n.data("end-date"),titel:_jed("Change %s",_jed("Order")),buttonText:_jed("Save change"),withoutLines:!0}),!1},n.prototype.render=function(){var t;return t=App.Reservation.all(),this.reservationsContainer.html(App.Render("borrow/views/order/grouped_and_merged_lines",App.Modules.HasLines.groupByDateAndPool(t,!0))),_.all(t,function(t){return t.available()})?this.conflictsWarning.addClass("hidden"):void 0},n}(Spine.Controller)}.call(this),function(t){t.views.templates("borrow/views/booking_calendar/calendar_dialog","<div class='modal fade ui-modal medium' role='dialog' tabindex='-1'>\n  <div class='modal-header row'>\n    <div class='col3of5'>\n      <h2 class='headline-l'>{{>titel}}</h2>\n      <h3 class='headline-m light'>{{>model.name()}}</h3>\n    </div>\n    <div class='col2of5 text-align-right'>\n      <div class='modal-close'>{{jed \"Cancel\"/}}</div>\n      <button class='button green' disabled='disabled' id='submit-booking-calendar'>{{>buttonText}}</button>\n    </div>\n  </div>\n  <div id='booking-calendar-errors'></div>\n  <div class='modal-body'>\n    <form class='padding-inset-m'>\n      <div class='hidden' id='booking-calendar-controls'>\n        <div class='col5of8 float-right'>\n          <div class='row grey padding-bottom-xxs'>\n            <div class='col1of2'>\n              <div class='col1of2 padding-right-xs text-align-left'>\n                <div class='row'>\n                  <span>{{jed \"Start date\"/}}</span>\n                  <a class='grey fa fa-eye position-absolute-right padding-right-xxs' id='jump-to-start-date'></a>\n                </div>\n              </div>\n              <div class='col1of2 padding-right-xs text-align-left'>\n                <div class='row'>\n                  <span>{{jed \"End date\"/}}</span>\n                  <a class='grey fa fa-eye position-absolute-right padding-right-xxs' id='jump-to-end-date'></a>\n                </div>\n              </div>\n            </div>\n            <div class='col1of2'>\n              <div class='col2of8 text-align-left'>{{jed \"Quantity\"/}}</div>\n              <div class='col6of8 padding-left-xs text-align-left'>{{jed \"Inventory pool\"/}}</div>\n            </div>\n          </div>\n          <div class='row'>\n            <div class='col1of2'>\n              <div class='col1of2 padding-right-xs'>\n                <input autocomplete='off' id='booking-calendar-start-date' type='text'>\n              </div>\n              <div class='col1of2 padding-right-xs'>\n                <input autocomplete='off' id='booking-calendar-end-date' type='text'>\n              </div>\n            </div>\n            <div class='col1of2'>\n              <div class='col2of8'>\n                <input autocomplete='off' class='text-align-center' id='booking-calendar-quantity' type='text' value='1'>\n              </div>\n              <div class='col6of8 padding-left-xs'>\n                <select autocomplete='off' class='min-width-full text-ellipsis' id='booking-calendar-inventory-pool'></select>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class='booking-calendar padding-top-xs' id='booking-calendar'></div>\n      <img class='loading margin-horziontal-auto margin-vertical-xl' src='/assets/loading-4eebf3d6e9139e863f2be8c14cad4638df21bf050cea16117739b3431837ee0a.gif'>\n    </form>\n  </div>\n  <div class='modal-footer'></div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(t){t.views.templates("borrow/views/booking_calendar/inventory_pool_option","<option data-id='{{>id}}'>\n  {{>name}}\n  (max. {{>~availability.total_borrowable}})\n</option>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(t){t.views.templates("borrow/views/models/index/ip_selector","{{>text}}\n<div class='arrow down'></div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(t){t.views.templates("borrow/views/models/index/line","<a class='row line height-xs focus-hover-thin{{if availableQuantityForInventoryPools}}{{if availableQuantityForInventoryPools(~inventory_pool_ids) <= 0}} grayed-out{{/if}}{{/if}}' data-id='{{>id}}' href='/borrow/models/{{>id}}'>\n  <div class='line-col col1of6 no-padding'>\n    <div class='padding-inset-xxs text-align-center'>\n      {{if id}}\n      <img class='max-height-xxs-alt max-width-xs' src='/models/{{>id}}/image_thumb'>\n      {{else}}\n      <div class='padding-inset-s'>\n        <img class='margin-horziontal-auto max-height-xxs-alt max-width-micro' src='/assets/loading-4eebf3d6e9139e863f2be8c14cad4638df21bf050cea16117739b3431837ee0a.gif'>\n      </div>\n      {{/if}}\n    </div>\n  </div>\n  <div class='line-col col3of6 text-align-left'>\n    {{if id}}\n    {{>name()}}\n    {{/if}}\n  </div>\n  <div class='line-col col1of6'>\n    {{if id}}\n    {{>manufacturer}}\n    {{/if}}\n  </div>\n  <div class='line-col col1of6'>\n    {{if id}}\n    <button class='button small focus-hover inset' data-create-order-line data-model-id='{{>id}}' title='Add to order'>\n      <div class='padding-horizontal-xxs'>\n        <i class='fa fa-plus icon-xxs'></i>\n      </div>\n    </button>\n    {{/if}}\n  </div>\n</a>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(t){t.views.templates("borrow/views/models/index/loading","<div class='min-height-m min-width-full'>\n  <div class='row min-height-s'></div>\n  <div class='row'>\n    <img class='margin-horziontal-auto' src='/assets/loading-4eebf3d6e9139e863f2be8c14cad4638df21bf050cea16117739b3431837ee0a.gif'>\n  </div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(t){t.views.templates("borrow/views/models/index/page","<span class='page' data-page='{{> ~page}}'>\n  {{for ~entries}}\n  {{partial 'borrow/views/models/index/line'/}}\n  {{/for}}\n</span>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(t){t.views.templates("borrow/views/models/index/property","<div class='row'>\n  <div class='col1of2'>{{>key}}</div>\n  <div class='col1of2'>{{>value}}</div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(t){t.views.templates("borrow/views/models/index/sorting",'{{if sort == "manufacturer"}}\n{{jed "Manufacturer"/}}\n{{else sort == "name"}}\n{{jed "Model"/}}\n{{/if}}\n{{if order == "asc"}}\n<i class=\'fa fa-circle-arrow-up icon-xs\'></i>\n{{else order == "desc"}}\n<i class=\'fa fa-circle-arrow-down icon-xs\'></i>\n{{/if}}\n')}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(t){t.views.templates("borrow/views/models/index/tooltip","<div class='padding-inset-s width-xl-alt'>\n  <div class='row'>\n    {{if amount_of_images != 0}}\n    <div class='col1of4 text-align-center emboss white min-width-s padding-inset-s' style='max-height: 120px'>\n      {{count amount_of_images}}\n      <img class='margin-bottom-s max-height-s max-width-s' src='/models/{{>#parent.data.id}}/image_thumb?offset={{>count}}'>\n      {{/count}}\n    </div>\n    {{/if}}\n    <div class='{{if amount_of_images == 0}}row{{else}}col3of4 padding-left-m{{/if}}' style='min-height: 120px'>\n      <div class='row'>\n        <div class='headline-s'>{{>name()}}</div>\n      </div>\n      <div class='row'>\n        <p class='paragraph-s margin-top-s text-align-left'>{{>description}}</p>\n      </div>\n      {{if propertiesToDisplay.length}}\n      <div class='row margin-top-m padding-bottom-m padding-inset-s'>\n        {{for propertiesToDisplay}}\n        <div class='row margin-top-xs'>\n          <div class='col1of3 text-align-right text-ellipsis'>\n            <strong>{{>key/}}</strong>\n          </div>\n          <div class='col2of3 padding-left-s'>{{>value}}</div>\n        </div>\n        {{/for}}\n      </div>\n      {{/if}}\n    </div>\n  </div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(t){t.views.templates("borrow/views/models/show/collapsed_properties","<div>\n  <div class='row height-xs margin-bottom-s'>\n    <div class='pearl' id='properties-toggle'>\n      <span id='show-all-properties-text'>\n        <i class='fa fa-expand-alt'></i>\n        {{jed \"Show all properties\"/}}\n      </span>\n      <span class='hidden' id='show-less-properties-text'>\n        <i class='fa fa-collapse-alt'></i>\n        {{jed \"Show less properties\"/}}\n      </span>\n    </div>\n  </div>\n  <div class='collapsed' id='collapsed-properties'>\n    <div class='row collapsed-inner'></div>\n    <div class='row collapsed-shadow'></div>\n    <div class='row collapsed-shadow-cover'></div>\n  </div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(t){t.views.templates("borrow/views/order/basket/line","<div class='row line small' title='{{>model.name()}}'>\n  <div class='line-col col1of1'>\n    <span class='text-ellipsis width-s-alt block'>{{>quantity}}x {{>model.name()}}</span>\n  </div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(t){t.views.templates("borrow/views/order/grouped_and_merged_lines","<div class='row padding-inset-l'>\n  <div class='col1of7'>\n    <h3 class='headline-m'>{{localize start_date/}}</h3>\n  </div>\n  <div class='col5of7'>\n    <h2 class='headline-m'>{{>inventory_pool.name}}</h2>\n  </div>\n</div>\n<div class='separated-top padding-bottom-l'>\n  {{for groups}}\n  {{partial \"borrow/views/order/order_line\" reservations/}}\n  {{/for}}\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(t){t.views.templates("borrow/views/order/order_line","<div class='row line' data-ids='{{JSON ids/}}'>\n  {{if !available()}}\n  <div class='line-info red' title='Not available'></div>\n  {{/if}}\n  <div class='line-col col1of9 padding-left-l text-align-center'>\n    <img class='max-height-xxs-alt max-width-xs' src='/models/{{>model_id}}/image_thumb'>\n  </div>\n  <div class='line-col col4of9 text-align-left'>\n    <div class='col1of10 text-align-right padding-right-s'>\n      {{if subreservations}}\n      {{sum subreservations \"quantity\"/}}\n      {{else}}\n      {{> quantity}}\n      {{/if}}\n      x\n    </div>\n    <strong class='col6of10 text-ellipsis test-fix' title='{{>model().name()}}'>{{>model().name()}}</strong>\n    <strong class='col2of10 text-ellipsis padding-left-m' title='{{>model().manufacturer}}'>{{>model().manufacturer}}</strong>\n  </div>\n  <div class='line-col col2of9 text-align-left'>\n    {{interval start_date end_date/}}\n    {{jed \"until\"/}}\n    {{localize end_date/}}\n  </div>\n  <div class='line-col line-actions col2of9 padding-right-l'>\n    <div class='multibutton'>\n      <button class='button white' data-change-order-lines data-end-date='{{>end_date}}' data-ids='{{JSON ids/}}' data-model-id='{{>model_id}}' data-start-date='{{>start_date}}'>\n        <i class='fa fa-calendar'></i>\n        {{jed \"Change entry\"/}}\n      </button>\n      <div class='dropdown-holder inline-block'>\n        <div class='button white dropdown-toggle'>\n          <span class='arrow down'></span>\n        </div>\n        <div class='dropdown right'>\n          <a class='dropdown-item red' data-confirm='{{jed 'Delete'/}}' data-method='delete' href='/borrow/order/remove_reservations?{{param ids 'line_ids'/}}'>\n            <i class='fa fa-trash'></i>\n            {{jed 'Delete'/}}\n          </a>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n");
}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(t){t.views.templates("borrow/views/search/autocomplete/model","<li class='separated-bottom exclude-last-child'>\n  <a class='row' href='/borrow/models/{{>id}}' title='{{>name()}}'>\n    <div class='col8of10'>\n      <div class='row text-ellipsis'>\n        <strong>{{>name()}}</strong>\n      </div>\n      <div class='row text-ellipsis'>{{>manufacturer}}</div>\n    </div>\n    <div class='col2of10 text-align-center padding-left-s'>\n      <img class='max-height-xxs max-width-xxs min-height-xxs min-width-xxs' src='/models/{{>id}}/image_thumb'>\n    </div>\n  </a>\n</li>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(t){t.views.templates("borrow/views/search/autocomplete/show_all","<li class='row'>\n  <a class='row padding-inset-s emboss font-size-xs text-align-center'>\n    <div class='row link' type='submit'>{{jed \"Show all search results\"/}}</div>\n  </a>\n</li>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(t){t.views.templates("borrow/views/templates/availability/grouped_lines","<div class='row padding-inset-l'>\n  <div class='col1of7'>\n    <h3 class='headline-m'>{{localize start_date/}}</h3>\n  </div>\n  <div class='col5of7'>\n    {{if inventory_pool}}\n    <h2 class='headline-m'>{{>inventory_pool.name}}</h2>\n    {{/if}}\n  </div>\n</div>\n<div class='separated-top padding-bottom-l'>\n  {{partial \"borrow/views/templates/availability/line\" reservations/}}\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(t){t.views.templates("borrow/views/templates/availability/line","<div class='row line' data-model_link_id='{{>model_link_id}}'>\n  <input name='reservations[][model_id]' type='hidden' value='{{>model_id}}'>\n  <input name='reservations[][quantity]' type='hidden' value='{{>quantity}}'>\n  <input name='reservations[][start_date]' type='hidden' value='{{>start_date}}'>\n  <input name='reservations[][end_date]' type='hidden' value='{{>end_date}}'>\n  <input name='reservations[][inventory_pool_id]' type='hidden' value='{{>inventory_pool_id}}'>\n  {{if !available}}\n  <div class='line-info red' title='{{jed 'Not available'/}}'></div>\n  {{/if}}\n  <div class='line-col col1of9 padding-left-s text-align-center'>\n    <img class='max-height-xxs-alt max-width-xs' src='/models/{{>model_id}}/image_thumb'>\n  </div>\n  <div class='line-col col5of9 text-align-left'>\n    <div class='col1of10 text-align-right padding-right-s'>\n      {{>quantity}}\n      x\n    </div>\n    <strong class='col6of10 text-ellipsis test-fix' title='{{>model().name()}}'>{{>model().name()}}</strong>\n    <strong class='col2of10 text-ellipsis padding-left-m' title='{{>model().manufacturer}}'>{{>model().manufacturer}}</strong>\n  </div>\n  <div class='line-col col1of9 text-align-left'>\n    {{interval start_date end_date/}}\n    {{jed \"until\"/}}\n    {{localize end_date/}}\n  </div>\n  <div class='line-col line-actions col2of9'>\n    {{if unborrowable}}\n    <button class='button red' data-destroy-template-line>\n      <i class='fa fa-trash'></i>\n      {{jed \"Delete\" /}}\n    </button>\n    {{else}}\n    <div class='multibutton'>\n      <button class='button white' data-change-template-line data-end-date='{{> end_date}}' data-model-id='{{> model_id}}' data-quantity='{{> quantity}}' data-start-date='{{> start_date}}'>\n        <i class='fa fa-calendar'></i>\n        {{jed \"Change\"/}}\n      </button>\n      <div class='dropdown-holder inline-block'>\n        <div class='button white dropdown-toggle'>\n          <span class='arrow down'></span>\n        </div>\n        <div class='dropdown right'>\n          <a class='dropdown-item red' data-destroy-template-line>\n            <i class='fa fa-trash'></i>\n            {{jed \"Delete\"/}}\n          </a>\n        </div>\n      </div>\n    </div>\n    {{/if}}\n  </div>\n</div>\n")}("undefined"!=typeof jQuery&&null!==jQuery?jQuery:{views:jsviews}),function(){App.Tooltip.interactive=!1}.call(this);